% chs_H.m
%
% function H=chs_H(x, Prob)
%
% chs_H computes the Hessian to the objective function f at the point x for
% test problem Prob.P.

% Kenneth Holmstrom, Tomlab Optimization Inc., E-mail: tomlab@tomopt.com.
% Copyright (c) 1999-2008 by Tomlab Optimization Inc. $Release: 6.2.0$
% Written June 1, 1999.   Last modified Jun 6, 2008.

function H=chs_H(x, Prob)

P=Prob.P;

if P < 46
    H = chs_H1(x, P);
elseif P < 91
    H = chs_H2(x, P);
elseif P < 136
    H = chs_H3(x, P);
elseif P < 181
    H = chs_H4(x, P);
end

function H=chs_H1(x, P)

if P==1
    % HS 6
    H = [2 0;0 0];
elseif P==2
    % HS 7
    H = [(2-2*x(1)^2)/(1+x(1)^2)^2 0;0 0];
elseif P==3
    % HS 8
    H = [0 0;0 0];
elseif P==4
    % HS 9
    H = [-1/144*cos(1/16*pi*x(2))*pi^2*sin(1/12*pi*x(1)) -1/192*cos(1/12*pi*x(1))*pi^2*sin(1/16*pi*x(2));
        -1/192*cos(1/12*pi*x(1))*pi^2*sin(1/16*pi*x(2)) -1/256*cos(1/16*pi*x(2))*pi^2*sin(1/12*pi*x(1))];
elseif P==5
    % HS 10
    H = [0 0;0 0];
elseif P==6
    % HS 11
    H = [2 0;0 2];
elseif P==7
    % HS 12
    H = [1.0 -1;-1 2];
elseif P==8
    % HS 13
    H = [2 0; 0 2];
elseif P==9
    % HS 14
    H=2*eye(2);
elseif P==10
    % HS 15
    H = [1200*x(1)^2-400*x(2)+2 -400*x(1); -400*x(1) 200];
elseif P==11
    % HS 16
    H = [1200*x(1)^2-400*x(2)+2 -400*x(1); -400*x(1) 200];
elseif P==12
    % HS 17
    H = [1200*x(1)^2-400*x(2)+2 -400*x(1); -400*x(1) 200];
elseif P==13
    % HS 18
    H = [.02 0;0 2];
elseif P==14
    % HS 19
    H = [6*(x(1)-10) 0;0 6*(x(2)-20)];
elseif P==15
    % HS 20
    H = [1200*x(1)^2-400*x(2)+2 -400*x(1); -400*x(1) 200];
elseif P==16
    % HS 22
    H = [2 0;0 2];
elseif P==17
    % HS 23
    H = [2 0;0 2];
elseif P==18
    % HS 24
    r=9*sqrt(3);
    H11=2*x(2)^3/(3*r);
    H12=2*(x(1)-3)*x(2)^2/r;
    H22=2*x(2)*((x(1)-3)^2-9)/r;
    H=[H11 H12; H12 H22];
elseif P==19
    % HS 26
    H = [2 -2 0;-2 2+12*(x(2)-x(3))^2 -12*(x(2)-x(3))^2;0 -12*(x(2)-x(3))^2 12*(x(2)-x(3))^2];
elseif P==20
    % HS 27
    H = [.02-4*x(2)+12*x(1)^2 -4*x(1) 0;-4*x(1) 2 0;0 0 0];
elseif P==21
    % HS 29
    H = [0 -x(3) -x(2);-x(3) 0 -x(1);-x(2) -x(1) 0];
elseif P==22
    % HS 30
    H = [2 0 0;0 2 0;0 0 2];
elseif P==23
    % HS 31
    H = [18 0 0;0 2 0;0 0 18];
elseif P==24
    % HS 32
    H = [10 -2 2;-2 26 6;2 6 2];
elseif P==25
    % HS 33
    H = [6*x(1)-12 0 0;0 0 0;0 0 0];
elseif P==26
    % HS 34
    H = zeros(3,3);
elseif P==27
    % HS 36
    H = [0 -x(3) -x(2);-x(3) 0 -x(1);-x(2) -x(1) 0];
elseif P==28
    % HS 37
    H = [0 -x(3) -x(2);-x(3) 0 -x(1);-x(2) -x(1) 0];
elseif P==29
    % HS 39
    H = zeros(4,4);
elseif P==30
    % HS 40
    H = [0 -x(3)*x(4) -x(2)*x(4) -x(2)*x(3);-x(3)*x(4) 0 -x(1)*x(4) -x(1)*x(3);
        -x(2)*x(4) -x(1)*x(4) 0 -x(1)*x(2);-x(2)*x(3) -x(1)*x(3) -x(1)*x(2) 0];
elseif P==31
    % HS 41
    H = [0 -x(3) -x(2) 0;-x(3) 0 -x(1) 0;-x(2) -x(1) 0 0;0 0 0 0];
elseif P==32
    % HS 42
    H = [2 0 0 0;0 2 0 0;0 0 2 0;0 0 0 2];
elseif P==33
    % HS 43
    H = [2 0 0 0;0 2 0 0;0 0 4 0;0 0 0 2];
elseif P==34
    % HS 44
    H = [0 0 -1 1;0 0 1 -1;-1 1 0 0;1 -1 0 0];
elseif P==35
    % HS 46
    H = [2 -2 0 0 0;-2 2 0 0 0;0 0 2 0 0;0 0 0 12*(x(4)-1)^2 0;0 0 0 0 30*(x(5)-1)^4];
elseif P==36
    % HS 47
    H = [2 -2 0 0 0;-2 2+6*(x(2)-x(3)) -6*(x(2)-x(3)) 0 0;
        0 -6*(x(2)-x(3)) 6*(x(2)-x(3))+12*(x(3)-x(4))^2 -12*(x(3)-x(4))^2 0;
        0 0 -12*(x(3)-x(4))^2 12*(x(3)-x(4))^2+12*(x(4)-x(5))^2 -12*(x(4)-x(5))^2;
        0 0 0 -12*(x(4)-x(5))^2 12*(x(4)-x(5))^2];
elseif P==37
    % HS 54
    A = 6.4e7;
    B = 2e4;
    C = .96*4.9e13;
    D = 2.5e3;
    E = 2.5e-3;
    F = 2.5e17;
    h = ((x(1)-1e6)^2/A+(x(1)-1e4)*(x(2)-1)/B+(x(2)-1)^2)*(x(3)-2e6)^2/C...
        +(x(4)-10)^2/D+(x(5)-1e-3)^2/E...
        +(x(6)-1e8)^2/F;
    f = -exp(-h/2);
    f_x1 = 1/(2*C)*(2/A*(x(1)-1e6)+1/B*(x(2)-1))*(x(3)-2e6)^2*f;
    f_x2 = 1/(2*C)*(1/B*(x(1)-1e4)+2*(x(2)-1))*(x(3)-2e6)^2*f;
    f_x3 = 1/(C)*(1/A*(x(1)-1e6)^2+1/B*(x(1)-1e4)*(x(2)-1)+(x(2)-1)^2)*(x(3)-2e6)*f;
    f_x4 = 1/D*(x(4)-10)*f;
    f_x5 = 1/E*(x(5)-1e-3)*f;
    f_x6 = 1/F*(x(6)-1e8)*f;
    % Second derivatives
    f_11 = 1/(A*C)*(x(3)-2e6)^2*f_x1;
    f_12 = 1/(2*B*C)*(x(3)-2E6)^2*f_x2;
    f_13 = 1/C*(2/A*(x(1)-1e6)+1/B*(x(2)-1))*(x(3)-2e6)*f_x3;
    f_14 = 1/D*(x(4)-10)*f_x1;
    f_15 = 1/E*(x(5)-1e-3)*f_x1;
    f_16 = 1/F*(x(6)-1e8)*f_x1;
    f_21 = 1/(2*B*C)*(x(3)-2e6)^2*f_x1;
    f_22 = 1/C*(x(3)-2e6)^2*f_x2;
    f_23 = 1/C*(1/B*(x(1)-1e4)+2*(x(2)-1))*(x(3)-2e6);
    f_24 = 1/D*(x(4)-10)*f_x2;
    f_25 = 1/E*(x(5)-1e-3)*f_x2;
    f_26 = 1/F*(x(6)-1e8)*f_x2;
    f_31 = 1/C*(2/A*(x(1)-1e6)+1/B*(x(2)-1))*(x(3)-2e6)*f_x1;
    f_32 = 1/(C)*(1/B*(x(1)-1e4)+2*(x(2)-1))*(x(3)-2e6)*f_x2;
    f_33 = 1/(C)*(1/A*(x(1)-1e6)^2+1/B*(x(1)-1e4)*(x(2)-1)+(x(2)-1)^2)*f_x3;
    f_34 = 1/D*(x(4)-10)*f_x3;
    f_35 = 1/E*(x(5)-1e-3)*f_x3;
    f_36 = 1/F*(x(6)-1e8)*f_x3;
    f_41 = 1/D*(x(4)-10)*f_x1;
    f_42 = 1/D*(x(4)-10)*f_x2;
    f_43 = 1/D*(x(4)-10)*f_x3;
    f_44 = 1/D*f_x4;
    f_45 = 1/D*(x(4)-10)*f_x5;
    f_46 = 1/D*(x(4)-10)*f_x6;
    f_51 = 1/E*(x(5)-1e-3)*f_x1;
    f_52 = 1/E*(x(5)-1e-3)*f_x2;
    f_53 = 1/E*(x(5)-1e-3)*f_x3;
    f_54 = 1/E*(x(5)-1e-3)*f_x4;
    f_55 = 1/E*f_x5;
    f_56 = 1/E*(x(5)-1e-3)*f_x6;
    f_61 = 1/F*(x(6)-1e8)*f_x1;
    f_62 = 1/F*(x(6)-1e8)*f_x2;
    f_63 = 1/F*(x(6)-1e8)*f_x3;
    f_64 = 1/F*(x(6)-1e8)*f_x4;
    f_65 = 1/F*(x(6)-1e8)*f_x5;
    f_66 = 1/F*f_x6;
    H = [f_11 f_21 f_31 f_41 f_51 f_61
        f_12 f_22 f_32 f_42 f_52 f_62
        f_13 f_23 f_33 f_43 f_53 f_63
        f_14 f_24 f_34 f_44 f_54 f_64
        f_15 f_25 f_35 f_45 f_55 f_65
        f_16 f_26 f_36 f_46 f_56 f_66];
    H = 0.5*(H+H');
elseif P==38
    % HS 55
    H = [x(4)^2*exp(x(1)*x(4)) 0 0 (1+x(1)*x(4))*exp(x(1)*x(4)) 0 0
        0 0 0 0 0 0
        0 0 0 0 0 0
        (1+x(1)*x(4))*exp(x(1)*x(4)) 0 0 x(1)^2*exp(x(1)*x(4)) 0 0
        0 0 0 0 0 0
        0 0 0 0 0 0];
elseif P==39
    % HS 56
    H = [0 -x(3) -x(2) 0 0 0 0
        -x(3) 0 -x(1) 0 0 0 0
        -x(2) -x(1) 0 0 0 0 0
        0 0 0 0 0 0 0
        0 0 0 0 0 0 0
        0 0 0 0 0 0 0
        0 0 0 0 0 0 0];
elseif P==40
    % HS 57
    a=[8 8 10 10 10 10 12 12 12 12 14 14 14 16 16 16 18 18 20 20 20 22 22 22 24 24 24 26 26 26 28 28 30 30 30 32 32 34 36 36 38 38 40 42];
    b=[.49 .49 .48 .47 .48 .47 .46 .46 .45 .43 .45 .43 .43 .44 .43 .43 .46 .45 .42 .42 .43 ...
        .41 .41 .40 .42 .40 .40 .41 .40 .41 .41 .40 .40 .40 .38 .41 .40 .40 .41 .38 .40 .40 .39 .39];
    H11 = 0;
    H12 = 0;
    H22 = 0;
    for j=1:1:44
        V = exp(-x(2)*(a(j)-8));
        U = (.49-x(1));
        Z = (a(j)-8);
        FI11 = 2*(-1+V)^2;
        FI12 = 2*(-b(j)+x(1)+U*V+(-1-V)*U)*Z*V;
        FI22 = 2*(-b(j)+x(1)+2*U*V)*Z^2*U*V;
        H11 = H11 + FI11;
        H12 = H12 + FI12;
        H22 = H22 + FI22;
    end
    H = [H11 H12;H12 H22];
elseif P==41
    % HS 59
    XK = [75.196;3.8112;.0020567;1.0345e-5;6.8306;0.030234;1.28134e-3;2.266e-7;.25645;
        0.0034604;1.3514e-5;28.106;5.2375e-6;6.3e-8;7.e-10;3.405e-4;1.6638e-6;2.8673;3.5256e-5];
    X1=x(1);
    X2=x(2);
    h11 = 6*XK(3)*X1-12*XK(4)*X1^2+2*XK(7)*X2+12*XK(8)*X1^2*X2+2*XK(13)*X2^2+...
        6*XK(14)*X1*X2^2-6*XK(15)*X1*X2^3+(.0005*X2)^2*XK(18)*exp(.0005*X1*X2)-...
        6*XK(19)*X1*X2-2*.12694D0;
    h12 =-XK(6)+2*XK(7)*X1+4*XK(8)*X1^3+4*XK(13)*X1*X2+...
        6*XK(14)*X1^2*X2-9*XK(15)*X1^2*X2^2+(.0005+.0005^2*X1*X2)*XK(18)*exp(.0005*X1*X2)-...
        3*XK(19)*X1^2-2*XK(16)*X2+3*XK(17)*X2^2;
    h22 =  -2*XK(9)+6*XK(10)*X2-...
        12*XK(11)*X2^2+2*XK(12)/(X2+1.D0)^3+2*XK(13)*X1^2+...
        2*XK(14)*X1^3-6*XK(15)*X1^3*X2+(.0005*X1)^2*XK(18)*exp(.0005*X1*X2)-...
        -2*XK(16)*X1+6*XK(17)*X1*X2;
    H = [h11 h12;h12 h22];
elseif P==42
    % HS 60
    H=[4 -2 0;
        -2 2+12*(x(2)-x(3))^2 -12*(x(2)-x(3))^2;
        0 -12*(x(2)-x(3))^2 12*(x(2)-x(3))^2];
elseif P==43
    % HS 61
    H=[8 0 0; 0 4 0;0 0 4];
elseif P==44
    % HS 62
    F3=x(3)+.03;
    F2=F3+x(2);
    F1=F2+x(1);
    G1=F2+.09*x(1);
    G2=F3+.07*x(2);
    G3= .13*x(3)+.03;
    H11 = -8.20437e3*(-1/F1^2+.09^2/G1^2);
    H12 = -8.20437e3*(-1/F1^2+.09/G1^2);
    H13 = -8.20437e3*(-1/F1^2+.09/G1^2);
    H21 = H12;
    H22 = -8.20437e3*(-1/F1^2+1/G1^2)- 9.00872e3*(-1/F2^2+.07^2/G2^2);
    H23 = -8.20437e3*(-1/F1^2+1/G1^2)- 9.00872e3*(-1/F2^2+.07/G2^2);
    H31 = H13;
    H32 = H23;
    H33 = -8.20437e3*(-1/F1^2+1/G1^2)- 9.00872e3*(-1/F2^2+1/G2^2)-9.33046e3*(-1/F3^2+.13^2/G3^2);
    H=[H11 H12 H13;H21 H22 H23;H31 H32 H33];
elseif P==45
    % HS 63
    H=[-2 -1 -1;-1 -4 0;-1 0 -2];
end

function H=chs_H2(x, P)

if P==46
    % HS 64
    H=[100000/x(1)^3 0 0;0 144000/x(2)^3 0;0 0 288000/x(3)^3];
elseif P==47
    % HS 65
    H=[2+2/9 -2+2/9 0;-2+2/9 2+2/9 0;0 0 2];
elseif P==48
    % HS 66
    H=zeros(3,3);
elseif P==49
    % HS 67
    H=sparse(3,3);
elseif P==50
    % HS 70
    H=sparse(4,4);
elseif P==51
    % HS 71
    H=[2*x(4) x(4) x(4) 2*x(1)+x(2)+x(3);
        x(4) 0 0 x(1);
        x(4) 0 0 x(1);
        2*x(1)+x(2)+x(3) x(1) x(1) 0];
elseif P==52
    % HS 72
    H=zeros(4,4);
elseif P==53
    % HS 73
    H=zeros(4,4);
elseif P==54
    % HS 74
    H=[6e-6*x(1) 0 0 0;0 4e-6*x(2) 0 0;0 0 0 0;0 0 0 0];
elseif P==55
    % HS 75
    H=[6e-6*x(1) 0 0 0;0 4e-6*x(2) 0 0;0 0 0 0;0 0 0 0];
elseif P==56
    % HS 77
    H=[4 -2 0 0 0;-2 2 0 0 0;0 0 2 0 0;0 0 0 12*(x(4)-1)^2 0;0 0 0 0 30*(x(5)-1)^4];
elseif P==57
    % HS 78
    H = zeros(5,5);
    H(1,2) = x(3)*x(4)*x(5);
    H(1,3) = x(2)*x(4)*x(5);
    H(1,4) = x(2)*x(3)*x(5);
    H(1,5) = x(2)*x(3)*x(4);
    H(2,1) = H(1,2);
    H(2,3) = x(1)*x(4)*x(5);
    H(2,4) = x(1)*x(3)*x(5);
    H(2,5) = x(1)*x(3)*x(4);
    H(3,1) = H(1,3);
    H(3,2) = H(2,3);
    H(3,4) = x(1)*x(2)*x(5);
    H(3,5) = x(1)*x(2)*x(4);
    H(4,1) = H(1,4);
    H(4,2) = H(2,4);
    H(4,3) = H(3,4);
    H(4,5) = x(1)*x(2)*x(3);
    H(5,1) = H(1,5);
    H(5,2) = H(2,5);
    H(5,3) = H(3,5);
    H(5,4) = H(4,5);
elseif P==58
    % HS 79
    H=[4 -2 0 0 0;
        -2 4 -2 0 0;
        0 -2 2+12*(x(3)-x(4))^2 -12*(x(3)-x(4))^2 0;
        0 0 -12*(x(3)-x(4))^2 12*(x(3)-x(4))^2+12*(x(4)-x(5))^2 -12*(x(4)-x(5))^2
        0 0 0 -12*(x(4)-x(5))^2 12*(x(4)-x(5))^2];
elseif P==59
    % HS 80
    f=exp(x(1)*x(2)*x(3)*x(4)*x(5));
    A = x(1)*x(2)*x(3)*x(4)*x(5);
    B = x(2)*x(3)*x(4)*x(5);
    C = x(1)*x(3)*x(4)*x(5);
    D = x(1)*x(2)*x(4)*x(5);
    E = x(1)*x(2)*x(3)*x(5);
    F = x(1)*x(2)*x(3)*x(4);
    H = zeros(5,5);
    H(1,1) = B^2*f;
    H(1,2) = (1+A)*x(3)*x(4)*x(5)*f;
    H(1,3) = (1+A)*x(2)*x(4)*x(5)*f;
    H(1,4) = (1+A)*x(2)*x(3)*x(5)*f;
    H(1,5) = (1+A)*x(2)*x(3)*x(4)*f;
    H(2,1) = H(1,2);
    H(2,2) = C^2*f;
    H(2,3) = (1+A)*x(1)*x(4)*x(5)*f;
    H(2,4) = (1+A)*x(1)*x(3)*x(5)*f;
    H(2,5) = (1+A)*x(1)*x(3)*x(4)*f;
    H(3,1) = H(1,3);
    H(3,2) = H(2,3);
    H(3,3) = D^2*f;
    H(3,4) = (1+A)*x(1)*x(2)*x(5)*f;
    H(3,5) = (1+A)*x(1)*x(2)*x(4)*f;
    H(4,1) = H(1,4);
    H(4,2) = H(2,4);
    H(4,3) = H(3,4);
    H(4,4) = E^2*f;
    H(4,5) = (1+A)*x(1)*x(2)*x(3)*f;
    H(5,1) = H(1,5);
    H(5,2) = H(2,5);
    H(5,3) = H(3,5);
    H(5,4) = H(4,5);
    H(5,5) = F^2*f;
elseif P==60
    % HS 81
    f = exp(x(1)*x(2)*x(3)*x(4)*x(5));
    A = x(1)*x(2)*x(3)*x(4)*x(5);
    B = x(2)*x(3)*x(4)*x(5);
    C = x(1)*x(3)*x(4)*x(5);
    D = x(1)*x(2)*x(4)*x(5);
    E = x(1)*x(2)*x(3)*x(5);
    F = x(1)*x(2)*x(3)*x(4);
    H = zeros(5,5);
    H(1,1) = B^2*f-.5*6*(5*x(1)^4+2*x(1)*x(2)^3+2*x(1));
    H(1,2) = (1+A)*x(3)*x(4)*x(5)*f-.5*18*x(1)^2*x(2)^2;
    H(1,3) = (1+A)*x(2)*x(4)*x(5)*f;
    H(1,4) = (1+A)*x(2)*x(3)*x(5)*f;
    H(1,5) = (1+A)*x(2)*x(3)*x(4)*f;
    H(2,1) = H(1,2);
    H(2,2) = C^2*f-.5*6*(5*x(2)^4+2*x(1)^3*x(2)+2*x(2));
    H(2,3) = (1+A)*x(1)*x(4)*x(5)*f;
    H(2,4) = (1+A)*x(1)*x(3)*x(5)*f;
    H(2,5) = (1+A)*x(1)*x(3)*x(4)*f;
    H(3,1) = H(1,3);
    H(3,2) = H(2,3);
    H(3,3) = D^2*f;
    H(3,4) = (1+A)*x(1)*x(2)*x(5)*f;
    H(3,5) = (1+A)*x(1)*x(2)*x(4)*f;
    H(4,1) = H(1,4);
    H(4,2) = H(2,4);
    H(4,3) = H(3,4);
    H(4,4) = E^2*f;
    H(4,5) = (1+A)*x(1)*x(2)*x(3)*f;
    H(5,1) = H(1,5);
    H(5,2) = H(2,5);
    H(5,3) = H(3,5);
    H(5,4) = H(4,5);
    H(5,5) = F^2*f;
elseif P==61
    % HS 83
    H = [0 0 0 0 .8356891;0 0 0 0 0 ;0 0 10.7157094 0 0;0 0 0 0 0 ;.8356891 0 0 0 0];
elseif P==62
    % HS 84
    H = [0 -150512.5253 156.6950325 -476470.3222 -729482.8271;
        -150512.5253 0 0 0 0;
        156.6950325 0 0 0 0;
        -476470.3222 0 0 0 0;
        -729482.8271 0 0 0 0];
elseif P==63
    % HS 86
    c=[30  -20  -10   32  -10;
        -20   39   -6  -31   32;
        -10   -6   10   -6  -10;
        32  -31   -6   39  -20;
        -10   32  -10  -20   30];
    d=[4 8 10 6 2];
    H = zeros(5,5);
    for i=1:5
        for j=1:5
            if i==j
                H(i,j)=6*d(j)*x(i)+2*c(i,j);
            else
                H(i,j)=2*c(i,j);
            end
        end
    end
elseif P==64
    % HS 87
    H =sparse(6,6);
elseif P==65
    % HS 93
    H =zeros(6,6);
    H(1,1) = 0.0408*x(4)+0.1214*x(4)*x(5)^2;
    H(1,2) = 0.0204*x(4)+0.0187*x(3)+0.0607*x(4)*x(5)^2+0.0437*x(3)*x(6)^2;
    H(1,3) = 0.0204*x(4)+0.0187*x(2)+0.0607*x(4)*x(5)^2+0.0437*x(2)*x(6)^2;
    H(1,4) = 0.0204*x(1)+0.0204*(x(1)+x(2)+x(3))+0.0607*x(5)^2*x(1)+0.0607*x(5)^2*(x(1)+x(2)+x(3));
    H(1,5) = 0.1214*x(4)*x(5)*(x(1)+x(2)+x(3))+0.1214*x(1)*x(4)*x(5);
    H(1,6) = 0.0874*x(2)*x(3)*x(6);
    H(2,1) = H(1,2);
    H(2,2) = 0.0187*x(3)*1.57+0.029359*x(3)+0.0437*x(3)*x(6)^2*1.57+0.068609*x(3)*x(6)^2;
    H(2,3) = 0.0187*(x(1)+1.57*x(2)+x(4))+0.029359*x(2)+0.0437*x(6)^2*(x(1)+1.57*x(2)+x(4))+0.068609*x(2)*x(6)^2;
    H(2,4) = 0.0204*x(1)+.0187*x(3)+0.0607*x(1)*x(5)^2+0.0437*x(3)*x(6)^2;
    H(2,5) = 0.1214*x(1)*x(4)*x(5);
    H(2,6) = 0.0874*x(3)*x(6)*(x(1)+1.57*x(2)+x(4))+0.068609*2*x(2)*x(3)*x(6);
    H(3,1) = H(1,3);
    H(3,2) = H(2,3);
    H(3,4) = 0.0204*x(1)+.0187*x(2)+.0607*x(1)*x(5)^2+0.0437*x(2)*x(6)^2;
    H(3,5) = 0.1214*x(1)*x(4)*x(5);
    H(3,6) = 0.0874*x(2)*x(6)*(x(1)+1.57*x(2)+x(4));
    H(4,1) = H(1,4);
    H(4,2) = H(2,4);
    H(4,3) = H(3,4);
    H(4,5) = 0.1214*x(1)*x(5)*(x(1)+x(2)+x(3));
    H(4,6) = 0.0874*x(2)*x(3)*x(6);
    H(5,1) = H(1,5);
    H(5,2) = H(2,5);
    H(5,3) = H(3,5);
    H(5,4) = H(4,5);
    H(5,5) = 0.1214*x(1)*x(4)*(x(1)+x(2)+x(3));
    H(6,1) = H(1,6);
    H(6,2) = H(2,6);
    H(6,3) = H(3,6);
    H(6,4) = H(4,6);
    H(6,6) = 0.0874*x(2)*x(3)*(x(1)+1.57*x(2)+x(4));
elseif P==66
    %HS 95
    H = sparse(6,6);
elseif P==67
    % HS 96
    H = sparse(6,6);
elseif P==68
    % HS 97
    H = sparse(6,6);
elseif P==69
    % HS 98
    H = sparse(6,6);
elseif P==70
    % HS 99
    H=zeros(7,7);
    H(1,1)=-3125000*sin(x(1))^2+2500*(9000*cos(x(7))+9000*cos(x(6))+3750*cos(x(5))+...
        3750*cos(x(4))+3750*cos(x(3))+1250*cos(x(2))+1250*cos(x(1)))*cos(x(1));
    H(1,2)=-3125000*sin(x(1))*sin(x(2));
    H(1,3)=-9375000*sin(x(1))*sin(x(3));
    H(1,4)=-9375000*sin(x(1))*sin(x(4));
    H(1,5)=-9375000*sin(x(1))*sin(x(5));
    H(1,6)=-22500000*sin(x(1))*sin(x(6));
    H(1,7)=-22500000*sin(x(1))*sin(x(7));
    H(2,1)=-3125000*sin(x(1))*sin(x(2));
    H(2,2)=-3125000*sin(x(2))^2+2500*(9000*cos(x(7))+9000*cos(x(6))+3750*cos(x(5))+...
        3750*cos(x(4))+3750*cos(x(3))+1250*cos(x(2))+1250*cos(x(1)))*cos(x(2));
    H(2,3)=-9375000*sin(x(2))*sin(x(3));
    H(2,4)=-9375000*sin(x(2))*sin(x(4));
    H(2,5)=-9375000*sin(x(2))*sin(x(5));
    H(2,6)=-22500000*sin(x(2))*sin(x(6));
    H(2,7)=-22500000*sin(x(2))*sin(x(7));
    H(3,1)=-9375000*sin(x(1))*sin(x(3));
    H(3,2)=-9375000*sin(x(2))*sin(x(3));
    H(3,3)=-28125000*sin(x(3))^2+7500*(9000*cos(x(7))+9000*cos(x(6))+3750*cos(x(5))+...
        3750*cos(x(4))+3750*cos(x(3))+1250*cos(x(2))+1250*cos(x(1)))*cos(x(3));
    H(3,4)=-28125000*sin(x(3))*sin(x(4));
    H(3,5)=-28125000*sin(x(3))*sin(x(5));
    H(3,6)=-67500000*sin(x(3))*sin(x(6));
    H(3,7)=-67500000*sin(x(3))*sin(x(7));
    H(4,1)=-9375000*sin(x(1))*sin(x(4));
    H(4,2)=-9375000*sin(x(2))*sin(x(4));
    H(4,3)=-28125000*sin(x(3))*sin(x(4));
    H(4,4)=-28125000*sin(x(4))^2+7500*(9000*cos(x(7))+9000*cos(x(6))+3750*cos(x(5))+...
        3750*cos(x(4))+3750*cos(x(3))+1250*cos(x(2))+1250*cos(x(1)))*cos(x(4));
    H(4,5)=-28125000*sin(x(4))*sin(x(5));
    H(4,6)=-67500000*sin(x(4))*sin(x(6));
    H(4,7)=-67500000*sin(x(4))*sin(x(7));
    H(5,1)=-9375000*sin(x(1))*sin(x(5));
    H(5,2)=-9375000*sin(x(2))*sin(x(5));
    H(5,3)=-28125000*sin(x(3))*sin(x(5));
    H(5,4)=-28125000*sin(x(4))*sin(x(5));
    H(5,5)=-28125000*sin(x(5))^2+7500*(9000*cos(x(7))+9000*cos(x(6))+3750*cos(x(5))+...
        3750*cos(x(4))+3750*cos(x(3))+1250*cos(x(2))+1250*cos(x(1)))*cos(x(5));
    H(5,6)=-67500000*sin(x(5))*sin(x(6));
    H(5,7)=-67500000*sin(x(5))*sin(x(7));
    H(6,1)=-22500000*sin(x(1))*sin(x(6));
    H(6,2)=-22500000*sin(x(2))*sin(x(6));
    H(6,3)= -67500000*sin(x(3))*sin(x(6));
    H(6,4)=-67500000*sin(x(4))*sin(x(6));
    H(6,5)=-67500000*sin(x(5))*sin(x(6));
    H(6,6)=-162000000*sin(x(6))^2+18000*(9000*cos(x(7))+9000*cos(x(6))+3750*cos(x(5))+...
        3750*cos(x(4))+3750*cos(x(3))+1250*cos(x(2))+1250*cos(x(1)))*cos(x(6));
    H(6,7)=-162000000*sin(x(6))*sin(x(7));
    H(7,1)=-22500000*sin(x(1))*sin(x(7));
    H(7,2)=-22500000*sin(x(2))*sin(x(7));
    H(7,3)=-67500000*sin(x(3))*sin(x(7));
    H(7,4)=-67500000*sin(x(4))*sin(x(7));
    H(7,5)=-67500000*sin(x(5))*sin(x(7));
    H(7,6)=-162000000*sin(x(6))*sin(x(7));
    H(7,7)=-162000000*sin(x(7))^2+18000*(9000*cos(x(7))+9000*cos(x(6))+3750*cos(x(5))+...
        3750*cos(x(4))+3750*cos(x(3))+1250*cos(x(2))+1250*cos(x(1)))*cos(x(7));
elseif P==71
    % HS 100
    H=[2  0   0   0   0   0   0;
        0 10   0   0   0   0   0;
        0  0 12*x(3)^2 0   0   0 0;
        0  0   0   6   0   0   0;
        0  0   0   0 300*x(5)^4 0 0;
        0  0   0   0   0  14   -4;
        0  0   0   0   0  -4  12*x(7)^2];
elseif P==72
    %HS 101
    H = zeros(7,7);
    H(1,1) = 30*x(3)*x(4)/(x(1)^3*x(2)^2*x(5)*x(7)^.5)+120*x(2)*x(6)/(x(1)^4*x(4)*x(5)^2)+...
        50*x(2)^2*x(5)^.5*x(7)/(x(3)*x(6)^2);
    H(1,2) = -10*x(4)^2/(x(2)^2*x(6)^3*x(7)^.25)+30*x(3)*x(4)/(x(1)^2*x(2)^3*x(5)*x(7)^.5)-...
        40*x(6)/(x(1)^3*x(4)*x(5)^2)+100*x(1)*x(2)*x(5)^.5*x(7)/(x(3)*x(6)^2);
    H(1,3) = -15*x(4)/(x(1)^2*x(2)^2*x(5)*x(7)^.5)-50*x(1)*x(2)^2*x(5)^.5*x(7)/(x(3)^2*x(6)^2);
    H(1,4) = 20*x(4)/(x(2)*x(6)^3*x(7)^.25)-15*x(3)/(x(1)^2*x(2)^2*x(5)*x(7)^.5)-...
        40*x(2)*x(6)*x(1)^3*x(5)^2/(x(1)^3*x(4)^2*x(5)^2)^2;
    H(1,5) = 15*x(3)*x(4)/(x(1)^2*x(2)^2*x(5)^2*x(7)^.5)+80*x(2)*x(6)/(x(1)^3*x(4)*x(5)^3)+...
        25.0*x(1)*x(2)^2*x(7)/(x(3)*x(5)^.5*x(6)^2);
    H(1,6) = -30*x(4)^2/(x(2)*x(6)^4*x(7)^.25)-40*x(2)/(x(1)^3*x(4)*x(5)^2)-...
        100*x(1)*x(2)^2*x(5)^.5*x(7)/(x(3)*x(6)^3);
    H(1,7) = -2.50*x(4)^2/(x(2)*x(6)^3*x(7)^1.25)+7.5*x(3)*x(4)/(x(1)^2*x(2)^2*x(5)*x(7)^1.5)+...
        50*x(1)*x(2)^2*x(5)^.5/(x(3)*x(6)^2);
    H(2,1) = H(1,2);
    H(2,2) = 20*x(1)*x(4)^2/(x(2)^3*x(6)^3*x(7)^.25)+90*x(3)*x(4)/(x(1)*x(2)^4*x(5)*x(7)^.5)+...
        50*x(1)^2*x(5)^.5*x(7)/(x(3)*x(6)^2);
    H(2,3) = -30*x(4)/(x(1)*x(2)^3*x(5)*x(7)^.5)-50*x(1)^2*x(2)*x(5)^.5*x(7)/(x(3)^2*x(6)^2);
    H(2,4) = -20*x(1)*x(4)/(x(2)^2*x(6)^3*x(7)^.25)-30*x(3)/(x(1)*x(2)^3*x(5)*x(7)^.5)-...
        20*x(6)/(x(1)^2*x(4)^2*x(5)^2);
    H(2,5) = 30*x(3)*x(4)/(x(1)*x(2)^3*x(5)^2*x(7)^.5)-40*x(6)/(x(1)^2*x(4)*x(5)^3)+...
        25.0*x(1)^2*x(2)*x(7)/(x(3)*x(5)^.5*x(6)^2);
    H(2,6) = 30*x(1)*x(4)^2/(x(2)^2*x(6)^4*x(7)^.25)+20*1/(x(1)^2*x(4)*x(5)^2)-...
        100*x(1)^2*x(2)*x(5)^.5*x(7)/(x(3)*x(6)^3);
    H(2,7) = 2.50*x(1)*x(4)^2/(x(2)^2*x(6)^3*x(7)^1.25)+15.0*x(3)*x(4)/(x(1)*x(2)^3*x(5)*x(7)^1.5)+...
        50*x(1)^2*x(2)*x(5)^.5/(x(3)*x(6)^2);
    H(3,1) = H(1,3);
    H(3,2) = H(2,3);
    H(3,3) = 50*x(1)^2*x(2)^2*x(5)^.5*x(7)/(x(3)^3*x(6)^2);
    H(3,4) = 15*1/(x(1)*x(2)^2*x(5)*x(7)^.5);
    H(3,5) = -15*x(4)/(x(1)*x(2)^2*x(5)^2*x(7)^.5)-12.5*x(1)^2*x(2)^2*x(7)/(x(3)^2*x(5)^.5*x(6)^2);
    H(3,6) = 50*x(1)^2*x(2)^2*x(5)^.5*x(7)/(x(3)^2*x(6)^3);
    H(3,7) = -7.5*x(4)/(x(1)*x(2)^2*x(5)*x(7)^1.5)-25*x(1)^2*x(2)^2*x(5)^.5/(x(3)^2*x(6)^2);
    H(4,1) =  H(1,4);
    H(4,2) =  H(2,4);
    H(4,3) =  H(3,4);
    H(4,4) = 20*x(1)/(x(2)*x(6)^3*x(7)^.25)+40*x(2)*x(6)/(x(1)^2*x(4)^3*x(5)^2);
    H(4,5) = -15*x(3)/(x(1)*x(2)^2*x(5)^2*x(7)^.5)+40*x(2)*x(6)/(x(1)^2*x(4)^2*x(5)^3);
    H(4,6) = -60*x(1)*x(4)/(x(2)*x(6)^4*x(7)^.25)-20*x(2)/(x(1)^2*x(4)^2*x(5)^2);
    H(4,7) = -5.00*x(1)*x(4)/(x(2)*x(6)^3*x(7)^1.25)-7.5*x(3)/(x(1)*x(2)^2*x(5)*x(7)^1.5);
    H(5,1) = H(1,5);
    H(5,2) = H(2,5);
    H(5,3) = H(3,5);
    H(5,4) = H(4,5);
    H(5,5) = 30*x(3)*x(4)/(x(1)*x(2)^2*x(5)^3*x(7)^.5)+120*x(2)*x(6)/(x(1)^2*x(4)*x(5)^4)-...
        6.25*x(1)^2*x(2)^2*x(7)/(x(3)*x(5)^1.5*x(6)^2);
    H(5,6) = -40*x(2)/(x(1)^2*x(4)*x(5)^3)-25.0*x(1)^2*x(2)^2*x(7)/(x(3)*x(5)^.5*x(6)^3);
    H(5,7) = 7.5*x(3)*x(4)/(x(1)*x(2)^2*x(5)^2*x(7)^1.5)+12.5*x(1)^2*x(2)^2/(x(3)*x(5)^.5*x(6)^2);
    H(6,1) = H(1,6);
    H(6,2) = H(2,6);
    H(6,3) = H(3,6);
    H(6,4) = H(4,6);
    H(6,5) = H(5,6);
    H(6,6) = 120*x(1)*x(4)^2/(x(2)*x(6)^5*x(7)^.25)+150*x(1)^2*x(2)^2*x(5)^.5*x(7)/(x(3)*x(6)^4);
    H(6,7) = 7.50*x(1)*x(4)^2/(x(2)*x(6)^4*x(7)^1.25)-50*x(1)^2*x(2)^2*x(5)^.5/(x(3)*x(6)^3);
    H(7,1) = H(1,7);
    H(7,2) = H(2,7);
    H(7,3) = H(3,7);
    H(7,4) = H(4,7);
    H(7,5) = H(5,7);
    H(7,6) = H(6,7);
    H(7,7) = 3.1250*x(1)*x(4)^2/(x(2)*x(6)^3*x(7)^2.25)+11.25*x(3)*x(4)/(x(1)*x(2)^2*x(5)*x(7)^2.5);
elseif P==73
    % HS 102
    H = zeros(7,7);
    H(1,1) = 30*x(3)*x(4)/(x(1)^3*x(2)^2*x(5)*x(7)^.5)+120*x(2)*x(6)/(x(1)^4*x(4)*x(5)^2)+...
        50*x(2)^2*x(5)^.5*x(7)/(x(3)*x(6)^2);
    H(1,2) = -10*x(4)^2*x(7)^.125/(x(2)^2*x(6)^3)+30*x(3)*x(4)/(x(1)^2*x(2)^3*x(5)*x(7)^.5)-...
        40*x(6)/(x(1)^3*x(4)*x(5)^2)+100*x(1)*x(2)*x(5)^.5*x(7)/(x(3)*x(6)^2);
    H(1,3) = -15*x(4)/(x(1)^2*x(2)^2*x(5)*x(7)^.5)-50*x(1)*x(2)^2*x(5)^.5*x(7)/(x(3)^2*x(6)^2);
    H(1,4) = 20*x(4)*x(7)^.125/(x(2)*x(6)^3)-15*x(3)/(x(1)^2*x(2)^2*x(5)*x(7)^.5)+...
        40*x(2)*x(6)/(x(1)^3*x(4)^2*x(5)^2);
    H(1,5) = 15*x(3)*x(4)/(x(1)^2*x(2)^2*x(5)^2*x(7)^.5)+80*x(2)*x(6)/(x(1)^3*x(4)*x(5)^3)+...
        25.0*x(1)*x(2)^2*x(7)/(x(3)*x(5)^.5*x(6)^2);
    H(1,6) = -30*x(4)^2*x(7)^.125/(x(2)*x(6)^4)-40*x(2)/(x(1)^3*x(4)*x(5)^2)-...
        100*x(1)*x(2)^2*x(5)^.5*x(7)/(x(3)*x(6)^3);
    H(1,7) = 1.250*x(4)^2/(x(2)*x(6)^3*x(7)^.875)+7.5*x(3)*x(4)/(x(1)^2*x(2)^2*x(5)*x(7)^1.5)+...
        50*x(1)*x(2)^2*x(5)^.5/(x(3)*x(6)^2);
    H(2,1) = H(1,2);
    H(2,2) = 20*x(1)*x(4)^2*x(7)^.125/(x(2)^3*x(6)^3)+90*x(3)*x(4)/(x(1)*x(2)^4*x(5)*x(7)^.5)+...
        50*x(1)^2*x(5)^.5*x(7)/(x(3)*x(6)^2);
    H(2,3) = -30*x(4)/(x(1)*x(2)^3*x(5)*x(7)^.5)-50*x(1)^2*x(2)*x(5)^.5*x(7)/(x(3)^2*x(6)^2);
    H(2,4) = -20*x(1)*x(4)*x(7)^.125/(x(2)^2*x(6)^3)-30*x(3)/(x(1)*x(2)^3*x(5)*x(7)^.5)-...
        20*x(6)/(x(1)^2*x(4)^2*x(5)^2);
    H(2,5) = 30*x(3)*x(4)/(x(1)*x(2)^3*x(5)^2*x(7)^.5)-40*x(6)/(x(1)^2*x(4)*x(5)^3)+...
        25.0*x(1)^2*x(2)*x(7)/(x(3)*x(5)^.5*x(6)^2);
    H(2,6) = 30*x(1)*x(4)^2*x(7)^.125/(x(2)^2*x(6)^4)+20*1/(x(1)^2*x(4)*x(5)^2)-...
        100*x(1)^2*x(2)*x(5)^.5*x(7)/(x(3)*x(6)^3);
    H(2,7) = -1.250*x(1)*x(4)^2/(x(2)^2*x(6)^3*x(7)^.875)+...
        15.0*x(3)*x(4)/(x(1)*x(2)^3*x(5)*x(7)^1.5)+50*x(1)^2*x(2)*x(5)^.5/(x(3)*x(6)^2);
    H(3,1) = H(1,3);
    H(3,2) = H(2,3);
    H(3,3) = 50*x(1)^2*x(2)^2*x(5)^.5*x(7)/(x(3)^3*x(6)^2);
    H(3,4) = 15*1/(x(1)*x(2)^2*x(5)*x(7)^.5);
    H(3,5) = -15*x(4)/(x(1)*x(2)^2*x(5)^2*x(7)^.5)-12.5*x(1)^2*x(2)^2*x(7)/(x(3)^2*x(5)^.5*x(6)^2);
    H(3,6) = 50*x(1)^2*x(2)^2*x(5)^.5*x(7)/(x(3)^2*x(6)^3);
    H(3,7) = -7.5*x(4)/(x(1)*x(2)^2*x(5)*x(7)^1.5)-25*x(1)^2*x(2)^2*x(5)^.5/(x(3)^2*x(6)^2);
    H(4,1) = H(1,4);
    H(4,2) = H(2,4);
    H(4,3) = H(3,4);
    H(4,4) = 20*x(1)*x(7)^.125/(x(2)*x(6)^3)+40*x(2)*x(6)/(x(1)^2*x(4)^3*x(5)^2);
    H(4,5) = -15*x(3)/(x(1)*x(2)^2*x(5)^2*x(7)^.5)+40*x(2)*x(6)/(x(1)^2*x(4)^2*x(5)^3);
    H(4,6) = -60*x(1)*x(4)*x(7)^.125/(x(2)*x(6)^4)-20*x(2)/(x(1)^2*x(4)^2*x(5)^2);
    H(4,7) = 2.500*x(1)*x(4)/(x(2)*x(6)^3*x(7)^.875)-7.5*x(3)/(x(1)*x(2)^2*x(5)*x(7)^1.5);
    H(5,1) = H(1,5);
    H(5,2) = H(2,5);
    H(5,3) = H(3,5);
    H(5,4) = H(4,5);
    H(5,5) = 30*x(3)*x(4)/(x(1)*x(2)^2*x(5)^3*x(7)^.5)+120*x(2)*x(6)/(x(1)^2*x(4)*x(5)^4)-...
        6.25*x(1)^2*x(2)^2*x(7)/(x(3)*x(5)^1.5*x(6)^2);
    H(5,6) = -40*x(2)/(x(1)^2*x(4)*x(5)^3)-25.0*x(1)^2*x(2)^2*x(7)/(x(3)*x(5)^.5*x(6)^3);
    H(5,7) = 7.5*x(3)*x(4)/(x(1)*x(2)^2*x(5)^2*x(7)^1.5)+12.5*x(1)^2*x(2)^2/(x(3)*x(5)^.5*x(6)^2);
    H(6,1) = H(1,6);
    H(6,2) = H(2,6);
    H(6,3) = H(3,6);
    H(6,4) = H(4,6);
    H(6,5) = H(5,6);
    H(6,6) = 120*x(1)*x(4)^2*x(7)^.125/(x(2)*x(6)^5)+150*x(1)^2*x(2)^2*x(5)^.5*x(7)/(x(3)*x(6)^4);
    H(6,7) = -3.750*x(1)*x(4)^2/(x(2)*x(6)^4*x(7)^.875)-50*x(1)^2*x(2)^2*x(5)^.5/(x(3)*x(6)^3);
    H(7,1) = H(1,7);
    H(7,2) = H(2,7);
    H(7,3) = H(3,7);
    H(7,4) = H(4,7);
    H(7,5) = H(5,7);
    H(7,6) = H(6,7);
    H(7,7) = -1.093750*x(1)*x(4)^2/(x(2)*x(6)^3*x(7)^1.875)+11.25*x(3)*x(4)/(x(1)*x(2)^2*x(5)*x(7)^2.5);
elseif P==74
    % HS 103
    H = zeros(7,7);
    H(1,1) = 30*x(3)*x(4)/(x(1)^3*x(2)^2*x(5)*x(7)^.5)+120*x(2)*x(6)/(x(1)^4*x(4)*x(5)^2)+...
        50*x(2)^2*x(5)^.5*x(7)/(x(3)*x(6)^2);
    H(1,2) = -10*x(4)^2*x(7)^.5/(x(2)^2*x(6)^3)+30*x(3)*x(4)/(x(1)^2*x(2)^3*x(5)*x(7)^.5)-...
        40*x(6)/(x(1)^3*x(4)*x(5)^2)+100*x(1)*x(2)*x(5)^.5*x(7)/(x(3)*x(6)^2);
    H(1,3) = -15*x(4)/(x(1)^2*x(2)^2*x(5)*x(7)^.5)-50*x(1)*x(2)^2*x(5)^.5*x(7)/(x(3)^2*x(6)^2);
    H(1,4) = 20*x(4)*x(7)^.5/(x(2)*x(6)^3)-15*x(3)/(x(1)^2*x(2)^2*x(5)*x(7)^.5)+40*x(2)*x(6)/(x(1)^3*x(4)^2*x(5)^2);
    H(1,5) =  15*x(3)*x(4)/(x(1)^2*x(2)^2*x(5)^2*x(7)^.5)+...
        80*x(2)*x(6)/(x(1)^3*x(4)*x(5)^3)+25.0*x(1)*x(2)^2*x(7)/(x(3)*x(5)^.5*x(6)^2);
    H(1,6) = -30*x(4)^2*x(7)^.5/(x(2)*x(6)^4)-40*x(2)/(x(1)^3*x(4)*x(5)^2)-...
        100*x(1)*x(2)^2*x(5)^.5*x(7)/(x(3)*x(6)^3);
    H(1,7) = 5.0*x(4)^2/(x(2)*x(6)^3*x(7)^.5)+7.5*x(3)*x(4)/(x(1)^2*x(2)^2*x(5)*x(7)^1.5)+...
        50*x(1)*x(2)^2*x(5)^.5/(x(3)*x(6)^2);
    H(2,1) = H(1,2);
    H(2,2) = 20*x(1)*x(4)^2*x(7)^.5/(x(2)^3*x(6)^3)+90*x(3)*x(4)/(x(1)*x(2)^4*x(5)*x(7)^.5)+...
        50*x(1)^2*x(5)^.5*x(7)/(x(3)*x(6)^2);
    H(2,3) = -30*x(4)/(x(1)*x(2)^3*x(5)*x(7)^.5)-50*x(1)^2*x(2)*x(5)^.5*x(7)/(x(3)^2*x(6)^2);
    H(2,4) = -20*x(1)*x(4)*x(7)^.5/(x(2)^2*x(6)^3)-30*x(3)/(x(1)*x(2)^3*x(5)*x(7)^.5)-...
        20*x(6)/(x(1)^2*x(4)^2*x(5)^2);
    H(2,5) = 30*x(3)*x(4)/(x(1)*x(2)^3*x(5)^2*x(7)^.5)-40*x(6)/(x(1)^2*x(4)*x(5)^3)+...
        25.0*x(1)^2*x(2)*x(7)/(x(3)*x(5)^.5*x(6)^2);
    H(2,6) = 30*x(1)*x(4)^2*x(7)^.5/(x(2)^2*x(6)^4)+20*1/(x(1)^2*x(4)*x(5)^2)-...
        100*x(1)^2*x(2)*x(5)^.5*x(7)/(x(3)*x(6)^3);
    H(2,7) = -5.0*x(1)*x(4)^2/(x(2)^2*x(6)^3*x(7)^.5)+...
        15.0*x(3)*x(4)/(x(1)*x(2)^3*x(5)*x(7)^1.5)+50*x(1)^2*x(2)*x(5)^.5/(x(3)*x(6)^2);
    H(3,1) = H(1,3);
    H(3,2) = H(2,3);
    H(3,3) = 50*x(1)^2*x(2)^2*x(5)^.5*x(7)/(x(3)^3*x(6)^2);
    H(3,4) = 15*1/(x(1)*x(2)^2*x(5)*x(7)^.5);
    H(3,5) = -15*x(4)/(x(1)*x(2)^2*x(5)^2*x(7)^.5)-12.5*x(1)^2*x(2)^2*x(7)/(x(3)^2*x(5)^.5*x(6)^2);
    H(3,6) = 50*x(1)^2*x(2)^2*x(5)^.5*x(7)/(x(3)^2*x(6)^3);
    H(3,7) = -7.5*x(4)/(x(1)*x(2)^2*x(5)*x(7)^1.5)-25*x(1)^2*x(2)^2*x(5)^.5/(x(3)^2*x(6)^2);
    H(4,1) = H(1,4);
    H(4,2) = H(2,4);
    H(4,3) = H(3,4);
    H(4,4) = 20*x(1)*x(7)^.5/(x(2)*x(6)^3)+40*x(2)*x(6)/(x(1)^2*x(4)^3*x(5)^2);
    H(4,5) = -15*x(3)/(x(1)*x(2)^2*x(5)^2*x(7)^.5)+40*x(2)*x(6)/(x(1)^2*x(4)^2*x(5)^3);
    H(4,6) = -60*x(1)*x(4)*x(7)^.5/(x(2)*x(6)^4)-20*x(2)/(x(1)^2*x(4)^2*x(5)^2);
    H(4,7) = 10.0*x(1)*x(4)/(x(2)*x(6)^3*x(7)^.5)-7.5*x(3)/(x(1)*x(2)^2*x(5)*x(7)^1.5);

    H(5,1) = H(1,5);
    H(5,2) = H(2,5);
    H(5,3) = H(3,5);
    H(5,4) = H(4,5);
    H(5,5) = 30*x(3)*x(4)/(x(1)*x(2)^2*x(5)^3*x(7)^.5)+...
        120*x(2)*x(6)/(x(1)^2*x(4)*x(5)^4)-6.25*x(1)^2*x(2)^2*x(7)/(x(3)*x(5)^1.5*x(6)^2);
    H(5,6) = -40*x(2)/(x(1)^2*x(4)*x(5)^3)-25.0*x(1)^2*x(2)^2*x(7)/(x(3)*x(5)^.5*x(6)^3);
    H(5,7) = 7.5*x(3)*x(4)/(x(1)*x(2)^2*x(5)^2*x(7)^1.5)+12.5*x(1)^2*x(2)^2/(x(3)*x(5)^.5*x(6)^2);
    H(6,1) = H(1,6);
    H(6,2) = H(2,6);
    H(6,3) = H(3,6);
    H(6,4) = H(4,6);
    H(6,5) = H(5,6);
    H(6,6) = 120*x(1)*x(4)^2*x(7)^.5/(x(2)*x(6)^5)+150*x(1)^2*x(2)^2*x(5)^.5*x(7)/(x(3)*x(6)^4);
    H(6,7) = -15.0*x(1)*x(4)^2/(x(2)*x(6)^4*x(7)^.5)-50*x(1)^2*x(2)^2*x(5)^.5/(x(3)*x(6)^3);
    H(7,1) = H(1,7);
    H(7,2) = H(2,7);
    H(7,3) = H(3,7);
    H(7,4) = H(4,7);
    H(7,5) = H(5,7);
    H(7,6) = H(6,7);
    H(7,7) = -2.50*x(1)*x(4)^2/(x(2)*x(6)^3*x(7)^1.5)+11.25*x(3)*x(4)/(x(1)*x(2)^2*x(5)*x(7)^2.5);
elseif P==75
    % HS 104
    H=[-0.8844e-1*1/(x(1)^1.33*x(7)^0.67)  0  0  0  0  0  -0.17956*1/(x(1)^0.33*x(7)^1.67)  0;
        0  -0.8844e-1*1/(x(2)^1.33*x(8)^0.67)  0  0  0  0  0  -0.17956*1/(x(2)^0.33*x(8)^1.67);
        0  0  0  0  0  0  0  0;
        0  0  0  0  0  0  0  0;
        0  0  0  0  0  0  0  0;
        0  0  0  0  0  0  0  0;
        -0.17956*1/(x(1)^0.33*x(7)^1.67)  0  0  0 0 0  0.44756*x(1)^.67/(x(7)^2.67) 0;
        0 -0.17956*1/(x(2)^0.33*x(8)^1.67) 0  0 0 0 0  0.44756*x(2)^.67/(x(8)^2.67)];
elseif P==76
    % HS 106
    H = 0*eye(8);
elseif P==77
    % HS 107
    H = zeros(9,9);
    H(1,1) = 6000*x(1);
    H(2,2) = 4000.002*x(2);
elseif P==78
    % HS 108
    H=[0   0   0  -0.5  0     0   0    0     0;
        0   0  0.5  0    0     0   0    0     0;
        0  0.5  0   0    0     0   0    0    -0.5;
        -0.5 0   0   0    0     0   0    0     0;
        0   0   0   0    0     0   0   -0.5   0.5;
        0   0   0   0    0     0   0.5   0    0;
        0   0   0   0    0   0.5   0     0    0;
        0   0   0   0  -0.5    0   0     0    0;
        0   0 -0.5  0   0.5    0   0     0    0];
elseif P==79
    % HS 109
    H = zeros(9,9);
    H(1,1) = 0.6e-5*x(1);
    H(2,2) = 0.3132444e-5*x(2);
elseif P==80
    % HS 111 %Equal to 378
    A = [-6.089;-17.164;-34.054;-5.914;-24.721;-14.986;-24.100;-10.708;-26.662;-22.179];
    H = zeros(10,10);
    exp_sum = 0;
    for j=1:10
        exp_sum = exp_sum + exp(x(j));
    end
    g = zeros(10,1);
    for i=1:10
        for j=1:i
            if i==j
                g(i) = exp(x(i))*(A(i)+x(i)-log(exp_sum));
                H(i,i) = g(i) + exp(x(i))*(1-exp(x(i))/exp_sum);
            else
                H(i,j) = -exp(x(i))*exp(x(j))/exp_sum;
                H(j,i) = H(i,j);
            end
        end
    end
elseif P==81
    % HS 112
    H = zeros(10,10);
    x_sum = 0;
    for j=1:10
        x_sum = x_sum + x(j);
    end
    for i=1:10
        for j=1:i
            if i==j
                H(i,i) = (1/x(i)-1/x_sum);
            else
                H(i,j) = -1/x_sum;
                H(j,i) = H(i,j);
            end
        end
    end
elseif P==82
    % HS 113
    H=[2 1 0 0 0 0 0 0 0 0;
        1 2 0 0 0 0 0 0 0 0;
        0 0 2 0 0 0 0 0 0 0;
        0 0 0 8 0 0 0 0 0 0;
        0 0 0 0 2 0 0 0 0 0;
        0 0 0 0 0 4 0 0 0 0;
        0 0 0 0 0 0 10 0 0 0;
        0 0 0 0 0 0 0 14 0 0;
        0 0 0 0 0 0 0 0 4 0;
        0 0 0 0 0 0 0 0 0 2];
elseif P==83
    % HS 114
    H = zeros(10,10);
    H(4,7) = -0.063;
    H(7,4) = -0.063;
elseif P==84
    % HS 116
    H=zeros(13,13);
elseif P==85
    % HS 117
    c=[30  -20  -10   32  -10 0 0 0 0 0 0 0 0 0 0;
        -20   39   -6  -31   32 0 0 0 0 0 0 0 0 0 0;
        -10   -6   10   -6  -10 0 0 0 0 0 0 0 0 0 0;
        32  -31   -6   39  -20 0 0 0 0 0 0 0 0 0 0;
        -10   32  -10  -20   30 0 0 0 0 0 0 0 0 0 0;
        0 0 0 0 0 0 0 0 0 0  0    0    0    0    0;
        0 0 0 0 0 0 0 0 0 0  0    0    0    0    0;
        0 0 0 0 0 0 0 0 0 0  0    0    0    0    0;
        0 0 0 0 0 0 0 0 0 0  0    0    0    0    0;
        0 0 0 0 0 0 0 0 0 0  0    0    0    0    0;
        0 0 0 0 0 0 0 0 0 0  0    0    0    0    0;
        0 0 0 0 0 0 0 0 0 0  0    0    0    0    0;
        0 0 0 0 0 0 0 0 0 0  0    0    0    0    0;
        0 0 0 0 0 0 0 0 0 0  0    0    0    0    0;
        0 0 0 0 0 0 0 0 0 0  0    0    0    0    0;
        0 0 0 0 0 0 0 0 0 0  0    0    0    0    0];
    d=[4   8   10   6  2];
    H=zeros(15,15);
    for i=1:5
        for j=1:5
            H(10+i,10+j)=2*c(i,j)+12*d(j)*x(10+j);
        end
    end
    H = 0.5*(H+H');
elseif P==86
    % HS 119
    a=[1 0 0 1 0 0 1 1 0 0 0 0 0 0 0 1;
        0 1 1 0 0 0 1 0 0 1 0 0 0 0 0 0;
        0 0 1 0 0 0 1 0 1 1 0 0 0 1 0 0;
        0 0 0 1 0 0 1 0 0 0 1 0 0 0 1 0;
        0 0 0 0 1 1 0 0 0 1 0 1 0 0 0 1;
        0 0 0 0 0 1 0 1 0 0 0 0 0 0 1 0;
        0 0 0 0 0 0 1 0 0 0 1 0 1 0 0 0;
        0 0 0 0 0 0 0 1 0 1 0 0 0 0 1 0;
        0 0 0 0 0 0 0 0 1 0 0 1 0 0 0 1;
        0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 0;
        0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0;
        0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0;
        0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0;
        0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0;
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0;
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1];
    for i=1:16
        for j=1:16
            Hdiag = 2*((2*x(i)+1)*(2*x(i)+1)+(x(i)^2+x(i)+1)*2)+2*x(i)*(x(j)^2+x(j)+1);
            Hothers=(2*x(i)+1)*(2*x(j)+1);
        end
    end
    hd=eye(16)*Hdiag;%diagonal elements in the hessian
    hot=(a-eye(16))*Hothers;%others elements in the hessian
    H=hd+hot+hot';
elseif P==87
    % HS 215
    %H=[0;0;0;0];
    H=zeros(2,2);
elseif P==88
    % HS 216
    H=[1200*x(1)^2-400*x(2)+2  -400*x(1);
        -400*x(1)  200];
elseif P==89
    % HS 217
    H=[0 0;0 0];
elseif P==90
    % HS 218
    H=[0 0;0 0];
end

function H=chs_H3(x, P)

if P==91
    % HS 219
    H = zeros(4,4);
elseif P==92
    % HS 220
    H = zeros(2,2);
elseif P==93
    % HS 221
    H = zeros(2,2);
elseif P==94
    %HS 223
    H = zeros(2,2);
elseif P==95
    %HS 224
    H = zeros(2,2);
elseif P==96
    %HS 225
    H=[2 0;0 2];
elseif P==97
    %HS 226
    H=[0 1;1 0];
elseif P==98
    %HS 227
    H=[2 0;0 2];
elseif P==99
    %HS 228
    H=[2 0;0 0];
elseif P==100
    %HS 230
    H = zeros(2,2);
elseif P==101
    %HS 231
    H=[1200*x(1)^2-400*x(2)+2 -400*x(1); -400*x(1)  200];
elseif P==102
    %HS 232
    H=[2/81*x(2)^3*sqrt(3)  -1/27*(-2*x(1)+6)*x(2)^2*sqrt(3);
        -1/27*(-2*x(1)+6)*x(2)^2*sqrt(3) -2/27*(9-(x(1)-3)^2)*x(2)*sqrt(3)];
elseif P==103
    % HS 233
    H=[1200*x(1)^2-400*x(2)+2  -400*x(1);
        -400*x(1)  200];
elseif P==104
    % HS 234
    H=[12*(x(2)-x(1))^2  -12*(x(2)-x(1))^2;
        -12*(x(2)-x(1))^2  12*(x(2)-x(1))^2];
elseif P==105
    %HS 235
    H=[0.2e-1+12*x(1)^2-4*x(2)  -4*x(1)  0;
        -4*x(1)  2  0
        0  0  0];
elseif P==106
    % HS 236
    X1 = x(1);
    X2 = x(2);
    B =[75.1963666677;-3.8112755343;.1269366345;-.0020567665;.0000103450;-6.8306567613;...
        3.02344793e-2;-1.2813448e-3;3.52559e-5;-2.266e-7;0.2564581253;-3.460403e-3;...
        1.35139D-5;-28.1064434908;-5.2375e-6;-6.3e-9;7.e-10;3.405462e-4;-1.6638e-6;-2.8673112392];
    H = zeros(2,2);
    H(1,1) = B(3)*2+B(4)*6*X1+...
        B(5)*12*X1^2+B(8)*2*X2 +...
        B(9)*6*X1*X2+B(10)*12*X1^2*X2 +...
        B(15)*2*X2^2+B(16)*6*X1*X2^2 +...
        B(17)*6*X1*X2^3+B(20)*(exp(5e-4*X1*X2))*(5e-4*X2)^2;
    H(1,2) = B(7)+B(8)*2*X1+B(9)*3*X1^2+B(10)*4*X1^3+...
        B(15)*4*X1*X2+B(16)*6*X1^2*X2 +...
        B(17)*9*X1^2*X2^2+B(18)*2*X2+B(19)*3*X2^2+...
        B(20)*(exp(5e-4*X1*X2))*(5e-4*X2)*(5e-4*X1);
    H(2,1) = H(1,2);
    H(2,2) = B(11)*2+B(12)*6*X2+B(13)*12*X2^2+B(14)*(2/(X2+1)^3)+...
        B(15)*X1^2*2+B(16)*X1^3*2+B(17)*X1^3*6*X2+B(18)*X1*2+...
        B(19)*X1*6*X2+B(20)*(exp(5e-4*X1*X2))*(5e-4*X1)^2;
elseif P==107
    % HS 237
    X1 = x(1);
    X2 = x(2);
    B =[75.1963666677;-3.8112755343;.1269366345;-.0020567665;.0000103450;-6.8306567613;...
        3.02344793e-2;-1.2813448e-3;3.52559e-5;-2.266e-7;0.2564581253;-3.460403e-3;...
        1.35139D-5;-28.1064434908;-5.2375e-6;-6.3e-9;7.e-10;3.405462e-4;-1.6638e-6;-2.8673112392];
    H = zeros(2,2);
    H(1,1) = B(3)*2+B(4)*6*X1+...
        B(5)*12*X1^2+B(8)*2*X2 +...
        B(9)*6*X1*X2+B(10)*12*X1^2*X2 +...
        B(15)*2*X2^2+B(16)*6*X1*X2^2 +...
        B(17)*6*X1*X2^3+B(20)*(exp(5e-4*X1*X2))*(5e-4*X2)^2;
    H(1,2) = B(7)+B(8)*2*X1+B(9)*3*X1^2+B(10)*4*X1^3+...
        B(15)*4*X1*X2+B(16)*6*X1^2*X2 +...
        B(17)*9*X1^2*X2^2+B(18)*2*X2+B(19)*3*X2^2+...
        B(20)*(exp(5e-4*X1*X2))*(5e-4*X2)*(5e-4*X1);
    H(2,1) = H(1,2);
    H(2,2) = B(11)*2+B(12)*6*X2+B(13)*12*X2^2+B(14)*(2/(X2+1)^3)+...
        B(15)*X1^2*2+B(16)*X1^3*2+B(17)*X1^3*6*X2+B(18)*X1*2+...
        B(19)*X1*6*X2+B(20)*(exp(5e-4*X1*X2))*(5e-4*X1)^2;
elseif P==108
    % HS 238
    X1 = x(1);
    X2 = x(2);
    B =[75.1963666677;-3.8112755343;.1269366345;-.0020567665;.0000103450;-6.8306567613;...
        3.02344793e-2;-1.2813448e-3;3.52559e-5;-2.266e-7;0.2564581253;-3.460403e-3;...
        1.35139D-5;-28.1064434908;-5.2375e-6;-6.3e-9;7.e-10;3.405462e-4;-1.6638e-6;-2.8673112392];
    H = zeros(2,2);
    H(1,1) = B(3)*2+B(4)*6*X1+...
        B(5)*12*X1^2+B(8)*2*X2 +...
        B(9)*6*X1*X2+B(10)*12*X1^2*X2 +...
        B(15)*2*X2^2+B(16)*6*X1*X2^2 +...
        B(17)*6*X1*X2^3+B(20)*(exp(5e-4*X1*X2))*(5e-4*X2)^2;
    H(1,2) = B(7)+B(8)*2*X1+B(9)*3*X1^2+B(10)*4*X1^3+...
        B(15)*4*X1*X2+B(16)*6*X1^2*X2 +...
        B(17)*9*X1^2*X2^2+B(18)*2*X2+B(19)*3*X2^2+...
        B(20)*(exp(5e-4*X1*X2))*(5e-4*X2)*(5e-4*X1);
    H(2,1) = H(1,2);
    H(2,2) = B(11)*2+B(12)*6*X2+B(13)*12*X2^2+B(14)*(2/(X2+1)^3)+...
        B(15)*X1^2*2+B(16)*X1^3*2+B(17)*X1^3*6*X2+B(18)*X1*2+...
        B(19)*X1*6*X2+B(20)*(exp(5e-4*X1*X2))*(5e-4*X1)^2;
elseif P==109
    % HS 239
    X1 = x(1);
    X2 = x(2);
    H = zeros(2,2);
    B =[75.1963666677;-3.8112755343;.1269366345;-.0020567665;.0000103450;-6.8306567613;...
        3.02344793e-2;-1.2813448e-3;3.52559e-5;-2.266e-7;0.2564581253;-3.460403e-3;...
        1.35139D-5;-28.1064434908;-5.2375e-6;-6.3e-9;7.e-10;3.405462e-4;-1.6638e-6;-2.8673112392];
    H(1,1) = B(3)*2+B(4)*6*X1+...
        B(5)*12*X1^2+B(8)*2*X2 +...
        B(9)*6*X1*X2+B(10)*12*X1^2*X2 +...
        B(15)*2*X2^2+B(16)*6*X1*X2^2 +...
        B(17)*6*X1*X2^3+B(20)*(exp(5e-4*X1*X2))*(5e-4*X2)^2;
    H(1,2) = B(7)+B(8)*2*X1+B(9)*3*X1^2+B(10)*4*X1^3+...
        B(15)*4*X1*X2+B(16)*6*X1^2*X2 +...
        B(17)*9*X1^2*X2^2+B(18)*2*X2+B(19)*3*X2^2+...
        B(20)*(exp(5e-4*X1*X2))*(5e-4*X2)*(5e-4*X1);
    H(2,1) = H(1,2);
    H(2,2) = B(11)*2+B(12)*6*X2+B(13)*12*X2^2+B(14)*(2/(X2+1)^3)+...
        B(15)*X1^2*2+B(16)*X1^3*2+B(17)*X1^3*6*X2+B(18)*X1*2+...
        B(19)*X1*6*X2+B(20)*(exp(5e-4*X1*X2))*(5e-4*X1)^2;
    H = -H;
elseif P==110
    % HS 248
    H = zeros(3,3);
elseif P==111
    % HS 249
    H = [2 0 0;0 2 0;0 0 2];
elseif P==112
    % HS 250
    H = [0 -x(3) -x(2);-x(3) 0 -x(1);-x(2) -x(1) 0];
elseif P==113
    % HS 251
    H = [0 -x(3) -x(2);-x(3) 0 -x(1);-x(2) -x(1) 0];
elseif P==114
    % HS 252
    H = [.02-4*(x(2)-x(1)^2)+8*x(1)^2 -4*x(1) 0;-4*x(1) 2 0;0 0 0];
elseif P==115
    % HS 253
    a = [0 10 10 0 0 10 10 0 ;0 0 10 10 0 0 10 10;0 0 0 0 10 10 10 10];
    H = zeros(3,3);
    for j=1:8
        Q = sqrt((a(1,j)-x(1))^2+(a(2,j)-x(2))^2+(a(3,j)-x(3))^2);
        Q2 = ((a(1,j)-x(1))^2+(a(2,j)-x(2))^2+(a(3,j)-x(3))^2);
        h11_j = (Q-2*(a(1,j)-x(1))^2)/Q2;
        h12_j = -2*(a(1,j)-x(1))*(a(2,j)-x(2))/Q2;
        h13_j = -2*(a(1,j)-x(1))*(a(3,j)-x(3))/Q2;
        h21_j = -2*(a(1,j)-x(1))*(a(2,j)-x(2))/Q2;
        h22_j = (Q-2*(a(2,j)-x(2))^2)/Q2;
        h23_j = -2*(a(2,j)-x(2))*(a(3,j)-x(3))/Q2;
        h31_j = -2*(a(1,j)-x(1))*(a(3,j)-x(3))/Q2;
        h32_j = -2*(a(2,j)-x(2))*(a(3,j)-x(3))/Q2;
        h33_j = (Q-2*(a(3,j)-x(3))^2)/Q2;
        H(1,1) = H(1,1) + h11_j;
        H(1,2) = H(1,2) + h12_j;
        H(1,3) = H(1,3) + h13_j;
        H(2,1) = H(2,1) + h21_j;
        H(2,2) = H(2,2) + h22_j;
        H(2,3) = H(2,3) + h23_j;
        H(3,1) = H(3,1) + h31_j;
        H(3,2) = H(3,2) + h32_j;
        H(3,3) = H(3,3) + h33_j;
    end
elseif P==116
    % HS 254
    H = [0 0 0;0 0 0;0 0 -1/x(3)^2];
elseif P==117
    % HS 263
    H = zeros(4,4);
elseif P==118
    % HS 264
    H = [2 0 0 0;0 2 0 0;0 0 4 0;0 0 0 2];
elseif P==119
    % HS 265
    H = zeros(4,4);
    for i=1:2
        H(i,i)   = 10*exp(-x(i+2))*(-10*exp(-x(i+2)))*exp(-10*x(i)*exp(-x(i+2)));
        H(i,i+2) = -10*exp(-x(i+2))*exp(-10*x(i)*exp(-x(i+2))) + 10*exp(-x(i+2))*(+10*x(i)*exp(-x(i+2)))*exp(-10*x(i)*exp(-x(i+2)));
        H(i+2,i) = H(i,i+2);
    end
elseif P==120
    % HS 270
    x1 = x(1);
    x2 = x(2);
    x3 = x(3);
    x4 = x(4);
    x5 = x(5);
    H = [0 x3*x4-3*x4-4*x3+12 x2*x4-4*x2-2*x4+8 x2*x3-3*x2-2*x3+6 0;
        x3*x4-3*x4-4*x3+12 0 x1*x4-4*x1-x4+4 x1*x3-3*x1-x3+3 0;
        x2*x4-4*x2-2*x4+8 x1*x4-4*x1-x4+4 0 x1*x2-x2-2*x1+2 0;
        x2*x3-3*x2-2*x3+6 x1*x3-3*x1-x3+3 x1*x2-x2-2*x1+2 0 0;
        0 0 0 0 1.5*12*x5^2-5.75*6*x5+5.25*2];
elseif P==121
    % HS 284
    H = zeros(15,15);
elseif P==122
    % HS 285
    H = zeros(15,15);
elseif P==123
    % HS 315
    H = zeros(2,2);
elseif P==124
    % HS 316
    H = [2 0;0 2];
elseif P==125
    % HS 317
    H = [2 0;0 2];
elseif P==126
    % HS 318
    H = [2 0;0 2];
elseif P==127
    % HS 319
    H = [2 0;0 2];
elseif P==128
    % HS 320
    H = [2 0;0 2];
elseif P==129
    % HS 321
    H = [2 0;0 2];
elseif P==130
    % HS 322
    H = [2 0;0 2];
elseif P==131
    % HS 323
    H = [2 0;0 2];
elseif P==132
    % HS 324
    H = [.02 0;0 2];
elseif P==133
    % HS 325
    H = [2 0;0 0];
elseif P==134
    % HS 326
    H = [2 0;0 2];
elseif P==135
    % HS 327
    y = [.49;.49;.48;.47;.48;.47;.46;.46;.45;
        .43;.45;.43;.43;.44;.43;.43;.46;.45;
        .42;.42;.43;.41;.41;.4;.42;.4;.4;.41;
        .4;.41;.41;.4;.4;.4;.38;.41;.4;.4;.41;
        .38;.4;.4;.39;.39];
    z = [8;8;10;10;10;10;12;12;12;12;14;14;14;16;16;16;18;18;20;20;20;22;22;22;24;24;24;26;26;26;28;28;30;30;30;32;32;34;36;36;38;38;40;42];
    for i=1:44
        A = exp(-x(2)*(z(i)-8));
        h11 = 2*(-1 + A)^2;
        h12 = 2*(-(z(i)-8)*A*(y(i)-x(1)-(.49-x(1))*A)+...
            (-1+A)*(.49-x(1))*(z(i)-8)*A);
        h21 = h12;
        h22 = 2*(-(.49-x(1))*(z(i)-8)^2*A*(y(i)-x(1)-(.49-x(1))*A)+...
            (.49-x(1))*(z(i)-8)*A*(.49-x(1))*(z(i)-8)*A);
    end
    H = [h11 h21;h21 h22];
end

function H=chs_H4(x, P)

if P==136
    % HS 329
    H = [6*(x(1)-10) 0;0 6*(x(2)-20)];
elseif P==137
    % HS 330
    h11 = .044*6*x(1)/x(2)^2+20/x(1)^3;
    h12 = -.044*6*x(1)^2/x(2)^3-3*.0592/x(2)^4;
    h22 = 6*.044*x(1)^3/x(2)^4+12*.0592*x(1)/x(2)^5;
    H = [h11 h12;h12 h22];
elseif P==138
    % HS 331
    A = (x(1)+x(2));
    h11 = 2/x(1)^3*log(2*log(x(2))/log(A))+2/x(1)^2*1/(A*log(A))+1/x(1)*(1+log(A))/(A*log(A))^2;
    h12 = -1/x(1)^2*1/(x(2)*log(x(2)))-1/(A*log(A))+1/x(1)*(1+log(A))/(A*log(A))^2;
    h22 = -1/x(1)*((1+log(x(2)))/(x(2)*log(x(2)))^2+(1+log(A))/(A*log(A))^2);
    H = [h11 h12;h12 h22];
elseif P==139
    % HS 332
    H = [2 0;0 2];
elseif P==140
    % HS 335
    H = zeros(3,3);
elseif P==141
    % HS 336
    H = zeros(3,3);
elseif P==142
    % HS 337
    H = [18 0 0;0 2 0;0 0 18];
elseif P==143
    % HS 338
    H = [-2 0 0;0 -2 0;0 0 -2];
elseif P==144
    % HS 339
    H = [.2*(x(2)*x(3))^2/(x(1)*x(2)*x(3))+8/x(1)^3 0 0;
        0 .2*(x(1)*x(3))^2/(x(1)*x(2)*x(3)) 0;
        0 0 .2*(x(1)*x(2))^2/(x(1)*x(2)*x(3))];
elseif P==145
    % HS 340
    H = [0 -x(3) -x(2);-x(3) 0 -x(1);-x(2) -x(1) 0];
elseif P==146
    % HS 341
    H = [0 -x(3) -x(2);-x(3) 0 -x(1);-x(2) -x(1) 0];
elseif P==147
    % HS 342
    H = [0 -x(3) -x(2);-x(3) 0 -x(1);-x(2) -x(1) 0];
elseif P==148
    % HS 343
    H = zeros(3,3);
    H(1,1) = (-.0201*12*x(1)^2*x(2)*x(3)^2)*1e-7;
    H(1,2) = (-.0201*4*x(1)^2*x(3)^2)*1e-7;
    H(1,3) = (-.0201*8*x(1)^3*x(2)*x(3))*1e-7;
    H(2,1) = H(1,2);
    H(2,3) = (-.0201*2*x(1)^4*x(3))*1e-7;
    H(3,1) = H(1,3);
    H(3,2) = H(2,3);
    H(3,3) = (-.0201*2*x(1)^4*x(2))*1e-7;
elseif P==149
    % HS 344
    H = [4 -2 0;-2 2+12*(x(2)-x(3))^2 -12*(x(2)-x(3))^2;
        0 -12*(x(2)-x(3))^2 12*(x(2)-x(3))^2];
elseif P==150
    % HS 345
    H = [4 -2 0;-2 2+12*(x(2)-x(3))^2 -12*(x(2)-x(3))^2;
        0 -12*(x(2)-x(3))^2 12*(x(2)-x(3))^2];
elseif P==151
    % HS 346
    H = zeros(3,3);
    H(1,1) = (-.0201*12*x(1)^2*x(2)*x(3)^2)*1e-7;
    H(1,2) = (-.0201*4*x(1)^3*x(3)^2)*1e-7;
    H(1,3) = (-.0201*8*x(1)^3*x(2)*x(3))*1e-7;
    H(2,1) = H(1,2);
    H(2,3) = (-.0201*2*x(1)^4*x(3))*1e-7;
    H(3,1) = H(1,3);
    H(3,2) = H(2,3);
    H(3,3) = (-.0201*2*x(1)^4*x(2))*1e-7;
elseif P==15222
    % HS 347
    H = [];
elseif P==153
    % HS 353
    H = zeros(4,4);
elseif P==154
    % HS 354
    H = [2+120*(x(1)-x(4))^2 20 0 -120*(x(1)-x(4))^2;
        20 200+12*(x(2)-2*x(3))^2 -24*(x(2)-2*x(3))^2 0;
        0 -24*(x(2)-2*x(3))^2 10+32*(x(2)-2*x(3))^2 -10;
        -120*(x(1)-x(4))^2 0 -10 10+80*(x(1)-x(4))^2];
elseif P==155
    % HS 355
    r(1) = 11-x(1)*x(4)-x(2)*x(4)+x(3)*x(4);
    r(2) = x(1)+10*x(2)-x(3)+x(4)+x(2)*x(4)*(x(3)-x(1));
    h11 = 2*x(4)^2+2*(1-x(2)*x(4))^2;
    h12 = 2*x(4)^2-x(4)*2*r(2)+(1-x(2)*x(4))*2*(10+x(4)*(x(3)-x(1)));
    h13 = -2*x(4)^2+2*(1-x(2)*x(4))*(-1+x(2)*x(4));
    h14 = -2*r(1)-2*x(4)*(-x(1)-x(2)+x(3))-x(2)*2*r(2)+2*(1-x(2)*x(4))*(1+x(2)*(x(3)-x(1)));
    h22 = 2*x(4)^2+2*(10+x(4)*(x(3)-x(1)))^2;
    h23 = -2*x(4)^2+2*x(4)*r(2)+2*(10+x(4)*(x(3)-x(1)))*(-1+x(2)*x(4));
    h24 = -2*r(1)-2*x(4)*(-x(1)-x(2)+x(3))+2*(x(3)-x(1))*r(2)+2*(10+x(4)*(x(3)-x(1)))*(1+x(2)*(x(3)-x(1)));
    h33 = 2*x(4)^2+2*(-1+x(2)*x(4))^2;
    h34 = 2*r(1)+2*x(4)*(-x(1)-x(2)+x(3))+2*x(2)*r(2)+2*(-1+x(2)*x(4))*(1+x(2)*(x(3)-x(1)));
    h44 = 2*(-x(1)-x(2)+x(3))^2+2*(1+x(2)*(x(3)-x(1)))^2;
    H = [h11 h12 h13 h14
        h12 h22 h23 h24
        h13 h23 h33 h34
        h14 h24 h34 h44];
elseif P==156
    % HS 356
    H = [2*1.10471*x(2) 2*1.10471*x(1) 0 0;
        2*1.10471*x(1) 0 .04811*x(4) .04811*x(3);
        0 .04811*x(4) 0 .04811*(14+x(2));
        0 .04811*x(3) .04811*(14+x(2)) 0];
elseif P==157
    % HS 360
    c =[-0.8720288849e+7;0.1505125233e+6;-0.1566950325e+3;0.4764703222e+6;0.7294828271e+6;
        -0.3266695104e+6;0.739068412e+4;-0.278986976e+2;0.16643076e+5;0.30988146e+5];
    H = [0 -c(2) -c(3) -c(4) -c(5);
        -c(2) 0 0 0 0;
        -c(3) 0 0 0 0;
        -c(4) 0 0 0 0;
        -c(5) 0 0 0 0];
elseif P==158
    % HS 361
    A =[-0.8720288849e+7;0.1505125233e+6;-0.1566950325e+3;0.4764703222e+6;0.7294828271e+6];
    H = [0 -A(2) -A(3) -A(4) -A(5);
        -A(2) 0 0 0 0;
        -A(3) 0 0 0 0;
        -A(4) 0 0 0 0;
        -A(5) 0 0 0 0];
elseif P==159
    % HS 365
    H = zeros(7,7);
    H(1,3) = 1;
    H(3,1) = 1;
elseif P==160
    % HS 366
    H = [0 0 0 0 0 .035 0;
        0 0 0 0 0 0 0;
        0 0 0 0 -.063 0 0;
        0 0 0 0 0 0 0;
        0 0 -.063 0 0 0 0;
        .035 0 0 0 0 0 0;
        0 0 0 0 0 0 0];
elseif P==161
    % HS 367
    H = [0 0 -1 0 0 0 0;
        0 0 0 0 0 0 0
        -1 0 0 0 0 0 0
        0 0 0 0 0 0 0
        0 0 0 0 10/(1+x(5))^3 0 0
        0 0 0 0 0 16/(1+x(6))^3 0
        0 0 0 0 0 0 -10*(-2*exp(-x(7))+4*exp(-2*x(7)))];
elseif P==162
    % HS 369
    H =zeros(8,8);
elseif P==163
    % HS 372
    H =[0 0 0 0 0 0 0 0 0;
        0 0 0 0 0 0 0 0 0;
        0 0 0 0 0 0 0 0 0;
        0 0 0 2 0 0 0 0 0;
        0 0 0 0 2 0 0 0 0;
        0 0 0 0 0 2 0 0 0;
        0 0 0 0 0 0 2 0 0
        0 0 0 0 0 0 0 2 0;
        0 0 0 0 0 0 0 0 2];
elseif P==164
    % HS 373
    H =[0 0 0 0 0 0 0 0 0;
        0 0 0 0 0 0 0 0 0;
        0 0 0 0 0 0 0 0 0;
        0 0 0 2 0 0 0 0 0;
        0 0 0 0 2 0 0 0 0;
        0 0 0 0 0 2 0 0 0;
        0 0 0 0 0 0 2 0 0
        0 0 0 0 0 0 0 2 0;
        0 0 0 0 0 0 0 0 2];
elseif P==165
    % HS 374
    H =zeros(10,10);
elseif P==166
    % Hock-Shittkowski 375
    H = -2*eye(10);
elseif P==167
    % HS 376
    H = zeros(10,10);
    H(1,1) = -.5E9*(-603.+50000*x(2))/(1+500*x(1)+30000*x(2))^3;
    H(2,2) =  .12E13*(907+1250*x(1))/(1+500*x(1)+30000*x(2))^3;
    H(1,2) =  .5E10*(3623+2500*x(1)-150000*x(2))/(1+500*x(1)+30000*x(2))^3;
    H(2,1) = H(1,2);
elseif P==168
    % HS 377
    H = zeros(10,10);
    x_sum = 0;
    for j=1:10
        x_sum = x_sum + x(j);
    end
    for i=1:10
        for j=1:i
            if i==j
                H(i,i) = (1/x(i)-1/x_sum);
            else
                H(i,j) = -1/x_sum;
                H(j,i) = H(i,j);
            end
        end
    end
elseif P==169
    % HS 378
    A = [-6.089;-17.164;-34.054;-5.914;-24.721;-14.986;-24.100;-10.708;-26.662;-22.179];
    H = zeros(10,10);
    exp_sum = 0;
    for j=1:10
        exp_sum = exp_sum + exp(x(j));
    end
    g = zeros(10,1);
    for i=1:10
        for j=1:i
            if i==j
                g(i) = exp(x(i))*((A(i)+x(i)-log(exp_sum))+(1-exp(x(i))/exp_sum));
                H(i,i) = g(i) + exp(x(i))*((1-exp(x(i))/exp_sum)-exp(x(i))*(1-exp(x(i)))/exp_sum^2);
            else
                H(i,j) = exp(x(i))*(-exp(x(j))/exp_sum+exp(x(i))*exp(x(j))/exp_sum^2);
                H(j,i) = H(i,j);
            end
        end
    end
elseif P==170
    % HS 380
    a = [-.00133172;-.002270927;-.00248546;-4.67;-4.671973;-.00814;-.008092;
        -.005;-.000909;-.00088;-.00119];
    H = zeros(12,12);
    f = 1e5 * x(1:11).^a;
    g = f.*a.* x(1:11).^-1;
    for i=1:11 % Gradient
        for j=1:i % Variabel
            temp = x(j);
            if j==i & j == 1 % Diag.
                H(i,j) = g(i)*(a(i)-1)*temp^-1;
            end
        end
    end
elseif P==171
    %HS 382
    H=zeros(13,13);
elseif P==172
    %HS 383
    H=[25684.550*1/(x(1)^3)  0 0 0 0 0 0 0 0 0 0 0 0 0;
        0 1268.50*1/(x(2)^3) 0 0 0 0 0 0 0 0 0 0 0 0;
        0 0 1268.50*1/(x(3)^3) 0 0 0 0 0 0 0 0 0 0 0;
        0 0 0 1268.50*1/(x(4)^3) 0 0 0 0 0 0 0 0 0 0;
        0 0 0 0 2536*1/(x(5)^3) 0 0 0 0 0 0 0 0 0;
        0 0 0 0 0 1267.750*1/(x(6)^3) 0 0 0 0 0 0 0 0;
        0 0 0 0 0 0 1267.50*1/(x(7)^3) 0 0 0 0 0 0 0;
        0 0 0 0 0 0 0 2534*1/(x(8)^3) 0 0 0 0 0 0;
        0 0 0 0 0 0 0 0 1520.1*1/(x(9)^3) 0 0 0 0 0;
        0 0 0 0 0 0 0 0 0 1266.50*1/(x(10)^3) 0 0 0 0;
        0 0 0 0 0 0 0 0 0 0 2532.50*1/(x(11)^3) 0 0 0;
        0 0 0 0 0 0 0 0 0 0 0 1265.750*1/(x(12)^3) 0 0;
        0 0 0 0 0 0 0 0 0 0 0 0 788.92*1/(x(13)^3) 0;
        0 0 0 0 0 0 0 0 0 0 0 0 0 1881.676*1/(x(14)^3)];
elseif P==173
    %HS 384
    H=zeros(15,15);
elseif P==174
    % HS 385
    H=zeros(15,15);
elseif P==175
    % HS 386
    H=zeros(15,15);
elseif P==176
    % HS 387
    H=zeros(15,15);
elseif P==177
    % HS 388
    H=zeros(15,15);
elseif P==178
    % HS 389
    H=zeros(15,15);
elseif P==179
    % HS 394
    d = zeros(20,1);
    for i=1:20
        d(i)=2*(i+i*6*x(i)^2);
    end
    H=diag(d);
elseif P==180
    % HS 395
    d = zeros(50,1);
    for i=1:50
        d(i)=2*(i+i*6*x(i)^2);
    end
    H=diag(d);
end

% MODIFICATION LOG:
%
% 990601  mbk  First version.
% 990730  ---  Richardo Augilar & Henrik Jnsson
% 010416  hkh  Modified for v3.0
% 030211  hkh  Missing * in HS59, #41. ] in problem #72, #73
% 030211  hkh  Problem #159. Illegal code H(1,3) = H(3,1) = 1;
% 030211  hkh  Problem #40.  FI22 = 2*(-b(i)+x(1)+2*UV)*Z^2*U*V;, i should be j
% 030211  hkh  Problem #169.  Adding * in H(i,i) = ...-exp(x(i))*(1-exp(x(i))
% 031113  ango Error in Problem 87 fixed.
% 041129  med  Hessian fixed for 2, 41, 44
% 041130  med  Hessian fixed for 49, 50, 60, 65
% 050215  med  Hessian fixed for 18, 37, 70, 85, 86, 119, 120 and 151
% 050801  med  Hessian now symmetric for 104
% 080603  med  Switched to conAssign, cleaned