% function g = uhs_g(x,Prob)
%
% Gradient for test functions for Unconstrained optimization.

% Kenneth Holmstrom, Tomlab Optimization Inc., E-mail: tomlab@tomopt.com.
% Copyright (c) 1999-2008 by Tomlab Optimization Inc. $Release: 6.2.0$
% Written June 1, 1999.   Last modified Jun 3, 2008.

function g = uhs_g(x,Prob)

x=x(:);
P=Prob.P;

if P == 1 % HS 1
    g = [-400*x(1)*(x(2)-x(1)^2)-2*(1-x(1))
        200*(x(2)-x(1)^2)];
elseif P == 2 % HS 2
    g = [-400*x(1)*(x(2)-x(1)^2)-2*(1-x(1))
        200*(x(2)-x(1)^2)];
elseif P == 3 % HS 3
    g = [-2*1E-5*(x(2)-x(1))
        1+2E-5*(x(2)-x(1))];
elseif P == 4 % HS 4
    g = [(x(1)+1)^2;1];
elseif P == 5 % HS 5
    g = [cos(x(1)+x(2))+2*(x(1)-x(2))-1.5
        cos(x(1)+x(2))-2*(x(1)-x(2))+2.5];
elseif P == 6 % HS 38
    g = [-400*(x(2)-x(1)^2)*x(1)-2+2*x(1)
        220.2*x(2)-200*x(1)^2-40.0+19.8*x(4)
        -360*(x(4)-x(3)^2)*x(3)-2+2*x(3)
        200.2*x(4)-180*x(3)^2-40.0+19.8*x(2)];
elseif P == 7 % HS 45
    g = [-1/120*x(2)*x(3)*x(4)*x(5)
        -1/120*x(1)*x(3)*x(4)*x(5)
        -1/120*x(1)*x(2)*x(4)*x(5)
        -1/120*x(1)*x(2)*x(3)*x(5)
        -1/120*x(1)*x(2)*x(3)*x(4)];
elseif P == 8 % HS 110
    ep = .2*(x(1)*x(2)*x(3)*x(4)*x(5)*x(6)*x(7)*x(8)*x(9)*x(10))^0.2;
    n=10;
    g = zeros(n,1);
    for i=1:n
        g(i) = 2*log(x(i)-2)/(x(i)-2)-2*log(10-x(i))/(10-x(i))-ep/x(i);
    end
elseif P == 9 % HS 206
    g = [-4*x(1)*(x(2)-x(1)^2)-200*(1-x(1))
        2*(x(2)-x(1)^2)];
elseif P == 10 % HS 207
    g = [-4*x(1)*(x(2)-x(1)^2)-2*(1-x(1))
        2*(x(2)-x(1)^2)];
elseif P == 11 % HS 208
    g = [-400*x(1)*(x(2)-x(1)^2)-2*(1-x(1))
        200*(x(2)-x(1)^2)];
elseif P == 12 % HS 209
    g = [-40000*x(1)*(x(2)-x(1)^2)-2*(1-x(1))
        20000*(x(2)-x(1)^2)];
elseif P == 13 % HS 210
    g = [-4000000*x(1)*(x(2)-x(1)^2)-2*(1-x(1))
        2000000*(x(2)-x(1)^2)];
elseif P == 14 % HS 211
    g = [-600*x(1)^2*(x(2)-x(1)^3)-2*(1-x(1))
        200*(x(2)-x(1)^3)];
elseif P == 15 % HS 212
    g = [32*x(1)+32*x(2)+2*(4*x(1)+4*x(2)+(x(1)-x(2))*((x(1)-2)^2+ ...
        x(2)^2-1))*(3+(x(1)-2)^2+x(2)^2+(x(1)-x(2))*(2*x(1)-4))
        32*x(1)+32*x(2)+2*(4*x(1)+4*x(2)+(x(1)-x(2))*((x(1)-2)^2+ ...
        x(2)^2-1))*(5-(x(1)-2)^2-x(2)^2+2*(x(1)-x(2))*x(2))];
elseif P == 16 % HS 213
    g = [4*(10*(x(1)-x(2))^2+(-1+x(1))^2)^3*(22*x(1)-20*x(2)-2)
        4*(10*(x(1)-x(2))^2+(-1+x(1))^2)^3*(-20*x(1)+20*x(2))];
elseif P == 17 % HS 214
    g = [1/4*(22*x(1)-20*x(2)-2)/((10*(x(1)-x(2))^2+(-1+x(1))^2)^(3/4))
        1/4*(-20*x(1)+20*x(2))/((10*(x(1)-x(2))^2+(-1+x(1))^2)^(3/4))];
elseif P == 18 % HS 229
    g = [-400*(x(2)-x(1)^2)*x(1)-2+2*x(1)
        200*x(2)-200*x(1)^2];
elseif P == 19 % HS 247
    if x(1) > 0
        u = 0.5*pi*atan(x(2)/x(1));
    elseif x(1) < 0
        u = 0.5+0.5*pi*atan(x(2)/x(1));
    else
        u = 1e12;
    end
    g = [-1000*(x(3)-10*u)/(pi*x(2)*(1+x(1)^2/ ...
        (x(2)^2)))+200*(sqrt(x(1)^2+x(2)^2)-1) ...
        *x(1)/(sqrt(x(1)^2+x(2)^2))
        1000*(x(3)-10*u)*x(1)/(pi*x(2)^2*(1+x(1)^2/(x(2)^2)))+ ...
        200*(sqrt(x(1)^2+x(2)^2)-1)*x(2)/(sqrt(x(1)^2+x(2)^2))
        202*x(3)-2000*u];
elseif P == 20 % HS 256
    g = [2*x(1)+20*x(2)+40*(x(1)-x(4))^3
        20*x(1)+200*x(2)+4*(x(2)-2*x(3))^3
        10*x(3)-10*x(4)-8*(x(2)-2*x(3))^3
        -10*x(3)+10*x(4)-40*(x(1)-x(4))^3];
elseif P == 21 % HS 257
    g = [400*(x(1)^2-x(2))*x(1)+2*x(1)-21.8+19.8*x(4)
        -200*x(1)^2+220.2*x(2)-20.2
        360*(x(3)^2-x(4))*x(3)+2*x(3)-2
        -180*x(3)^2+200.2*x(4)-40.0+19.8*x(1)];
elseif P == 22 % HS 258
    g = [-400*(-x(1)^2+x(2))*x(1)+2*x(1)-2
        -200*x(1)^2+220.2*x(2)-40.0+19.8*x(4)
        -360*(-x(3)^2+x(4))*x(3)+2*x(3)-2
        -180*x(3)^2+200.2*x(4)-40.0+19.8*x(2)];
elseif P == 23 % HS 259
    g = [-400*(-x(1)^2+x(2))*x(1)+2*x(1)-2
        -200*x(1)^2+220.2*x(2)-40.0+19.8*x(4)
        -360*(-x(3)^2+x(4))*x(3)-3*(1-x(3))^2
        -180*x(3)^2+182*x(4)-21.8+19.8*x(2)];
elseif P == 24 % HS 260
    g = [-400*(x(2)-x(1)^2)*x(1)-2+2*x(1)
        220.2*x(2)-200*x(1)^2-40.0+19.8*x(4)
        -360*(x(4)-x(3)^2)*x(3)-2+2*x(3)
        200.2*x(4)-180*x(3)^2+19.8*x(2)-40.0];
elseif P == 25 % HS 273
    g = [300*x(1)-300+20*(15*(x(1)-1)^2+14*(x(2)-1)^2+13*(x(3)- ...
        1)^2+12*(x(4)-1)^2+11*(x(5)-1)^2+10*(x(6)-1)^2)*(30*x(1)-30)
        280*x(2)-280+20*(15*(x(1)-1)^2+14*(x(2)-1)^2+13*(x(3)-1) ...
        ^2+12*(x(4)-1)^2+11*(x(5)-1)^2+10*(x(6)-1)^2)*(28*x(2)-28)
        260*x(3)-260+20*(15*(x(1)-1)^2+14*(x(2)-1)^2+13*(x(3)-1) ...
        ^2+12*(x(4)-1)^2+11*(x(5)-1)^2+10*(x(6)-1)^2)*(26*x(3)-26)
        240*x(4)-240+20*(15*(x(1)-1)^2+14*(x(2)-1)^2+13*(x(3)-1 ...
        )^2+12*(x(4)-1)^2+11*(x(5)-1)^2+10*(x(6)-1)^2)*(24*x(4)-24)
        220*x(5)-220+20*(15*(x(1)-1)^2+14*(x(2)-1)^2+13*(x(3)-1) ...
        ^2+12*(x(4)-1)^2+11*(x(5)-1)^2+10*(x(6)-1)^2)*(22*x(5)-22)
        200*x(6)-200+20*(15*(x(1)-1)^2+14*(x(2)-1)^2+13*(x(3)-1)^ ...
        2+12*(x(4)-1)^2+11*(x(5)-1)^2+10*(x(6)-1)^2)*(20*x(6)-20)];
end

% MODIFICATION LOG:
%
% 990601  mbk  First version
% 080603  med  Switched to conAssign, cleaned