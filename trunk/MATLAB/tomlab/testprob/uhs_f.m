% function f = uhs_f(x, Prob)
%
% Test functions for Unconstrained optimization. 

% Kenneth Holmstrom, Tomlab Optimization Inc., E-mail: tomlab@tomopt.com.
% Copyright (c) 1999-2008 by Tomlab Optimization Inc. $Release: 6.2.0$
% Written June 1, 1999.   Last modified Jun 3, 2008.

function f = uhs_f(x, Prob)

x=x(:);
P=Prob.P;

if P == 1 % HS 1
      f = 100*(x(2)-x(1)^2)^2+(1-x(1))^2;
elseif P == 2 % HS 2
   f = 100*(x(2)-x(1)^2)^2+(1-x(1))^2;
elseif P == 3 % HS 3
   f = x(2)+1E-5*(x(2)-x(1))^2;
elseif P == 4 % HS 4
   f = (x(1)+1)^3/3+x(2);
elseif P == 5 % HS 5
   f = sin(x(1)+x(2))+(x(1)-x(2))^2-1.5*x(1)+2.5*x(2)+1;
elseif P == 6 % HS 38
   f = 100*(x(2)-x(1)^2)^2+(1-x(1))^2+90*(x(4)-x(3)^2)^2+(1-x(3))^2 ...
       +10.1*((x(2)-1)^2+(x(4)-1)^2)+19.8*(x(2)-1)*(x(4)-1);
elseif P == 7 % HS 45
   f = 2-1/120*x(1)*x(2)*x(3)*x(4)*x(5);
elseif P == 8 % HS 110
   f = sum((log(x-2)).^2.+(log(10-x)).^2)-prod(x)^0.2;
elseif P == 9 % HS 206
   f = (x(2)-x(1)^2)^2+100*(1-x(1))^2;
elseif P == 10 % HS 207
   f = (x(2)-x(1)^2)^2+(1-x(1))^2;
elseif P == 11 % HS 208
   f = 100*(x(2)-x(1)^2)^2+(1-x(1))^2;
elseif P == 12 % HS 209
   f = 10^4*(x(2)-x(1)^2)^2+(1-x(1))^2;
elseif P == 13 % HS 210
   f = 10^6*(x(2)-x(1)^2)^2+(1-x(1))^2;
elseif P == 14 % HS 211
   f = 100*(x(2)-x(1)^3)^2+(1-x(1))^2;
elseif P == 15 % HS 212
   f = (4*(x(1)+x(2))^2)+(4*(x(1)+x(2))+(x(1)-x(2))*((x(1)-2)^2+x(2)^2-1))^2;
elseif P == 16 % HS 213
   f = (10*(x(1)-x(2))^2+(x(1)-1)^2)^4;
elseif P == 17 % HS 214
   f = (10*(x(1)-x(2))^2+(x(1)-1)^2)^(1/4);
elseif P == 18 % HS 229
   f = 100*(x(2)-x(1)^2)^2+(1-x(1))^2;
elseif P == 19 % HS 247
   if x(1) > 0 
      u = 0.5*pi*atan(x(2)/x(1));
   elseif x(1) < 0 
      u = 0.5+0.5*pi*atan(x(2)/x(1));
   else
      u = inf;
   end
   f = 100*((x(3)-10*u)^2+(sqrt(x(1)^2+x(2)^2)-1)^2)+x(3)^2;
elseif P == 20 % HS 256
   f = (x(1)+10*x(2))^2+5*(x(3)-x(4))^2+(x(2)-2*x(3))^4+10*(x(1)-x(4))^4;
elseif P == 21 % HS 257
   f = 100*(x(1)^2-x(2))^2+(x(1)-1)^2+ ...
       90*(x(3)^2-x(4))^2+(x(3)-1)^2+ ...
       10.1*((x(2)-1)^2+(x(4)-1)^2)+ ...
       19.8*(x(1)-1)*(x(4)-1);
elseif P == 22 % HS 258
   f = 100*(x(2)-x(1)^2)^2+(1-x(1))^2+90*(x(4)- ...
       x(3)^2)^2+(1-x(3))^2+10.1*((x(2)-1)^2+(x ...
       (4)-1)^2)+19.8*(x(2)-1)*(x(4)-1);
elseif P == 23 % HS 259
   f = 100*(x(2)-x(1)^2)^2+(1-x(1))^2+90*(x(4)- ...
       x(3)^2)^2+(1-x(3))^3+10.1*(x(2)-1)^2+(x ...
       (4)-1)^2+19.8*(x(2)-1)*(x(4)-1);
elseif P == 24 % HS 260
   f = 100*(x(2)-x(1)^2)^2+(1-x(1))^2+90*(x(4) ...
       -x(3)^2)^2+(1-x(3))^2+9.9*((x(2)-1)+(x( ...
       4)-1))^2+0.2*((x(2)-1)^2+(x(4)-1)^2);
elseif P == 25 % HS 273
   f = 150*(x(1)-1)^2+140*(x(2)-1)^2+130*(x(3)-1)^2+120*(x(4)-1)^2+ ...
       110*(x(5)-1)^2+100*(x(6)-1)^2+10*(15*(x(1)-1)^2+14*(x(2)-1)^ ...
       2+13*(x(3)-1)^2+12*(x(4)-1)^2+11*(x(5)-1)^2+10*(x(6)-1)^2)^2;
end

% MODIFICATION LOG:
%
% 990601  mbk  First version
% 080603  med  Switched to conAssign, cleaned