% chs_g.m
%
% function g=chs_g(x, Prob)
%
% chs_g computes the gradient to objective function f in the point x for the
% test problem P (Prob.P).

% Kenneth Holmstrom, Tomlab Optimization Inc., E-mail: tomlab@tomopt.com.
% Copyright (c) 1999-2008 by Tomlab Optimization Inc. $Release: 6.2.0$
% Written June 1, 1999.   Last modified Jun 6, 2008.

function g=chs_g(x, Prob)

P=Prob.P;

if P < 46
    g = chs_g1(x, P);
elseif P < 91
    g = chs_g2(x, P);
elseif P < 136
    g = chs_g3(x, P);
elseif P < 181
    g = chs_g4(x, P);
end

function g=chs_g1(x, P)

if P==1
    % HS 6
    g = [-2*(1-x(1));0];
elseif P==2
    % HS 7
    g = [2*x(1)/(1+x(1)^2);-1];
elseif P==3
    % HS 8
    g = [0;0];
elseif P==4
    % HS 9
    g = [cos(pi*x(2)/16)*pi/12*cos(pi*x(1)/12)
        -sin(pi*x(1)/12)*pi/16*sin(pi*x(2)/16)];
elseif P==5
    % HS 10
    g = [1;-1];
elseif P==6
    % HS 11
    g = [2*x(1)-10; 2*x(2)];
elseif P==7
    % HS 12
    g = [1.0*x(1)-x(2)-7; 2*x(2)-x(1)-7];
elseif P==8
    % HS 13
    g = [2*x(1)-4; 2*x(2)];
elseif P==9
    % HS 14
    g = [2*x(1)-4;2*x(2)-2];
elseif P==10
    % HS 15
    g = [-400*(x(2)-x(1)^2)*x(1)-2+2*x(1); 200*x(2)-200*x(1)^2];
elseif P==11
    % HS 16
    g = [-400*(x(2)-x(1)^2)*x(1)-2+2*x(1); 200*x(2)-200*x(1)^2];
elseif P==12
    % HS 17
    g = [-400*(x(2)-x(1)^2)*x(1)-2+2*x(1); 200*x(2)-200*x(1)^2];
elseif P==13
    % HS 18
    g = [.02*x(1);2*x(2)];
elseif P==14
    % HS 19
    g = [3*(x(1)-10)^2;3*(x(2)-20)^2];
elseif P==15
    % HS 20
    g = [-400*(x(2)-x(1)^2)*x(1)-2+2*x(1); 200*x(2)-200*x(1)^2];
elseif P==16
    % HS 22
    g = [2*(x(1)-2);2*(x(2)-1)];
elseif P==17
    % HS 23
    g = [2*x(1);2*x(2)];
elseif P==18
    % HS 24
    r = 9*sqrt(3);
    g = [2*(x(1)-3)*x(2)^3/(3*r);x(2)^2*((x(1)-3)^2-9)/r];
elseif P==19
    % HS 26
    g = [2*(x(1)-x(2));-2*(x(1)-x(2))+4*(x(2)-x(3))^3;-4*(x(2)-x(3))^3];
elseif P==20
    % HS 27
    g = [.02*(x(1)-1)-4*x(1)*(x(2)-x(1)^2);2*(x(2)-x(1)^2);0];
elseif P==21
    % HS 29
    g = [-x(2)*x(3);-x(1)*x(3);-x(1)*x(2)];
elseif P==22
    % HS 30
    g = [2*x(1);2*x(2);2*x(3)];
elseif P==23
    % HS 31
    g = [18*x(1);2*x(2);18*x(3)];
elseif P==24
    % HS 32
    g = [2*(x(1)+3*x(2)+x(3))+8*(x(1)-x(2));6*(x(1)+3*x(2)+x(3))-8*(x(1)-x(2));2*(x(1)+3*x(2)+x(3))];
elseif P==25
    % HS 33
    g = [3*x(1)^2-12*x(1)+11;0;1];
elseif P==26
    % HS 34
    g = [-1;0;0];
elseif P==27
    % HS 36
    g = [-x(2)*x(3);-x(1)*x(3);-x(1)*x(2)];
elseif P==28
    % HS 37
    g = [-x(2)*x(3);-x(1)*x(3);-x(1)*x(2)];
elseif P==29
    % HS 39
    g = [-1;0;0;0];
elseif P==30
    % HS 40
    g = [-x(2)*x(3)*x(4);-x(1)*x(3)*x(4);-x(1)*x(2)*x(4);-x(1)*x(2)*x(3)];
elseif P==31
    % HS 41
    g = [-x(2)*x(3);-x(1)*x(3);-x(1)*x(2);0];
elseif P==32
    % HS 42
    g = [2*(x(1)-1);2*(x(2)-2);2*(x(3)-3);2*(x(4)-4)];
elseif P==33
    % HS 43
    g = [2*x(1)-5;2*x(2)-5;4*x(3)-21;2*x(4)+7];
elseif P==34
    % HS 44
    g = [1-x(3)+x(4);-1+x(3)-x(4);-1-x(1)+x(2);x(1)-x(2)];
elseif P==35
    % HS 46
    g = [2*(x(1)-x(2));-2*(x(1)-x(2));2*(x(3)-1);4*(x(4)-1)^3;6*(x(5)-1)^5];
elseif P==36
    % HS 47
    g = [2*(x(1)-x(2));-2*(x(1)-x(2))+3*(x(2)-x(3))^2;-3*(x(2)-x(3))^2+4*(x(3)-x(4))^3;
        -4*(x(3)-x(4))^3+4*(x(4)-x(5))^3;-4*(x(4)-x(5))^3];
elseif P==37
    % HS 54
    Y1=x(1);
    Y2=x(2);
    Y3=x(3);
    Y4=x(4);
    Y5=x(5);
    Y6=x(6);
    g = zeros(6,1);
    TERM = exp(-((Y1^2+Y1*Y2+6.25*Y2^2)/.96+Y3^2/49+4*(Y4^2+Y5^2+Y6^2))*.5)*.5;
    g(1) = TERM*((Y1+Y1+Y2)/.96);
    g(2) = TERM*(Y1+1.25e1*Y2)/.96;
    g(3) = TERM*Y3/24.5;
    g(4) = 8*TERM*Y4;
    g(5) = 8*TERM*Y5;
    g(6) = 8*TERM*Y6;
elseif P==38
    % HS 55
    g = [1+x(4)*exp(x(1)*x(4));2;0;x(1)*exp(x(1)*x(4));4;0];
elseif P==39
    % HS 56
    g = [-x(2)*x(3);-x(1)*x(3);-x(1)*x(2);0;0;0;0];
elseif P==40
    % HS 57
    a=[8 8 10 10 10 10 12 12 12 12 14 14 14 16 16 16 18 18 20 20 20 22 22 22 24 24 24 26 26 26 28 28 30 30 30 32 32 34 36 36 38 38 40 42];
    b=[.49 .49 .48 .47 .48 .47 .46 .46 .45 .43 .45 .43 .43 .44 .43 .43 .46 .45 .42 .42 .43 .41 .41 .40 .42 .40 .40 .41 .40 .41 .41 .40 .40 .40 .38 .41 .40 .40 .41 .38 .40 .40 .39 .39];
    GRADF(1)=0;
    GRADF(2)=0;
    for j=1:1:44
        V=exp(-x(2)*(a(j)-8));
        FIX=2*(b(j)-x(1)-(.49-x(1))*V);
        FI1=-1+V;
        FI2=(.49-x(1))*V*(a(j)-8);
        GRADF(1)=GRADF(1)+FI1*FIX;
        GRADF(2)=GRADF(2)+FI2*FIX;
    end
    g = [GRADF(1);GRADF(2)];

elseif P==41
    % HS 59
    XK = [75.196;3.8112;.0020567;1.0345e-5;6.8306;0.030234;1.28134e-3;2.266e-7;.25645;
        0.0034604;1.3514e-5;28.106;5.2375e-6;6.3e-8;7.e-10;3.405e-4;1.6638e-6;2.8673;3.5256e-5];
    X1=x(1);
    X2=x(2);
    g(1,1) = XK(2)+3*XK(3)*X1^2-4*XK(4)*X1^3-XK(6)*X2+2*XK(7)*X2*X1+4*XK(8)*X1^3*X2+2*XK(13)*X1*X2^2+...
        3*XK(14)*X1^2*X2^2-3*XK(15)*X1^2*X2^3+.0005*X2*XK(18)*exp(.0005*X1*X2)-...
        3*XK(19)*X1^2*X2-XK(16)*X2^2+XK(17)*X2^3-2*.12694D0*X1;
    g(2,1) = XK(5)-XK(6)*X1+XK(7)*X1^2+XK(8)*X1^4-2*XK(9)*X2+3*XK(10)*X2^2-...
        4*XK(11)*X2^3-XK(12)/(X2+1.D0)^2+2*XK(13)*X1^2*X2+...
        2*XK(14)*X1^3*X2-3*XK(15)*X1^3*X2^2+.0005*X1*XK(18)*exp(.0005*X1*X2)-...
        XK(19)*X1^3-2*XK(16)*X1*X2+3*XK(17)*X1*X2^2;

elseif P==42
    % HS 60
    g = [2*(x(1)-1)+2*(x(1)-x(2));-2*(x(1)-x(2))+4*(x(2)-x(3))^3;-4*(x(2)-x(3))^3];
elseif P==43
    % HS 61
    g = [8*x(1)-33;4*x(2)+16;4*x(3)-24];
elseif P==44
    % HS 62
    F3=x(3)+.03;
    F2=F3+x(2);
    F1=F2+x(1);
    G1=F2+.09*x(1);
    G2=F3+.07*x(2);
    G3= .13*x(3)+.03;
    GRAD1 = -8.20437e3*(1/F1-.09/G1);
    GRAD2 = -8.20437e3*(1/F1-1/G1)- 9.00872e3*(1/F2-.07/G2);
    GRAD3 = -8.20437e3*(1/F1-1/G1)- 9.00872e3*(1/F2-1/G2)-9.33046e3*(1/F3-.13/G3);
    g = [GRAD1;GRAD2;GRAD3];
elseif P==45
    % HS 63
    g = [-2*x(1)-x(2)-x(3);-4*x(2)-x(1);-2*x(3)-x(1)];
end

function g=chs_g2(x, P)

if P==46
    % HS 64
    g = [5-50000/x(1)^2;20-72000/x(2)^2;10-144000/x(3)^2];
elseif P==47
    % HS 65
    g = [2*(x(1)-x(2))+2*(x(1)+x(2)-10)/9;-2*(x(1)-x(2))+2*(x(1)+x(2)-10)/9;2*(x(3)-5)];
elseif P==48
    % HS 66
    g = [-0.8 0 0.2]';
elseif P==49
    % HS 67
    jj=0;
    Y2 = 1.6*x(1);
    count = 0;
    while jj==0 & count < 1000
        Y3 = 1.22*Y2-x(1);
        Y6 = (x(2)+Y3)/x(1);
        Y2c = .01*x(1)*(112+13.167*Y6-.6667*Y6^2);
        if(abs(Y2c-Y2)>=0.001)
            Y2 = Y2c;
        else
            jj=1;
        end
        count = count + 1;
    end
    jj=0;
    Y4 = 93;
    count = 0;
    while jj==0 & count < 1000
        Y5 = 86.35+1.098*Y6-.038*Y6^2+.325*(Y4-89);
        Y8 =3*Y5-133;
        Y7 = 35.82-.222*Y8;
        Y4c = 98000*x(3)/(Y2*Y7+1000*x(3));
        if (abs(Y4c-Y4)>=0.001)
            Y4 = Y4c;
        else
            jj=1;
        end
        count = count + 1;
    end

    Z1 = 112+13.167*Y6-.6667*Y6^2;
    Z2 = Y2*Y7+1000*x(3);
    GRADY = zeros(8,3);
    GRADY(2,1) = .01*Z1*x(1)*(13.167*GRADY(6,1)-2*.6667*GRADY(6,1)*Y6);
    GRADY(2,2) = 13.167*GRADY(6,2)-2*.6667*GRADY(6,2)*Y6;
    GRADY(3,1) = 1.22*GRADY(2,1)-1;
    GRADY(3,2) = 1.22*GRADY(2,2);
    GRADY(4,1) = -98000*x(3)/(Z2)^2*(GRADY(2,1)*Y7+Y2*GRADY(7,1));
    GRADY(4,2) = -98000*x(3)/(Z2)^2*(GRADY(2,2)*Y7+Y2*GRADY(7,2));
    GRADY(4,3) = 98000/(Z2)^2*(Z2-x(3)*(GRADY(2,2)*Y7+Y2*GRADY(7,2)));
    GRADY(5,1) = GRADY(6,1)*(1.098-2*.038*Y6)+.325*GRADY(4,1);
    GRADY(5,2) = GRADY(6,2)*(1.098-2*.038*Y6)+.325*GRADY(4,2);
    GRADY(5,3) = GRADY(6,3)*(1.098-2*.038*Y6)+.325*GRADY(4,3);
    GRADY(6,1) = (GRADY(3,1)*x(1)-(x(2)+Y3))/x(1)^2;
    GRADY(6,2) = (1+GRADY(3,2))/x(1);
    GRADY(8,1) = 3*GRADY(5,1);
    GRADY(5,1) = GRADY(6,1)*(1.098-2*.038*Y6)+.325*GRADY(4,1);
    GRADY(5,2) = GRADY(6,2)*(1.098-2*.038*Y6)+.325*GRADY(4,2);
    GRADY(5,3) = GRADY(6,3)*(1.098-2*.038*Y6)+.325*GRADY(4,3);
    GRADY(8,2) = 3*GRADY(5,2);
    GRADY(8,3) = 3*GRADY(5,3);
    GRADY(7,1) = -.228*GRADY(8,1);
    GRADY(7,2) = -.228*GRADY(8,2);
    GRADY(7,3) = -.228*GRADY(8,3);
    A = [0;0;85;90;3;.01;145;5000;2000;93;95;12;4;162];
    GRADF = zeros(3,1);
    for j=1:3
        GRADF(j) = A(j)+3.36*GRADY(3,j)-.063*(Y2*GRADY(5,j)+GRADY(2,j)*Y5);
    end
    g = [GRADF(1);GRADF(2);GRADF(3)];
elseif P==50
    % HS 70
    X1 = x(1);
    X2 = x(2);
    X3 = x(3);
    X4 = x(4);
    yi_obs = [.00189 .1038 .268 .506 .577 .604 .725 .898 .947 .845 .702 .528 .385 .257 .159 .0869 .0453 .01509 .00189];
    C = zeros(19,1);
    CL = zeros(19,1);
    D = zeros(19,1);
    Y = zeros(19,1);
    C(1) = .1/7.658;
    CL(1) = log(C(1));
    H = 12/sqrt(6.2832);
    D(1) = H/C(1);
    Y(1) = yi_obs(1);
    for I=2:19
        C(I) = (I-1)/7.658;
        CL(I) = log(C(I));
        D(I) = H/C(I);
        Y(I) = yi_obs(I);
    end
    GRADF = zeros(4,1);
    for i=1:4
        GRADF(i) = 0;
    end

    b = x(3)+(1-x(3))*x(4);
    W1 = sqrt(abs(X1));
    W2 = sqrt(abs(X2));
    b_inv = 1/b;
    BETX4 = b/X4;
    DLX4 = log(X4);
    DLb = log(b);
    F11 = W1*(1-X3)/(1+12*X1)^2;
    F12 = X1*(1+12*X1);
    F13 = 1.5+6*X1;
    F21 = W2*X3/(1+12*X2)^2;
    F22 = X2*(1+12*X2);
    F23 = 1.5+6*X2;
    F31 = W1*X1/(1+12*X1);
    FAC2 = F31*(1-X3);
    F32 = X1*(1-X3)*(1-X4);
    F33 = W2*X2/(1+12*X2);
    FAC1 = F33*X3;
    F34 = X3*X2*(1-X4);
    F41 = F33*X2*X3*(1-X3);
    F42 = F31*X1*X3*(1-X3);
    for i=1:19
        E1 = 0;
        CL1 = 1-C(i)*b+DLb+CL(i);
        if(X2*CL1>=-170)
            E1 = exp(CL1*X2);
        end
        E2 = 0;
        CL2 = 1-C(i)*BETX4+DLb-DLX4+CL(i);
        if(X1*CL2>=-170)
            E2 = exp(CL2*X1);
        end
        YIC = D(i)*(FAC1*E1+FAC2*E2);
        YIC = 2*(YIC-Y(i));
        GRADF(1) = GRADF(1)+YIC*D(i)*E2*F11*(CL2*F12+F13);
        GRADF(2) = GRADF(2)+YIC*D(i)*E1*F21*(CL1*F22+F23);
        H1 = b_inv-C(i);
        H2 = b_inv-C(i)/X4;
        H3 = H2/X4;
        GRADF(3) = GRADF(3)+YIC*D(i)*(E1*F33*(1+F34*H1)+E2*F31*(-1+F32*H2));
        GRADF(4) = GRADF(4)+YIC*D(i)*(F41*E1*H1-F42*E2*H3);
    end
    g = GRADF';
elseif P==51
    % HS 71
    g = [x(4)*(x(1)+x(2)+x(3))+x(1)*x(4);x(1)*x(4);x(1)*x(4)+1;x(1)*(x(1)+x(2)+x(3))];
elseif P==52
    % HS 72
    g = [1;1;1;1];
elseif P==53
    % HS 73
    g = [24.55;26.75;39;40.50];
elseif P==54
    % HS 74
    g = [3+1e-6*3*x(1)^2;2+2e-6*x(2)^2;0;0];
elseif P==55
    % HS 75
    g = [3+1e-6*3*x(1)^2;2+2e-6*x(2)^2;0;0];
elseif P==56
    % HS 77
    g = [2*(x(1)-1)+2*(x(1)-x(2));-2*(x(1)-x(2));2*(x(3)-1);4*(x(4)-1)^3;6*(x(5)-1)^5];
elseif P==57
    % HS 78
    g = [x(2)*x(3)*x(4)*x(5);x(1)*x(3)*x(4)*x(5);x(1)*x(2)*x(4)*x(5);x(1)*x(2)*x(3)*x(5);x(1)*x(2)*x(3)*x(4)];
elseif P==58
    % HS 79
    g = [2*(x(1)-1)+2*(x(1)-x(2));
        -2*(x(1)-x(2))+2*(x(2)-x(3));
        -2*(x(2)-x(3))+4*(x(3)-x(4))^3;
        -4*(x(3)-x(4))^3+4*(x(4)-x(5))^3;
        -4*(x(4)-x(5))^3];
elseif P==59
    % HS 80
    f=exp(x(1)*x(2)*x(3)*x(4)*x(5));
    g = [x(2)*x(3)*x(4)*x(5)*f;
        x(1)*x(3)*x(4)*x(5)*f;
        x(1)*x(2)*x(4)*x(5)*f;
        x(1)*x(2)*x(3)*x(5)*f;
        x(1)*x(2)*x(3)*x(4)*f];
elseif P==60
    % HS 81
    f=exp(x(1)*x(2)*x(3)*x(4)*x(5));
    g = [x(2)*x(3)*x(4)*x(5)*f-.5*6*x(1)^2*(x(1)^3+x(2)^3+1);
        x(1)*x(3)*x(4)*x(5)*f-.5*6*x(2)^2*(x(1)^3+x(2)^3+1);
        x(1)*x(2)*x(4)*x(5)*f;
        x(1)*x(2)*x(3)*x(5)*f;
        x(1)*x(2)*x(3)*x(4)*f];
elseif P==61
    % HS 83
    g = [37.293239+.8356891*x(5);0;2*5.3578547*x(3);0;.8356891*x(1)];
elseif P==62
    % HS 84
    g = [8720288.849-150512.5253*x(2)+156.6950325*x(3)-476470.3222*x(4)-729482.8271*x(5);
        -150512.5253*x(1);+156.6950325*x(1);-476470.3222*x(1);-729482.8271*x(1)];
elseif P==63
    % HS 86
    c=[30  -20  -10   32  -10;
        -20   39   -6  -31   32;
        -10   -6   10   -6  -10;
        32  -31   -6   39  -20;
        -10   32  -10  -20   30];
    e=[-15 -27 -36 -18 -12];
    d=[4 8 10 6 2];
    g = zeros(5,1);
    for i=1:5
        s = 0;
        for  j=1:5
            s = s + c(i,j)*x(j);
        end
        g(i) = 2*s + e(i) + 3*d(i)*x(i)^2;
    end
elseif P==64
    % HS 87
    if(0<=x(1)<300)
        if(0<=x(2)<100)
            g = [30;28;0;0;0;0];
        elseif(100<=x(2)<200)
            g = [30;29;0;0;0;0];
        elseif(200<=x(2)<=1000)
            g = [30;30;0;0;0;0];
        end
    elseif(300<=x(1)<=400)
        if(0<=x(2)<100)
            g = [31;28;0;0;0;0];
        elseif(100<=x(2)<200)
            g = [31;29;0;0;0;0];
        elseif(200<=x(2)<=1000)
            g = [31;30;0;0;0;0];
        end
    end
elseif P==65
    % HS 93
    g = zeros(6,1);
    g(1) = 0.0204*x(1)*x(4) + 0.0204*x(4)*(x(1)+x(2)+x(3)) + 0.0187*x(2)*x(3) +...
        0.0607*x(1)*x(4)*x(5)^2 + 0.0607*x(4)*x(5)^2*(x(1)+x(2)+x(3)) + 0.0437*x(2)*x(3)*x(6)^2;
    g(2) = 0.0204*x(1)*x(4)+0.0187*x(3)*(x(1)+1.57*x(2)+x(4))+0.029359*x(2)*x(3)+...
        0.0607*x(1)*x(4)*x(5)^2+0.0437*x(3)*x(6)^2*(x(1)+1.57*x(2)+x(4))+0.068609*x(2)*x(3)*x(6)^2;
    g(3) = 0.0204*x(1)*x(4)+0.0187*x(2)*(x(1)+1.57*x(2)+x(4))+0.0607*x(1)*x(4)*x(5)^2+...
        0.0437*x(2)*x(6)^2*(x(1)+1.57*x(2)+x(4));
    g(4) = 0.0204*x(1)*(x(1)+x(2)+x(3))+0.0187*x(2)*x(3)+0.0607*x(1)*x(5)^2*(x(1)+x(2)+x(3))+0.0437*x(2)*x(3)*x(6)^2 ;
    g(5) = 0.1214*x(1)*x(4)*x(5)*(x(1)+x(2)+x(3));
    g(6) = 0.0874*x(2)*x(3)*x(6)*(x(1)+1.57*x(2)+x(4));
elseif P==66
    %HS 95
    g=[4.3;31.8;63.3;15.8;68.5;4.7];
elseif P==67
    %HS 96
    g=[4.3;31.8;63.3;15.8;68.5;4.7];
elseif P==68
    %HS 97
    g=[4.3;31.8;63.3;15.8;68.5;4.7];
elseif P==69
    %HS 98
    g=[4.3;31.8;63.3;15.8;68.5;4.7];
elseif P==70
    %HS 99
    a(1)=0;
    a(2)=50;
    a(3)=50;
    a(4)=75;
    a(5)=75;
    a(6)=75;
    a(7)=100;
    a(8)=100;
    t(1)=0;
    t(2)=25;
    t(3)=50;
    t(4)=100;
    t(5)=150;
    t(6)=200;
    t(7)=290;
    t(8)=380;
    r = zeros(8,1);
    g = zeros(7,1);
    grad = zeros(7,1);
    for i=2:8
        r(i)=a(i)*(t(i)-t(i-1))*cos(x(i-1))+r(i-1);
        grad(i-1)=-a(i)*(t(i)-t(i-1))*sin(x(i-1));
    end
    for i=2:7
        g(i)=-2*r(8)*grad(i);
    end
    g(1) = -(1250^2*2*cos(x(1))*(-sin(x(1))) - 2*1250*sin(x(1))*(9000*cos(x(7))+9000*cos(x(6))+3750*cos(x(5))+3750*cos(x(4))+3750*cos(x(3))+1250*cos(x(2))));
elseif P==71
    %HS 100
    g = [2*x(1)-20;10*x(2)-120;4*x(3)^3;6*x(4)-66;60*x(5)^5;-10+14*x(6)-...
        4*x(7);4*x(7)^3-4*x(6)-8];
elseif P==72
    % HS 101
    g= [10*x(4)^2/(x(2)*x(6)^3*x(7)^.25)-15*x(3)*x(4)/(x(1)^2*x(2)^2*x(5)*x(7)^.5)-...
        40*x(2)*x(6)/(x(1)^3*x(4)*x(5)^2)+50*x(1)*x(2)^2*x(5)^.5*x(7)/(x(3)*x(6)^2);
        -10*x(1)*x(4)^2/(x(2)^2*x(6)^3*x(7)^.25)-30*x(3)*x(4)/(x(1)*x(2)^3*x(5)*x(7)^.5)+...
        20*x(6)/(x(1)^2*x(4)*x(5)^2)+50*x(1)^2*x(2)*x(5)^.5*x(7)/(x(3)*x(6)^2);
        15*x(4)/(x(1)*x(2)^2*x(5)*x(7)^.5)-25*x(1)^2*x(2)^2*x(5)^.5*x(7)/(x(3)^2*x(6)^2);
        20*x(1)*x(4)/(x(2)*x(6)^3*x(7)^.25)+15*x(3)/(x(1)*x(2)^2*x(5)*x(7)^.5)-...
        20*x(2)*x(6)/(x(1)^2*x(4)^2*x(5)^2);
        -15*x(3)*x(4)/(x(1)*x(2)^2*x(5)^2*x(7)^.5)-40*x(2)*x(6)/(x(1)^2*x(4)*x(5)^3)+...
        12.5*x(1)^2*x(2)^2*x(7)/(x(3)*x(5)^.5*x(6)^2);
        -30*x(1)*x(4)^2/(x(2)*x(6)^4*x(7)^.25)+20*x(2)/(x(1)^2*x(4)*x(5)^2)-...
        50*x(1)^2*x(2)^2*x(5)^.5*x(7)/(x(3)*x(6)^3);
        -2.50*x(1)*x(4)^2/(x(2)*x(6)^3*x(7)^1.25)-7.5*x(3)*x(4)/(x(1)*x(2)^2*x(5)*x(7)^1.5)+...
        25*x(1)^2*x(2)^2*x(5)^.5/(x(3)*x(6)^2)];
elseif P==73
    % HS 102
    g=[10*x(4)^2*x(7)^.125/(x(2)*x(6)^3)-15*x(3)*x(4)/(x(1)^2*x(2)^2*x(5)*x(7)^.5)-...
        40*x(2)*x(6)/(x(1)^3*x(4)*x(5)^2)+50*x(1)*x(2)^2*x(5)^.5*x(7)/(x(3)*x(6)^2);
        -10*x(1)*x(4)^2*x(7)^.125/(x(2)^2*x(6)^3)-30*x(3)*x(4)/(x(1)*x(2)^3*x(5)*x(7)^.5)+...
        20*x(6)/(x(1)^2*x(4)*x(5)^2)+50*x(1)^2*x(2)*x(5)^.5*x(7)/(x(3)*x(6)^2);
        15*x(4)/(x(1)*x(2)^2*x(5)*x(7)^.5)-25*x(1)^2*x(2)^2*x(5)^.5*x(7)/(x(3)^2*x(6)^2);
        20*x(1)*x(4)*x(7)^.125/(x(2)*x(6)^3)+15*x(3)/(x(1)*x(2)^2*x(5)*x(7)^.5)-...
        20*x(2)*x(6)/(x(1)^2*x(4)^2*x(5)^2);
        -15*x(3)*x(4)/(x(1)*x(2)^2*x(5)^2*x(7)^.5)-40*x(2)*x(6)/(x(1)^2*x(4)*x(5)^3)+...
        12.5*x(1)^2*x(2)^2*x(7)/(x(3)*x(5)^.5*x(6)^2);
        -30*x(1)*x(4)^2*x(7)^.125/(x(2)*x(6)^4)+20*x(2)/(x(1)^2*x(4)*x(5)^2)-...
        50*x(1)^2*x(2)^2*x(5)^.5*x(7)/(x(3)*x(6)^3);
        1.250*x(1)*x(4)^2/(x(2)*x(6)^3*x(7)^.875)-7.5*x(3)*x(4)/(x(1)*x(2)^2*x(5)*x(7)^1.5)+...
        25*x(1)^2*x(2)^2*x(5)^.5/(x(3)*x(6)^2)];
elseif P==74
    % HS 103
    g=[10*x(4)^2*x(7)^.5/(x(2)*x(6)^3)-15*x(3)*x(4)/(x(1)^2*x(2)^2*x(5)*x(7)^.5)-...
        40*x(2)*x(6)/(x(1)^3*x(4)*x(5)^2)+50*x(1)*x(2)^2*x(5)^.5*x(7)/(x(3)*x(6)^2);
        -10*x(1)*x(4)^2*x(7)^.5/(x(2)^2*x(6)^3)-30*x(3)*x(4)/(x(1)*x(2)^3*x(5)*x(7)^.5)+...
        20*x(6)/(x(1)^2*x(4)*x(5)^2)+50*x(1)^2*x(2)*x(5)^.5*x(7)/(x(3)*x(6)^2);
        15*x(4)/(x(1)*x(2)^2*x(5)*x(7)^.5)-25*x(1)^2*x(2)^2*x(5)^.5*x(7)/(x(3)^2*x(6)^2);
        20*x(1)*x(4)*x(7)^.5/(x(2)*x(6)^3)+15*x(3)/(x(1)*x(2)^2*x(5)*x(7)^.5)-...
        20*x(2)*x(6)/(x(1)^2*x(4)^2*x(5)^2);
        -15*x(3)*x(4)/(x(1)*x(2)^2*x(5)^2*x(7)^.5)-40*x(2)*x(6)/(x(1)^2*x(4)*x(5)^3)+...
        12.5*x(1)^2*x(2)^2*x(7)/(x(3)*x(5)^.5*x(6)^2);
        -30*x(1)*x(4)^2*x(7)^.5/(x(2)*x(6)^4)+20*x(2)/(x(1)^2*x(4)*x(5)^2)-...
        50*x(1)^2*x(2)^2*x(5)^.5*x(7)/(x(3)*x(6)^3);
        5.0*x(1)*x(4)^2/(x(2)*x(6)^3*x(7)^.5)-7.5*x(3)*x(4)/(x(1)*x(2)^2*x(5)*x(7)^1.5)+...
        25*x(1)^2*x(2)^2*x(5)^.5/(x(3)*x(6)^2)];
elseif P==75
    % HS 104
    g = [0.268*1/(x(1)^0.33*x(7)^0.67)-1;0.268*1/(x(2)^0.33*x(8)^0.67)-1;0;0;0;0;-0.268*x(1)^0.67/(x(7)^1.67);-0.268*x(2)^0.67/(x(8)^1.67)];
elseif P==76
    % HS 106
    g = [1;1;1;0;0;0;0;0];
elseif P==77
    % HS 107
    g = [3000+1000*3*x(1)^2;2000+666.667*3*x(2)^2;0;0;0;0;0;0;0];
elseif P==78
    % HS 108
    g = [-0.5*x(4); 0.5*x(3); 0.5*x(2)-0.5*x(9); -0.5*x(1); 0.5*x(9)-0.5*x(8); 0.5*x(7); 0.5*x(6); -0.5*x(5); -0.5*x(3)+0.5*x(5)];
elseif P==79
    % HS 109
    g = [3+0.3e-5*x(1)^2; 2+0.1566222e-5*x(2)^2; 0; 0; 0; 0; 0; 0; 0];
elseif P==80
    % HS 111 %Equal to 378
    A = [-6.089;-17.164;-34.054;-5.914;-24.721;-14.986;-24.100;-10.708;-26.662;-22.179];
    g = zeros(10,1);
    exp_sum = 0;
    for j=1:10
        exp_sum = exp_sum + exp(x(j));
    end
    for i=1:10
        g(i) = exp(x(i))*((A(i)+x(i)-log(exp_sum)));
    end
elseif P==81
    % HS 112
    A = [-6.08;-17.164;-34.054;-5.914;-24.721;-14.986;-24.100;-10.708;-26.662;-22.179];
    g = zeros(10,1);
    x_sum = 0;
    for j=1:10
        x_sum = x_sum + x(j);
    end
    for i=1:10
        g(i) = (A(i)+log(x(i)/x_sum));
    end
elseif P==82
    % HS 113
    g = [2*x(1)+x(2)-14;2*x(2)+x(1)-16;2*x(3)-20;8*x(4)-40;2*x(5)-6;4*x(6)-4;10*x(7);14*x(8)-154;4*x(9)-40;2*x(10)-14];
elseif P==83
    % HS 114
    g = [5.04;0.035;10;-0.063*x(7);3.36;0;-0.063*x(4);0;0;0];
elseif P==84
    %HS 116
    g= [0;0;0;0;0;0;0;0;0;0;1;1;1];
elseif P==85
    %HS 117
    c = [30  -20  -10   32  -10;
        -20   39   -6  -31   32;
        -10   -6   10   -6  -10;
        32  -31   -6   39  -20;
        -10   32  -10  -20   30];
    b = [-40 -2  -0.25 -4  -4  -1  -40  -60  5  1];
    d = [4   8   10   6  2];
    g1=zeros(15,1);
    g2=zeros(15,1);
    for i = 1:15
        if i > 5
            g1(i-5) = -b(i-5);
        else
            g2(10+i) = 6*d(i)*x(10+i)^2;
            s = 0;
            for   j = 1:5
                s = s+c(i,j)*x(10+j);
            end
            g2(10+i) = (g2(10+i)+2*s);
        end
    end
    g = g1+g2;
elseif P==86
    %HS 119
    a=[1 0 0 1 0 0 1 1 0 0 0 0 0 0 0 1;
        0 1 1 0 0 0 1 0 0 1 0 0 0 0 0 0;
        0 0 1 0 0 0 1 0 1 1 0 0 0 1 0 0;
        0 0 0 1 0 0 1 0 0 0 1 0 0 0 1 0;
        0 0 0 0 1 1 0 0 0 1 0 1 0 0 0 1;
        0 0 0 0 0 1 0 1 0 0 0 0 0 0 1 0;
        0 0 0 0 0 0 1 0 0 0 1 0 1 0 0 0;
        0 0 0 0 0 0 0 1 0 1 0 0 0 0 1 0;
        0 0 0 0 0 0 0 0 1 0 0 1 0 0 0 1;
        0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 0;
        0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0;
        0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0;
        0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0;
        0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0;
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0;
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1];
    g = zeros(16,1);
    for i=1:16
        s1=0;
        s2=0;
        for j=1:16
            s1=s1+a(j,i)*(x(j)^2+x(j)+1);
            s2=s2+a(i,j)*(x(j)^2+x(j)+1);
        end
        g(i)=(s1+s2)*(x(i)+x(i)+1);
    end
elseif P==87
    % HS 215
    g=[0;1];
elseif P==88
    % HS 216
    g=[400*(x(1)^2-x(2))*x(1)+2*x(1)-2;
        -200*x(1)^2+200*x(2)];
elseif P==89
    % HS 217
    g=[0;-1];
elseif P==90
    % HS 218
    g=[0;1];
end

function g=chs_g3(x, P)

if P==91
    % HS 219
    g=[-1;0;0;0];
elseif P==92
    % HS 220
    g=[1;0];
elseif P==93
    % HS 221
    g=[-1;0];
elseif P==94
    % HS 222
    g=[-1;0];
elseif P==95
    % HS 223
    g=[-1;0];
elseif P==96
    % HS 225
    g=[2*x(1);2*x(2)];
elseif P==97
    % HS 226
    g=[-x(2);-x(1)];
elseif P==98
    % HS 227
    g=[2*(x(1)-2);2*(x(2)-1)];
elseif P==99
    % HS 228
    g=[2*x(1);1];
elseif P==100
    % HS 230
    g=[0;1];
elseif P==101
    % HS 231
    g=[-400*(x(2)-x(1)^2)*x(1)-2+2*x(1);200*x(2)-200*x(1)^2];
elseif P==102
    % HS 232
    g=[-1/81*(-2*x(1)+6)*x(2)^3*sqrt(3);-1/27*(9-(x(1)-3)^2)*x(2)^2*sqrt(3)];
elseif P==103
    % HS 233
    g=[-400*(x(2)-x(1)^2)*x(1)-2+2*x(1);200*x(2)-200*x(1)^2];
elseif P==104
    % HS 234
    g=[-4*(x(2)-x(1))^3+1;4*(x(2)-x(1))^3];
elseif P==105
    %HS 235
    g=[-0.2e-1+0.2e-1*x(1)-4*(x(2)-x(1)^2)*x(1); 2*x(2)-2*x(1)^2;0];
elseif P==106
    % HS 236
    X1 = x(1);
    X2 = x(2);
    B =[75.1963666677;-3.8112755343;.1269366345;-.0020567665;.0000103450;-6.8306567613;...
        3.02344793e-2;-1.2813448e-3;3.52559e-5;-2.266e-7;0.2564581253;-3.460403e-3;...
        1.35139D-5;-28.1064434908;-5.2375e-6;-6.3e-9;7.e-10;3.405462e-4;-1.6638e-6;-2.8673112392];
    GF(1)=B(2)+B(3)*2*X1+B(4)*3*X1^2+...
        B(5)*4*X1^3+B(7)*X2+B(8)*2*X1*X2+...
        B(9)*3*X1^2*X2+B(10)*4*X1^3*X2+...
        B(15)*2*X1*X2^2+B(16)*3*X1^2*X2^2+...
        B(17)*3*X1^2*X2^3+B(18)*X2^2+B(19)*X2^3+...
        B(20)*(exp(5e-4*X1*X2))*(5e-4*X2);
    GF(1)=-GF(1);
    GF(2)=B(6)+B(7)*X1+B(8)*X1^2+B(9)*X1^3+...
        B(10)*X1^4+B(11)*2*X2+B(12)*3*X2^2+...
        B(13)*4*X2^3+B(14)*(-1/(X2+1)^2)+...
        B(15)*X1^2*2*X2+B(16)*X1^3*2*X2+...
        B(17)*X1^3*3*X2^2+B(18)*X1*2*X2+...
        B(19)*X1*3*X2^2+...
        B(20)*(exp(5e-4*X1*X2))*(5e-4*X1);
    GF(2)=-GF(2);
    g = [GF(1);GF(2)];
elseif P==107
    % HS 237
    X1 = x(1);
    X2 = x(2);
    B =[75.1963666677;-3.8112755343;.1269366345;-.0020567665;.0000103450;-6.8306567613;...
        3.02344793e-2;-1.2813448e-3;3.52559e-5;-2.266e-7;0.2564581253;-3.460403e-3;...
        1.35139D-5;-28.1064434908;-5.2375e-6;-6.3e-9;7.e-10;3.405462e-4;-1.6638e-6;-2.8673112392];
    GF(1)=B(2)+B(3)*2*X1+B(4)*3*X1^2+...
        B(5)*4*X1^3+B(7)*X2+B(8)*2*X1*X2+...
        B(9)*3*X1^2*X2+B(10)*4*X1^3*X2+...
        B(15)*2*X1*X2^2+B(16)*3*X1^2*X2^2+...
        B(17)*3*X1^2*X2^3+B(18)*X2^2+B(19)*X2^3+...
        B(20)*(exp(5e-4*X1*X2))*(5e-4*X2);
    GF(1)=-GF(1);
    GF(2)=B(6)+B(7)*X1+B(8)*X1^2+B(9)*X1^3+...
        B(10)*X1^4+B(11)*2*X2+B(12)*3*X2^2+...
        B(13)*4*X2^3+B(14)*(-1/(X2+1)^2)+...
        B(15)*X1^2*2*X2+B(16)*X1^3*2*X2+...
        B(17)*X1^3*3*X2^2+B(18)*X1*2*X2+...
        B(19)*X1*3*X2^2+...
        B(20)*(exp(5e-4*X1*X2))*(5e-4*X1);
    GF(2)=-GF(2);
    g = [GF(1);GF(2)];
elseif P==108
    % HS 238
    X1 = x(1);
    X2 = x(2);
    B =[75.1963666677;-3.8112755343;.1269366345;-.0020567665;.0000103450;-6.8306567613;...
        3.02344793e-2;-1.2813448e-3;3.52559e-5;-2.266e-7;0.2564581253;-3.460403e-3;...
        1.35139D-5;-28.1064434908;-5.2375e-6;-6.3e-9;7.e-10;3.405462e-4;-1.6638e-6;-2.8673112392];

    GF(1)=B(2)+B(3)*2*X1+B(4)*3*X1^2+...
        B(5)*4*X1^3+B(7)*X2+B(8)*2*X1*X2+...
        B(9)*3*X1^2*X2+B(10)*4*X1^3*X2+...
        B(15)*2*X1*X2^2+B(16)*3*X1^2*X2^2+...
        B(17)*3*X1^2*X2^3+B(18)*X2^2+B(19)*X2^3+...
        B(20)*(exp(5e-4*X1*X2))*(5e-4*X2);
    GF(1)=-GF(1);
    GF(2)=B(6)+B(7)*X1+B(8)*X1^2+B(9)*X1^3+...
        B(10)*X1^4+B(11)*2*X2+B(12)*3*X2^2+...
        B(13)*4*X2^3+B(14)*(-1/(X2+1)^2)+...
        B(15)*X1^2*2*X2+B(16)*X1^3*2*X2+...
        B(17)*X1^3*3*X2^2+B(18)*X1*2*X2+...
        B(19)*X1*3*X2^2+...
        B(20)*(exp(5e-4*X1*X2))*(5e-4*X1);
    GF(2)=-GF(2);
    g = [GF(1);GF(2)];
elseif P==109
    % HS 239
    X1 = x(1);
    X2 = x(2);
    B =[75.1963666677;-3.8112755343;.1269366345;-.0020567665;.0000103450;-6.8306567613;...
        3.02344793e-2;-1.2813448e-3;3.52559e-5;-2.266e-7;0.2564581253;-3.460403e-3;...
        1.35139D-5;-28.1064434908;-5.2375e-6;-6.3e-9;7.e-10;3.405462e-4;-1.6638e-6;-2.8673112392];
    GF(1)=B(2)+B(3)*2*X1+B(4)*3*X1^2+...
        B(5)*4*X1^3+B(7)*X2+B(8)*2*X1*X2+...
        B(9)*3*X1^2*X2+B(10)*4*X1^3*X2+...
        B(15)*2*X1*X2^2+B(16)*3*X1^2*X2^2+...
        B(17)*3*X1^2*X2^3+B(18)*X2^2+B(19)*X2^3+...
        B(20)*(exp(5e-4*X1*X2))*(5e-4*X2);
    GF(1)=-GF(1);
    GF(2)=B(6)+B(7)*X1+B(8)*X1^2+B(9)*X1^3+...
        B(10)*X1^4+B(11)*2*X2+B(12)*3*X2^2+...
        B(13)*4*X2^3+B(14)*(-1/(X2+1)^2)+...
        B(15)*X1^2*2*X2+B(16)*X1^3*2*X2+...
        B(17)*X1^3*3*X2^2+B(18)*X1*2*X2+...
        B(19)*X1*3*X2^2+...
        B(20)*(exp(5e-4*X1*X2))*(5e-4*X1);
    GF(2)=-GF(2);
    g = [GF(1);GF(2)];
elseif P==110
    % HS 248
    g = [0;-1;0];
elseif P==111
    % HS 249
    g = [2*x(1);2*x(2);2*x(3)];
elseif P==112
    % HS 250
    g = [-x(2)*x(3);-x(1)*x(3);-x(1)*x(2)];
elseif P==113
    % HS 251
    g = [-x(2)*x(3);-x(1)*x(3);-x(1)*x(2)];
elseif P==114
    % HS 252
    g = [.02*(x(1)-1)-4*x(1)*(x(2)-x(1)^2);2*(x(2)-x(1)^2);0];
elseif P==115
    % HS 253
    a = [0 10 10 0 0 10 10 0 ;0 0 10 10 0 0 10 10;0 0 0 0 10 10 10 10];
    grad1 = 0;
    grad2 = 0;
    grad3 = 0;
    for j=1:8
        Q = sqrt((a(1,j)-x(1))^2+(a(2,j)-x(2))^2+(a(3,j)-x(3))^2);
        g1_j = -(a(1,j)-x(1))/Q;
        g2_j = -(a(2,j)-x(2))/Q;
        g3_j = -(a(3,j)-x(3))/Q;
        grad1 = grad1 + g1_j;
        grad2 = grad2 + g2_j;
        grad3 = grad3 + g3_j;
    end
    g = [grad1;grad2;grad3];
elseif P==116
    % HS 254
    g = [0;-1;1/x(3)];
elseif P==117
    % HS 263
    g = [-1;0;0;0];
elseif P==118
    % HS 264
    g = [2*x(1)-5;2*x(2)-5;4*x(3)-21;2*x(4)+7];
elseif P==119
    % HS 265
    g = zeros(4,1);
    for i=1:2
        g(i) = 10*exp(-x(i+2))*exp(-10*x(i)*exp(-x(i+2)));
        g(i+2) = -10*x(i)*exp(-x(i+2))*exp(-10*x(i)*exp(-x(i+2)));
    end
elseif P==120
    % HS 270
    x1 = x(1);
    x2 = x(2);
    x3 = x(3);
    x4 = x(4);
    x5 = x(5);
    g = [x2*x3*x4-3*x2*x4-4*x2*x3+12*x2-2*x3*x4+6*x4+8*x3-24;
        x1*x3*x4-3*x1*x4-4*x1*x3+12*x1-x3*x4+3*x4+4*x3-12;
        x1*x2*x4-4*x1*x2-x2*x4+4*x2-2*x1*x4+8*x1+2*x4-8;
        x1*x2*x3-3*x1*x2-x2*x3+3*x2-2*x1*x3+6*x1+2*x3-6;
        1.5*4*x5^3-5.75*3*x5^2+5.25*2*x5];
elseif P==121
    % HS 284
    c = [20;40;400;20;80;20;40;140;380;280;80;40;140;40;120];
    g = -c;
elseif P==122
    % HS 285
    c = [486;640;758;776;477;707;175;619;627;614;475;377;524;468;529];
    g = -c;
elseif P==123
    % HS 315
    g = [0;-1];
elseif P==124
    % HS 316
    g = [2*(x(1)-20);2*(x(2)+20)];
elseif P==125
    % HS 317
    g = [2*(x(1)-20);2*(x(2)+20)];
elseif P==126
    % HS 318
    g = [2*(x(1)-20);2*(x(2)+20)];
elseif P==127
    % HS 319
    g = [2*(x(1)-20);2*(x(2)+20)];
elseif P==128
    % HS 320
    g = [2*(x(1)-20);2*(x(2)+20)];
elseif P==129
    % HS 321
    g = [2*(x(1)-20);2*(x(2)+20)];
elseif P==130
    % HS 322
    g = [2*(x(1)-20);2*(x(2)+20)];
elseif P==131
    % HS 323
    g = [2*x(1)-4;2*x(2)];
elseif P==132
    % HS 324
    g = [.02*x(1);2*x(2)];
elseif P==133
    % HS 325
    g = [2*x(1);1];
elseif P==134
    % HS 326
    g = [2*x(1)-16;2*x(2)-10];
elseif P==135
    % HS 327
    y = [.49;.49;.48;.47;.48;.47;.46;.46;.45;
        .43;.45;.43;.43;.44;.43;.43;.46;.45;
        .42;.42;.43;.41;.41;.4;.42;.4;.4;.41;
        .4;.41;.41;.4;.4;.4;.38;.41;.4;.4;.41;
        .38;.4;.4;.39;.39];
    z = [8;8;10;10;10;10;12;12;12;12;14;14;14;16;16;16;18;
        18;20;20;20;22;22;22;24;24;24;26;26;26;28;28;30;30;30;32;32;34;36;36;38;38;40;42];
    for i=1:44
        g1 = (-1 + exp(-x(2)*(z(i)-8)))*2*(y(i)-x(1)-(.49-x(1))*exp(-x(2)*(z(i)-8)));
        g2 = (.49-x(1))*(z(i)-8)*exp(-x(2)*(z(i)-8))*2*(y(i)-x(1)-(.49-x(1))*exp(-x(2)*(z(i)-8)));
    end
    g = [g1;g2];
end

function g=chs_g4(x, P)

if P==136
    % HS 328
    g = [3*(x(1)-10)^2;3*(x(2)-20)^2];
elseif P==137
    % HS 330
    g = [.044*3*x(1)^2/x(2)^2-1/x(1)^2+.0592/x(2)^3 ; -2*.044*x(1)^3/x(2)^3-3*.0592*x(1)/x(2)^4];
elseif P==138
    % HS 331
    A = x(1)+x(2);
    g = [-1/x(1)^2*log(2*log(x(2))/(log(A)+eps))-1/(x(1)*A*log(A)+eps);
        1/(x(1)*x(2)*log(x(2)))-1/(x(1)*A*log(A)+eps)];
elseif P==139
    % HS 332
    g(1) = 0;
    g(2) = 0;
    for i=1:100
        ti = pi*(1/3+(i-1)/180);
        A = log(ti)+x(2)*sin(ti)+x(1)*cos(ti);
        B = log(ti)+x(2)*cos(ti)-x(1)*sin(ti);
        g(1) = g(1)+2*A*cos(ti)-2*B*sin(ti);
        g(2) = g(2)+2*A*sin(ti)+2*B*cos(ti);
    end
    g = [g(1);g(2)];
    g = pi/3.6*g;
elseif P==140
    % HS 335
    g = [-.001;-1;0];
elseif P==141
    % HS 336
    g = [7;-6;4];
elseif P==142
    % HS 337
    g = [18*x(1);2*x(2);18*x(3)];
elseif P==143
    % HS 338
    g = [-2*x(1);-2*x(2);-2*x(3)];
elseif P==144
    % HS 339
    g = [-.2*x(2)*x(3)/(x(1)*x(2)*x(3))-4/x(1)^2;
        -.2*x(1)*x(3)/(x(1)*x(2)*x(3));
        -.2*x(1)*x(2)/(x(1)*x(2)*x(3))-3/x(3)^2];
elseif P==145
    % HS 340
    g = [-x(2)*x(3);-x(1)*x(3);-x(1)*x(2)];
elseif P==146
    % HS 341
    g = [-x(2)*x(3);-x(1)*x(3);-x(1)*x(2)];
elseif P==147
    % HS 342
    g = [-x(2)*x(3);-x(1)*x(3);-x(1)*x(2)];
elseif P==148
    % HS 343
    g = [(-.0201*4*x(1)^3*x(2)*x(3)^2)*1e-7;(-.0201*x(1)^4*x(3)^2)*1e-7;(-.0201*2*x(1)^4*x(2)*x(3))*1e-7];
elseif P==149
    % HS 344
    g = [2*(x(1)-1)+2*(x(1)-x(2));-2*(x(1)-x(2))+4*(x(2)-x(3))^3;-4*(x(2)-x(3))^3];
elseif P==150
    % HS 345
    g = [2*(x(1)-1)+2*(x(1)-x(2));-2*(x(1)-x(2))+4*(x(2)-x(3))^3;-4*(x(2)-x(3))^3];
elseif P==151
    % HS 346
    g = [(-.0201*4*x(1)^3*x(2)*x(3)^2)*1e-7;(-.0201*x(1)^4*x(3)^2)*1e-7;(-.0201*2*x(1)^4*x(2)*x(3))*1e-7];
elseif P==152
    % HS 347
    w = [(x(1)+x(2)+x(3)+.03)/(.09*x(1)+x(2)+x(3)+.03);
        (x(2)+x(3)+.03)/(.07*x(2)+x(3)+.03);
        (x(3)+.03)/(.13*x(3)+.03)];
    A = [8204.37;9008.72;9330.46];
    dw = [(.91*(x(2)+x(3))+.003)/(.09*x(1)+x(2)+x(3)+.03)^2 0 0;
        ((-.91)*x(1))/(.09*x(1)+x(2)+x(3)+.03)^2 ((.93*x(3)+.009))/(.07*x(2)+x(3)+.03)^2 0;
        (-.91*x(1))/(.09*x(1)+x(2)+x(3)+.03)^2 (-.93*x(2))/(.07*x(2)+x(3)+.03)^2 (.03*.87)/(.13*x(3)+.03)^2];
    g = zeros(3,1);
    for i=1:3
        for j=1:3
            g(i) = g(i) + A(j)/w(j)*dw(i,j);
        end
    end
elseif P==153
    % HS 353
    g = [-24.55;-26.75;-39.00;-40.50];
elseif P==154
    % HS 354
    g = [2*(x(1)+10*x(2))+4*10*(x(1)-x(4))^3;
        20*(x(1)+10*x(2))+4*(x(2)-2*x(3))^3;
        10*(x(3)-x(4))-8*(x(2)-2*x(3))^3;
        -10*(x(3)-x(4))-40*(x(1)-x(4))^3];
elseif P==155
    % HS 355
    r(1) = 11-x(1)*x(4)-x(2)*x(4)+x(3)*x(4);
    r(2) = x(1)+10*x(2)-x(3)+x(4)+x(2)*x(4)*(x(3)-x(1));
    g = [-x(4)*2*r(1)+(1-x(2)*x(4))*2*r(2);
        -x(4)*2*r(1)+(10+x(4)*(x(3)-x(1)))*2*r(2);
        x(4)*2*r(1)+(-1+x(2)*x(4))*2*r(2);
        (-x(1)-x(2)+x(3))*2*r(1)+(1+x(2)*(x(3)-x(1)))*2*r(2)];
elseif P==156
    % HS 356
    g = [2*1.10471*x(1)*x(2);1.10471*x(1)^2+.04811*x(3)*x(4);
        .04811*x(4)*(14+x(2));.04811*x(3)*(14+x(2))];
elseif P==157
    % HS 360
    c =[-0.8720288849e+7;0.1505125233e+6;-0.1566950325e+3;0.4764703222e+6;0.7294828271e+6;
        -0.3266695104e+6;0.739068412e+4;-0.278986976e+2;0.16643076e+5;0.30988146e+5];
    g = [(-c(1)-c(2)*x(2)-c(3)*x(3)-c(4)*x(4)-c(5)*x(5));
        -c(2)*x(1);-c(3)*x(1);-c(4)*x(1);-c(5)*x(1)];
elseif P==158
    % HS 361
    A =[-0.8720288849e+7;0.1505125233e+6;-0.1566950325e+3;0.4764703222e+6;0.7294828271e+6];
    f = 0;
    for i=2:5
        fi = A(i)*x(i);
        f = f + fi;
    end
    g1 = A(1)+f;
    g = [-g1;-A(2)*x(1);-A(3)*x(1);-A(4)*x(1);-A(5)*x(1)];
elseif P==159
    % HS 365
    g = [x(3);0;x(1);0;0;0;0];
elseif P==160
    % HS 366
    g = [1.715+.035*x(6);10;4.0565-.063*x(5);0;-.063*x(3);.035*x(1);0];
elseif P==161
    % HS 367
    g = [-5-x(3);-5;-4-x(1);-6;
        -5/(1+x(5))^2;
        -8/(1+x(6))^2;
        -10*(2*exp(-x(7))-2*exp(-2*x(7)))];
elseif P==162
    % HS 369
    g = [1;1;1;0;0;0;0;0];
elseif P==163
    % HS 372
    g = [0;0;0;2*x(4);2*x(5);2*x(6);2*x(7);2*x(8);2*x(9)];
elseif P==164
    % HS 373
    g = [0;0;0;2*x(4);2*x(5);2*x(6);2*x(7);2*x(8);2*x(9)];
elseif P==165
    % HS 374
    g = zeros(10,1);
    g(10,1) = 1;
elseif P==166
    % HS 375
    g = -2*x;
elseif P==167
    % HS 376
    g    = zeros(10,1);
    g(1) = 500000*(-603+50000*x(2))/(1+500*x(1)+30000*x(2))^2;
    g(2) = -.2E8*(907+1250*x(1))/(1+500*x(1)+30000*x(2))^2;
elseif P==168
    % HS 377
    A = [-6.089;-17.164;-34.054;-5.914;-24.721;-14.986;-24.100;-10.708;-26.662;-22.179];
    g = zeros(10,1);
    x_sum = 0;
    for j=1:10
        x_sum = x_sum + x(j);
    end

    for i=1:10
        g(i) = (A(i)+log(x(i)/x_sum));
    end
elseif P==169
    % HS 378
    A = [-6.089;-17.164;-34.054;-5.914;-24.721;-14.986;-24.100;-10.708;-26.662;-22.179];
    g = zeros(10,1);
    exp_sum = 0;
    for j=1:10
        exp_sum = exp_sum + exp(x(j));
    end
    for i=1:10
        g(i) = exp(x(i))*(A(i)+x(i)-log(exp_sum));
    end
elseif P==170
    %HS 380
    a = [-.00133172;-.002270927;-.00248546;-4.67;-4.671973;-.00814;-.008092;-.005;-.000909;-.00088;-.00119];
    g = zeros(12,1);
    g(11) = 1e5*a(11)*x(11)^(a(11)-1);
elseif P==171
    %HS 382
    g=[0.80;1.10;0.85;3.45;2.00;2.10;3.00;0.80;0.45;0.72;1.80;3.00;0.60];
elseif P==172
    % HS 383
    a =[12842.275;634.25;634.25;634.25;1268;633.875;633.75;1267;760.05;633.25;1266.25;632.875;394.46;940.838];
    g = zeros(14,1);
    for i=1:14
        g(i) = -a(i)/(x(i)^2+eps);
    end
elseif P==173
    %HS 384
    g=[-486; -640; -758; -776; -477; -707; -175; -619; -627; -614; -475; -377; -524; -468; -529];
elseif P==174
    %HS 385
    g=[-486; -640; -758; -776; -477; -707; -175; -619; -627; -614; -475; -377; -524; -468; -529];
elseif P==175
    %HS 386
    g=[-486; -640; -758; -776; -477; -707; -175; -619; -627; -614; -475; -377; -524; -468; -529];
elseif P==176
    %HS 387
    g=[-486; -640; -758; -776; -477; -707; -175; -619; -627; -614; -475; -377; -524; -468; -529];
elseif P==177
    %HS 388
    g=[-486; -640; -758; -776; -477; -707; -175; -619; -627; -614; -475; -377; -524; -468; -529];
elseif P==178
    %HS 389
    g=[-486; -640; -758; -776; -477; -707; -175; -619; -627; -614; -475; -377; -524; -468; -529];
elseif P==179
    %HS 394
    g = zeros(20,1);
    for i=1:20
        g(i)=i*(2*x(i)+4*x(i)^3);
    end
elseif P==180
    %HS 395
    g = zeros(50,1);
    for i=1:50
        g(i)=i*(2*x(i)+4*x(i)^3);
    end
end

% MODIFICATION LOG:
%
% 990601  mbk  First version.
% 990730  ---  Richardo Augilar & Henrik Jönsson
% 010416  hkh  Modified for v3.0
% 031113  ango Fixed error in problem 87
% 041130  med  Fixed 44
% 050215  med  Updated 41
% 060813  med  Updated P 49
% 080603  med  Switched to conAssign, cleaned