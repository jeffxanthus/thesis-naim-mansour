% chs_f.m
%
% function f = chs_f(x, Prob)
%
% chs_f computes the objective function f in the point x
% for the test problem P (Prob.P).

% Kenneth Holmstrom, Tomlab Optimization Inc., E-mail: tomlab@tomopt.com.
% Copyright (c) 1999-2008 by Tomlab Optimization Inc. $Release: 6.2.0$
% Written June 1, 1999.   Last modified Jun 6, 2008.

function f=chs_f(x, Prob)

P=Prob.P;

if P < 46
    f = chs_f1(x, P);
elseif P < 91
    f = chs_f2(x, P);
elseif P < 136
    f = chs_f3(x, P);
elseif P < 181
    f = chs_f4(x, P);
end

function f=chs_f1(x, P)

if P==1
    % HS 6
    f = (1-x(1))^2;
elseif P==2
    % HS 7
    f = log(1+x(1)^2)-x(2);
elseif P==3
    % HS 8
    f = -1;
elseif P==4
    % HS 9
    f = sin(pi*x(1)/12)*cos(pi*x(2)/16);
elseif P==5
    % HS 10
    f = x(1)-x(2);
elseif P==6
    % HS 11
    f=(x(1)-5)^2+x(2)^2-25;
elseif P==7
    % HS 12
    f = .5*x(1)^2+ x(2)^2-x(1)*x(2)-7*x(1)-7*x(2);
elseif P==8
    % HS 13
    f =(x(1)-2)^2+x(2)^2;
elseif P==9
    % HS 14
    f=(x(1)-2)^2+(x(2)-1)^2;
elseif P==10
    % HS 15
    f=100*(x(2)-x(1)^2)^2+(1-x(1))^2;
elseif P==11
    % HS 16
    f=100*(x(2)-x(1)^2)^2+(1-x(1))^2;
elseif P==12
    % HS 17
    f=100*(x(2)-x(1)^2)^2+(1-x(1))^2;
elseif P==13
    % HS 18
    f=.01*x(1)^2+x(2)^2;
elseif P==14
    % HS 19
    f=(x(1)-10)^3+(x(2)-20)^3;
elseif P==15
    % HS 20
    f=100*(x(2)-x(1)^2)^2+(1-x(1))^2;
elseif P==16
    % HS 22
    f=(x(1)-2)^2+(x(2)-1)^2;
elseif P==17
    % HS 23
    f=x(1)^2+x(2)^2;
elseif P==18
    % HS 24
    f=((x(1)-3)^2-9)*x(2)^3/(27*sqrt(3));
elseif P==19
    % HS 26
    f=(x(1)-x(2))^2+(x(2)-x(3))^4;
elseif P==20
    % HS 27
    f=.01*(x(1)-1)^2+(x(2)-x(1)^2)^2;
elseif P==21
    % HS 29
    f=-x(1)*x(2)*x(3);
elseif P==22
    % HS 30
    f=x(1)^2+x(2)^2+x(3)^2;
elseif P==23
    % HS 31
    f=9*x(1)^2+x(2)^2+9*x(3)^2;
elseif P==24
    % HS 32
    f=(x(1)+3*x(2)+x(3))^2+4*(x(1)-x(2))^2;
elseif P==25
    % HS 33
    f=(x(1)-1)*(x(1)-2)*(x(1)-3)+x(3);
elseif P==26
    % HS 34
    f=-x(1);
elseif P==27
    % HS 36
    f=-x(1)*x(2)*x(3);
elseif P==28
    % HS 37
    f=-x(1)*x(2)*x(3);
elseif P==29
    % HS 39
    f=-x(1);
elseif P==30
    % HS 40
    f=-x(1)*x(2)*x(3)*x(4);
elseif P==31
    % HS 41
    f=2-x(1)*x(2)*x(3);
elseif P==32
    % HS 42
    f=(x(1)-1)^2+(x(2)-2)^2+(x(3)-3)^2+(x(4)-4)^2;
elseif P==33
    % HS 43
    f=x(1)^2+x(2)^2+2*x(3)^2+x(4)^2-5*x(1)-5*x(2)-21*x(3)+7*x(4);
elseif P==34
    % HS 44
    f=x(1)-x(2)-x(3)-x(1)*x(3)+x(1)*x(4)+x(2)*x(3)-x(2)*x(4);
elseif P==35
    % HS 46
    f=(x(1)-x(2))^2+(x(3)-1)^2+(x(4)-1)^4+(x(5)-1)^6;
elseif P==36
    % HS 47
    f=(x(1)-x(2))^2+(x(2)-x(3))^3+(x(3)-x(4))^4+(x(4)-x(5))^4;
elseif P==37
    % HS 54
    %  h=((x(1)-1e6)^2/6.4e7+(x(1)-1e4)*(x(2)-1)/2e4+(x(2)-1)^2)*(x(3)-2e6)^2/(.96*4.9e13)...
    %      +(x(4)-10)^2/2.5e3+(x(5)-1e-3)^2/2.5e-3...
    %      +(x(6)-1e8)^2/2.5e17;
    %    f=-exp(-h/2);

    Y1=x(1);
    Y2=x(2);
    Y3=x(3);
    Y4=x(4);
    Y5=x(5);
    Y6=x(6);
    %   f = -exp(-(((Y1-1e4)^2/6.4e7+(Y1-1e4)*(Y2-1)/2e4...
    %      +6.25*(Y2-1)^2)/.96+(Y3-2e6)^2/49e12+(Y4-1e1)^2/2.5e3+...
    %      (Y5-1e-3)^2/2.5e-3+(Y6-1e8)^2/2.5e17)*.5);

    f = -exp(-((Y1^2+Y1*Y2+6.25*Y2^2)/.96+Y3^2/49+4*(Y4^2+Y5^2+Y6^2))*.5);

elseif P==38
    % HS 55
    f=x(1)+2*x(2)+4*x(5)+exp(x(1)*x(4));
elseif P==39
    % HS 56
    f=-x(1)*x(2)*x(3);
elseif P==40
    % HS 57
    a = [8 8 10 10 10 10 12 12 12 12 14 14 14 16 16 16 18 18 20 20 20 22 22 22 24 24 24 26 26 26 28 28 30 30 30 32 32 34 36 36 38 38 40 42];
    b = [.49 .49 .48 .47 .48 .47 .46 .46 .45 .43 .45 .43 .43 .44 .43 .43 .46 .45 .42 .42 .43 .41 .41 .40 .42 .40 .40 .41 .40 .41 .41 .40 .40 .40 .38 .41 .40 .40 .41 .38 .40 .40 .39 .39];
    f = 0;
    for i=1:1:44
        f_i = b(i)-x(1)-(.49-x(1))*exp(-x(2)*(a(i)-8));
        f = f+f_i^2;
    end
elseif P==41
    % HS 59
    XK = [75.196;3.8112;.0020567;1.0345e-5;6.8306;0.030234;1.28134e-3;2.266e-7;.25645;
        0.0034604;1.3514e-5;28.106;5.2375e-6;6.3e-8;7.e-10;3.405e-4;1.6638e-6;2.8673;3.5256e-5];
    X1=x(1);
    X2=x(2);
    f =-XK(1)+XK(2)*X1+XK(3)*X1^3-XK(4)*X1^4+XK(5)*X2-XK(6)*X1*X2+...
        XK(7)*X2*X1^2+XK(8)*X1^4*X2-XK(9)*X2^2+XK(10)*X2^3-...
        XK(11)*X2^4+XK(12)/(X2+1.D0)+XK(13)*X1^2*X2^2+...
        XK(14)*X1^3*X2^2-XK(15)*X1^3*X2^3+XK(18)*exp(.0005*X1*X2)-...
        XK(19)*X1^3*X2-XK(16)*X1*X2^2+XK(17)*X1*X2^3-.12694D0*X1^2;
elseif P==42
    % HS 60
    f = (x(1)-1)^2+(x(1)-x(2))^2+(x(2)-x(3))^4;
elseif P==43
    % HS 61
    f = 4*x(1)^2+2*x(2)^2+2*x(3)^2-33*x(1)+16*x(2)-24*x(3);
elseif P==44
    % HS 62
    F3=x(3)+.03;
    F2=F3+x(2);
    F1=F2+x(1);
    G1=F2+.09*x(1);
    G2=F3+.07*x(2);
    G3= .13*x(3)+.03;
    f=-(8.20437e3*log(F1/G1) + 9.00872e3*log(F2/G2) + 9.33046e3*log(F3/G3));
elseif P==45
    % HS 63
    f=1000-x(1)^2-2*x(2)^2-x(3)^2-x(1)*x(2)-x(1)*x(3);
end

function f=chs_f2(x, P)

if P==46
    % HS 64
    f=5*x(1)+50000/x(1)+20*x(2)+72000/x(2)+10*x(3)+144000/x(3);
elseif P==47
    % HS 65
    f=(x(1)-x(2))^2+(x(1)+x(2)-10)^2/9+(x(3)-5)^2;
elseif P==48
    % HS 66
    f=0.2*x(3)-0.8*x(1);
elseif P==49
    % HS 67
    jj=0;
    Y2 = 1.6*x(1);
    count = 0;
    while jj==0 & count < 1000
        Y3 = 1.22*Y2-x(1);%
        Y6 = (x(2)+Y3)/x(1);
        Y2c = .01*x(1)*(112+13.167*Y6-.6667*Y6^2);
        if((abs(Y2c-Y2))<=0.001)
            jj=1;
        else
            Y2 = Y2c;
        end
        count = count + 1;
    end
    jj=0;
    Y4 = 93;%
    count = 0;
    while jj==0 & count < 1000
        Y5 = 86.35+1.098*Y6-.038*Y6^2+.325*(Y4-89);
        Y8 =3*Y5-133;
        Y7 = 35.82-.222*Y8;
        Y4c = 98000*x(3)/(Y2*Y7+1000*x(3));
        if (abs(Y4c-Y4)>=0.001)
            Y4 = Y4c;
        else
            jj=1;
        end
        count = count + 1;
    end
    f = -.063*Y2*Y5+5.04*x(1)+3.36*Y3+.035*x(2)+10*x(3);
elseif P==50
    % HS 70
    C = [.1 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18];
    Y = [.00189 .1038 .268 .506 .577 .604 .725 .898 .947 .845 .702 .528 .385 .257 .159 .0869 .0453 .01509 .00189];
    CL = zeros(19,1);
    D = zeros(19,1);
    C(1)=.1/7.658;
    CL(1)=log(C(1));
    H=12/sqrt(6.2832);
    D(1)=H/C(1);
    for i=2:19
        C(i)=(i-1)/7.658;
        CL(i)=log(C(i));
        D(i)=H/C(i);
    end
    S = 0;
    X1=x(1);
    X2=x(2);
    X3=x(3);
    X4=x(4);
    BET=X3+(1-X3)*X4;
    W1 =sqrt(abs(X1));
    W2 =sqrt(abs(X2));
    BETX4=0;
    DLX4=0;
    DLBET=0;
    if (BET>0 | X4>0)
        DLBET=log(BET);
        BETX4=BET/X4;
        DLX4=log(X4);
    end

    FAC1=W2*X2*X3/(1+12*X2);
    FAC2=W1*X1*(1-X3)/(1+12*X1);
    for i=1:19
        YIC=0;
        if(BET>0 | X4>0)
            E1=0;
            CL1=X2*(1-C(i)*BET+DLBET+CL(i));
            if(CL1>=-170)
                E1=exp(CL1);
            end
            E2=0;
            CL2=X1*(1-C(i)*BETX4+DLBET-DLX4+CL(i));
            if CL2>=-170
                E2=exp(CL2);
            end
            YIC=D(i)*(FAC1*E1+FAC2*E2);
        end
        S=S+(YIC-Y(i))^2;
    end
    f = S;
elseif P==51
    % HS 71
    f=x(1)*x(4)*(x(1)+x(2)+x(3))+x(3);
elseif P==52
    % HS 72
    f=1+x(1)+x(2)+x(3)+x(4);
elseif P==53
    % HS 73
    f=24.55*x(1)+26.75*x(2)+39*x(3)+40.50*x(4);
elseif P==54
    % HS 74
    f=3*x(1)+1e-6*x(1)^3+2*x(2)+(2/3)*1e-6*x(2)^3;
elseif P==55
    % HS 75
    f=3*x(1)+1e-6*x(1)^3+2*x(2)+(2/3)*1e-6*x(2)^3;
elseif P==56
    % HS 77
    f=(x(1)-1)^2+(x(1)-x(2))^2+(x(3)-1)^2+(x(4)-1)^4+(x(5)-1)^6;
elseif P==57
    % HS 78
    f=x(1)*x(2)*x(3)*x(4)*x(5);
elseif P==58
    % HS 79
    f=(x(1)-1)^2+(x(1)-x(2))^2+(x(2)-x(3))^2+(x(3)-x(4))^4+(x(4)-x(5))^4;
elseif P==59
    % HS 80
    f=exp(x(1)*x(2)*x(3)*x(4)*x(5));
elseif P==60
    % HS 81
    f=exp(x(1)*x(2)*x(3)*x(4)*x(5))-.5*(x(1)^3+x(2)^3+1)^2;
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
elseif P==61
    % HS 83
    f=5.3578547*x(3)^2 + .8356891*x(1)*x(5)+37.293239*x(1)-40792.141;
elseif P==62
    % HS 84
    f=24345+8720288.849*x(1)-150512.5253*x(1)*x(2)...
        +1.566950325*10^(2)*x(1)*x(3)-4.764703222*10^(5)*x(1)*x(4)-7.294828271*10^(5)*x(1)*x(5);
elseif P==63
    % HS 86
    c=[30  -20  -10   32  -10;
        -20   39   -6  -31   32;
        -10   -6   10   -6  -10;
        32  -31   -6   39  -20;
        -10   32  -10  -20   30];
    e=[-15 -27 -36 -18 -12];
    d=[4 8 10 6 2];
    s1=0;
    s3=0;
    for j=1:5
        s1=s1+e(j)*x(j);
        s3=s3+d(j)*x(j)^3;
    end
    f1=s1+s3;
    s2=0;
    for i=1:5
        for j=1:5
            s2=s2+c(i,j)*x(i)*x(j);
        end
    end
    f=f1+s2;
elseif P==64
    % HS 87
    if(0<=x(1)<300)
        f1=30*x(1);
    elseif(300<=x(1)<=400)
        f1=31*x(1);
    end
    if(0<=x(2)<100)
        f2=28*x(2);
    elseif(100<=x(2)<200)
        f2=29*x(2);
    elseif(200<=x(2)<=1000)
        f2=30*x(2);
    end
    f=f1+f2;
elseif P==65
    %  HS 93
    f=0.0204*x(1)*x(4)*(x(1)+x(2)+x(3))+0.0187*x(2)*x(3)*(x(1)+1.57*x(2)+x(4))...
        +0.0607*x(1)*x(4)*x(5)^2*(x(1)+x(2)+x(3))+0.0437*x(2)*x(3)*x(6)^2*(x(1)+1.57*x(2)+x(4));
elseif P==66
    %  HS 95
    f=4.3*x(1)+31.8*x(2)+63.3*x(3)+15.8*x(4)+68.5*x(5)+4.7*x(6);
elseif P==67
    % HS 96
    f=4.3*x(1)+31.8*x(2)+63.3*x(3)+15.8*x(4)+68.5*x(5)+4.7*x(6);
elseif P==68
    % HS 97
    f=4.3*x(1)+31.8*x(2)+63.3*x(3)+15.8*x(4)+68.5*x(5)+4.7*x(6);
elseif P==69
    % HS 98
    f=4.3*x(1)+31.8*x(2)+63.3*x(3)+15.8*x(4)+68.5*x(5)+4.7*x(6);
elseif P==70
    % HS 99
    f=-(9000*cos(x(7))+9000*cos(x(6))+3750*cos(x(5))+3750*cos(x(4))+3750*cos(x(3))+1250*cos(x(2))+1250*cos(x(1)))^2;
elseif P==71
    % HS 100
    f = (x(1)-10)^2+5*(x(2)-12)^2+x(3)^4+3*(x(4)-11)^2+10*x(5)^6+x(7)^4-...
        4*x(6)*x(7)-10*x(6)-8*x(7)+7*x(6)^2;
elseif P==72
    %HS 101
    f=10*x(1)*x(2)^(-1)*x(4)^2*x(6)^(-3)*x(7)^(-0.25)+15*x(1)^(-1)*x(2)^(-2)*x(3)*x(4)*x(5)^(-1)*x(7)^(-0.5)...
        +20*x(1)^(-2)*x(2)*x(4)^(-1)*x(5)^(-2)*x(6)+25*x(1)^(2)*x(2)^(2)*x(3)^(-1)*x(5)^(0.5)*x(6)^(-2)*x(7);
elseif P==73
    %HS 102
    f=10*x(1)*x(2)^(-1)*x(4)^2*x(6)^(-3)*x(7)^(0.125)+15*x(1)^(-1)*x(2)^(-2)*x(3)*x(4)*x(5)^(-1)*x(7)^(-0.5)...
        +20*x(1)^(-2)*x(2)*x(4)^(-1)*x(5)^(-2)*x(6)+25*x(1)^(2)*x(2)^(2)*x(3)^(-1)*x(5)^(0.5)*x(6)^(-2)*x(7);
elseif P==74
    %HS 103
    f=10*x(1)*x(2)^(-1)*x(4)^2*x(6)^(-3)*x(7)^(0.5)+15*x(1)^(-1)*x(2)^(-2)*x(3)*x(4)*x(5)^(-1)*x(7)^(-0.5)...
        +20*x(1)^(-2)*x(2)*x(4)^(-1)*x(5)^(-2)*x(6)+25*x(1)^(2)*x(2)^(2)*x(3)^(-1)*x(5)^(0.5)*x(6)^(-2)*x(7);
elseif P==75
    % HS 104
    f=0.4*x(1)^0.67*x(7)^(-0.67)+0.4*x(2)^0.67*x(8)^(-0.67)+10-x(1)-x(2);
elseif P==76
    % HS 106
    f=x(1)+x(2)+x(3);
elseif P==77
    % HS 107
    f=3000*x(1)+1000*x(1)^3+2000*x(2)+666.667*x(2)^3;
elseif P==78
    % HS 108
    f=-0.5*(x(1)*x(4)-x(2)*x(3)+x(3)*x(9)-x(5)*x(9)+x(5)*x(8)-x(6)*x(7));
elseif P==79
    % HS 109
    f=3*x(1)+1E-6*x(1)^3+2*x(2)+0.522074E-6*x(2)^3;
elseif P==80
    % HS 111 %Equal to 378
    A = [-6.089;-17.164;-34.054;-5.914;-24.721;-14.986;-24.100;-10.708;-26.662;-22.179];
    exp_sum = 0;
    f = 0;
    for k=1:10
        exp_sum = exp_sum + exp(x(k));
    end
    for j=1:10
        f = f + exp(x(j))*(A(j)+x(j)-log(exp_sum));
    end
elseif P==81
    % HS 112
    A = [-6.08;-17.164;-34.054;-5.914;-24.721;-14.986;-24.100;-10.708;-26.662;-22.179];
    x_sum = 0;
    f = 0;
    for j=1:10
        x_sum = x_sum + x(j);
    end
    for i=1:10
        f = f + x(i)*(A(i)+log(x(i)/x_sum));
    end
elseif P==82
    %HS 113
    f=x(1)^2+x(2)^2+x(1)*x(2)-14*x(1)-16*x(2)+(x(3)-10)^2+4*(x(4)-5)^2+(x(5)-3)^2+2*(x(6)-1)^2+5*x(7)^2+7*(x(8)-11)^2+2*(x(9)-10)^2 +(x(10)-7)^2+45;
elseif P==83
    % HS 114
    f=5.04*x(1)+0.035*x(2)+10*x(3)+3.36*x(5)-0.063*x(4)*x(7);
elseif P==84
    % HS 116
    f=x(11)+x(12)+x(13);
elseif P==85
    % HS 117
    c = [ 30  -20  -10   32  -10;
        -20   39   -6  -31   32;
        -10   -6   10   -6  -10;
        32  -31   -6   39  -20;
        -10   32  -10  -20   30];
    b = [-40 -2  -0.25 -4  -4  -1  -40  -60  5  1];
    d = [4   8   10   6  2];
    s1 = 0;
    for j=1:10
        s1 = s1 - b(j)*x(j);
    end
    s3=0;
    for j=1:5
        s3 = s3 + d(j)*x(10+j)^3;
    end
    s2=0;
    for k=1:5
        for j=1:5
            s2 = s2 + c(k,j)*x(10+k)*x(10+j);
        end
    end
    f = s1 + s2 + 2*s3;
elseif P==86
    % HS 119
    a=[1 0 0 1 0 0 1 1 0 0 0 0 0 0 0 1;
        0 1 1 0 0 0 1 0 0 1 0 0 0 0 0 0;
        0 0 1 0 0 0 1 0 1 1 0 0 0 1 0 0;
        0 0 0 1 0 0 1 0 0 0 1 0 0 0 1 0;
        0 0 0 0 1 1 0 0 0 1 0 1 0 0 0 1;
        0 0 0 0 0 1 0 1 0 0 0 0 0 0 1 0;
        0 0 0 0 0 0 1 0 0 0 1 0 1 0 0 0;
        0 0 0 0 0 0 0 1 0 1 0 0 0 0 1 0;
        0 0 0 0 0 0 0 0 1 0 0 1 0 0 0 1;
        0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 0;
        0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0;
        0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0;
        0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0;
        0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0;
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0;
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1];
    ricsum=0;
    for i=1:16
        for j=1:16
            v = x(i)^2+x(i)+1;
            h = x(j)^2+x(j)+1;
            ricsum=ricsum+a(i,j)*v*h;
        end
    end
    f=ricsum;
elseif P==87
    % HS 215
    f=x(2);
elseif P==88
    % HS 216
    f=100*(x(1)^2-x(2))^2+(x(1)-1)^2;
elseif P==89
    % HS 217
    f=-x(2);
elseif P==90
    % HS 218
    f=x(2);
end

function f=chs_f3(x, P)

if P==91
    % HS 219
    f=-x(1);
elseif P==92
    % HS 220
    f=x(1);
elseif P==93
    % HS 221
    f=-x(1);
elseif P==94
    % HS 222
    f=-x(1);
elseif P==95
    %HS 223
    f=-x(1);
elseif P==96
    %HS 225
    f=x(1)+x(2);
elseif P==97
    %HS 226
    f=-x(1)*x(2);
elseif P==98
    %HS 227
    f=(x(1)-2)^2+(x(2)-1)^2;
elseif P==99
    %HS 228
    f=x(1)^2+x(2);
elseif P==100
    %HS 230
    f=x(2);
elseif P==101
    %HS 231
    f=100*(x(2)-x(1)^2)^2+(1-x(1))^2;
elseif P==102
    %HS 232
    f=-(9-(x(1)-3)^2)*(x(2)^3)/(27*sqrt(3));
elseif P==103
    %HS 233
    f=100*(x(2)-x(1)^2)^2+(1-x(1))^2;
elseif P==104
    %HS 234
    f=(x(2)-x(1))^4-(1-x(1));
elseif P==105
    %HS 235
    f=0.01*(x(1)-1)^2+(x(2)-x(1)^2)^2;
elseif P==106
    % HS 236
    X1 = x(1);
    X2 = x(2);
    B =[75.1963666677;-3.8112755343;.1269366345;-.0020567665;.0000103450;-6.8306567613;...
        3.02344793e-2;-1.2813448e-3;3.52559e-5;-2.266e-7;0.2564581253;-3.460403e-3;...
        1.35139D-5;-28.1064434908;-5.2375e-6;-6.3e-9;7.e-10;3.405462e-4;-1.6638e-6;-2.8673112392];
    f=B(1)+B(2)*X1+B(3)*X1^2+B(4)*X1^3+B(5)*X1^4+B(6)*X2+B(7)*X1*X2+B(8)*X1^2*X2 +...
        B(9)*X1^3*X2+B(10)*X1^4*X2+B(11)*X2^2 +...
        B(12)*X2^3+B(13)*X2^4+B(14)*(1/(X2+1)) +...
        B(15)*X1^2*X2^2+B(16)*X1^3*X2^2 +...
        B(17)*X1^3*X2^3+B(18)*X1*X2^2 +...
        B(19)*X1*X2^3+B(20)*exp(5e-4*X1*X2);
    f = -f;
elseif P==107
    % HS 237
    X1 = x(1);
    X2 = x(2);
    B =[75.1963666677;-3.8112755343;.1269366345;-.0020567665;.0000103450;-6.8306567613;...
        3.02344793e-2;-1.2813448e-3;3.52559e-5;-2.266e-7;0.2564581253;-3.460403e-3;...
        1.35139D-5;-28.1064434908;-5.2375e-6;-6.3e-9;7.e-10;3.405462e-4;-1.6638e-6;-2.8673112392];
    f=B(1)+B(2)*X1+B(3)*X1^2+B(4)*X1^3+B(5)*X1^4+B(6)*X2+B(7)*X1*X2+B(8)*X1^2*X2 +...
        B(9)*X1^3*X2+B(10)*X1^4*X2+B(11)*X2^2 +...
        B(12)*X2^3+B(13)*X2^4+B(14)*(1/(X2+1)) +...
        B(15)*X1^2*X2^2+B(16)*X1^3*X2^2 +...
        B(17)*X1^3*X2^3+B(18)*X1*X2^2 +...
        B(19)*X1*X2^3+B(20)*exp(5e-4*X1*X2);
    f = -f;
elseif P==108
    % HS 238
    X1 = x(1);
    X2 = x(2);
    B =[75.1963666677;-3.8112755343;.1269366345;-.0020567665;.0000103450;-6.8306567613;...
        3.02344793e-2;-1.2813448e-3;3.52559e-5;-2.266e-7;0.2564581253;-3.460403e-3;...
        1.35139D-5;-28.1064434908;-5.2375e-6;-6.3e-9;7.e-10;3.405462e-4;-1.6638e-6;-2.8673112392];
    f=B(1)+B(2)*X1+B(3)*X1^2+B(4)*X1^3+B(5)*X1^4+B(6)*X2+B(7)*X1*X2+B(8)*X1^2*X2 +...
        B(9)*X1^3*X2+B(10)*X1^4*X2+B(11)*X2^2 +...
        B(12)*X2^3+B(13)*X2^4+B(14)*(1/(X2+1)) +...
        B(15)*X1^2*X2^2+B(16)*X1^3*X2^2 +...
        B(17)*X1^3*X2^3+B(18)*X1*X2^2 +...
        B(19)*X1*X2^3+B(20)*exp(5e-4*X1*X2);
    f = -f;
elseif P==109
    % HS 239
    X1 = x(1);
    X2 = x(2);
    B =[75.1963666677;-3.8112755343;.1269366345;-.0020567665;.0000103450;-6.8306567613;...
        3.02344793e-2;-1.2813448e-3;3.52559e-5;-2.266e-7;0.2564581253;-3.460403e-3;...
        1.35139D-5;-28.1064434908;-5.2375e-6;-6.3e-9;7.e-10;3.405462e-4;-1.6638e-6;-2.8673112392];
    f=B(1)+B(2)*X1+B(3)*X1^2+B(4)*X1^3+B(5)*X1^4+B(6)*X2+B(7)*X1*X2+B(8)*X1^2*X2 +...
        B(9)*X1^3*X2+B(10)*X1^4*X2+B(11)*X2^2 +...
        B(12)*X2^3+B(13)*X2^4+B(14)*(1/(X2+1)) +...
        B(15)*X1^2*X2^2+B(16)*X1^3*X2^2 +...
        B(17)*X1^3*X2^3+B(18)*X1*X2^2 +...
        B(19)*X1*X2^3+B(20)*exp(5e-4*X1*X2);
    f = -f;
elseif P==110
    % HS 248
    f = -x(2);
elseif P==111
    % HS 249
    f = x(1)^2+x(2)^2+x(3)^2;
elseif P==112
    % HS 250
    f = -x(1)*x(2)*x(3);
elseif P==113
    % HS 251
    f = -x(1)*x(2)*x(3);
elseif P==114
    % HS 252
    f = .01*(x(1)-1)^2+(x(2)-x(1)^2)^2;
elseif P==115
    % HS 253
    c = [1 1 1 1 1 1 1 1];
    a = [0 10 10 0 0 10 10 0 ;0 0 10 10 0 0 10 10;0 0 0 0 10 10 10 10];
    f = 0;
    for j=1:8
        f_j = c(j)*sqrt((a(1,j)-x(1))^2+(a(2,j)-x(2))^2+(a(3,j)-x(3))^2);
        f = f + f_j;
    end
elseif P==116
    % HS 254
    f = log(x(3))-x(2);
elseif P==117
    % HS 263
    f = -x(1);
elseif P==118
    % HS 264
    f = x(1)^2+x(2)^2+2*x(3)^2+x(4)^2-5*x(1)-5*x(2)-21*x(3)+7*x(4);
elseif P==119
    % HS 265
    f = 0;
    for i=1:2
        fi = 1-exp(-10*x(i)*exp(-x(i+2)));
        f = fi + f;
    end
elseif P==120
    % HS 270
    x1 = x(1);
    x2 = x(2);
    x3 = x(3);
    x4 = x(4);
    x5 = x(5);
    f = x1*x2*x3*x4-3*x1*x2*x4-4*x1*x2*x3+12*x1*x2-x2*x3*x4+3*x2*x4+...
        4*x2*x3-12*x2-2*x1*x3*x4+6*x1*x4+8*x1*x3-24*x1+2*x3*x4-...
        6*x4-8*x3+24+1.5*x5^4-5.75*x5^3+5.25*x5^2;
elseif P==121
    % HS 284
    c = [20 40 400 20 80 20 40 140 380 280 80 40 140 40 120];
    f = -c*x(:);
elseif P==122
    % HS 285
    c = [486 640 758 776 477 707 175 619 627 614 475 377 524 468 529];
    f = -c*x(:);
elseif P==123
    % HS 315
    f = -x(2);
elseif P==124
    % HS 316
    f = (x(1)-20)^2+(x(2)+20)^2;
elseif P==125
    % HS 317
    f = (x(1)-20)^2+(x(2)+20)^2;
elseif P==126
    % HS 318
    f = (x(1)-20)^2+(x(2)+20)^2;
elseif P==127
    % HS 319
    f = (x(1)-20)^2+(x(2)+20)^2;
elseif P==128
    % HS 320
    f = (x(1)-20)^2+(x(2)+20)^2;
elseif P==129
    % HS 321
    f = (x(1)-20)^2+(x(2)+20)^2;
elseif P==130
    % HS 322
    f = (x(1)-20)^2+(x(2)+20)^2;
elseif P==131
    % HS 323
    f = x(1)^2+x(2)^2-4*x(1)+4;
elseif P==132
    % HS 324
    f = .01*x(1)^2+x(2)^2;
elseif P==133
    % HS 325
    f = x(1)^2+x(2);
elseif P==134
    % HS 326
    f = x(1)^2+x(2)^2-16*x(1)-10*x(2);
elseif P==135
    % HS 327
    y = [.49;.49;.48;.47;.48;.47;.46;.46;.45;
        .43;.45;.43;.43;.44;.43;.43;.46;.45;
        .42;.42;.43;.41;.41;.4;.42;.4;.4;.41;
        .4;.41;.41;.4;.4;.4;.38;.41;.4;.4;.41;
        .38;.4;.4;.39;.39];
    z = [8;8;10;10;10;10;12;12;12;12;14;14;14;16;16;16;18;18;20;20;20;22;22;22;24;24;24;26;26;26;28;28;30;30;30;32;32;34;36;36;38;38;40;42];
    f = 0;
    for i=1:44
        f = f + (y(i)-x(1)-(.49-x(1))*exp(-x(2)*(z(i)-8)))^2;
    end
end

function f=chs_f4(x, P)

if P==136
    % HS 329
    f = (x(1)-10)^3+(x(2)-20)^3;
elseif P==137
    % HS 330
    f = .1*(.44*(x(1)^3/x(2)^2)+10/x(1)+.592*(x(1)/x(2)^3));
elseif P==138
    % HS 331
    f = 1/x(1)*log(2*log(x(2))/(log(x(1)+x(2))+eps));
elseif P==139
    % HS 332
    f = 0;
    for i=1:100
        ti = pi*(1/3+(i-1)/180);
        fi = (log(ti)+x(2)*sin(ti)+x(1)*cos(ti))^2+(log(ti)+x(2)*cos(ti)-x(1)*sin(ti))^2;
        f = f +fi;
    end
    f = pi/3.6*f;
elseif P==140
    % HS 335
    f = -(.001*x(1)+x(2));
elseif P==141
    % HS 336
    f = 7*x(1)-6*x(2)+4*x(3);
elseif P==142
    % HS 337
    f = 9*x(1)^2+x(2)^2+9*x(3)^2;
elseif P==143
    % HS 338
    f = -(x(1)^2+x(2)^2+x(3)^2);
elseif P==144
    % HS 339
    f = .2/(x(1)*x(2)*x(3))+4/x(1)+3/x(3);
elseif P==145
    % HS 340
    f = -x(1)*x(2)*x(3);
elseif P==146
    % HS 341
    f = -x(1)*x(2)*x(3);
elseif P==147
    % HS 342
    f = -x(1)*x(2)*x(3);
elseif P==148
    % HS 343
    f = -.0201*1e-7*x(1)^4*x(2)*x(3)^2;
elseif P==149
    % HS 344
    f = (x(1)-1)^2+(x(1)-x(2))^2+(x(2)-x(3))^4;
elseif P==150
    % HS 345
    f = (x(1)-1)^2+(x(1)-x(2))^2+(x(2)-x(3))^4;
elseif P==151
    % HS 346
    f = -.0201*x(1)^4*x(2)*x(3)^2/1e7;
elseif P==152
    % HS 347
    w = [(x(1)+x(2)+x(3)+.03)/(.09*x(1)+x(2)+x(3)+.03);
        (x(2)+x(3)+.03)/(.07*x(2)+x(3)+.03);
        (x(3)+.03)/(.13*x(3)+.03)];
    A = [8204.37;9008.72;9330.46];
    f = 0;
    for i=1:3
        f = f +A(i)*log(w(i));
    end
elseif P==153
    % HS 353
    f = -24.55*x(1)-26.75*x(2)-39*x(3)-40.50*x(4);
elseif P==154
    % HS 354
    f = (x(1)+10*x(2))^2+5*(x(3)-x(4))^2+(x(2)-2*x(3))^4+10*(x(1)-x(4))^4;
elseif P==155
    % HS 355
    r(1) = 11-x(1)*x(4)-x(2)*x(4)+x(3)*x(4);
    r(2) = x(1)+10*x(2)-x(3)+x(4)+x(2)*x(4)*(x(3)-x(1));
    f = r(1)^2+r(2)^2;
elseif P==156
    % HS 356
    f = 1.10471*x(1)^2*x(2)+.04811*x(3)*x(4)*(14+x(2));
elseif P==157
    % HS 360
    c =[-0.8720288849e+7;0.1505125233e+6;-0.1566950325e+3;0.4764703222e+6;0.7294828271e+6;
        -0.3266695104e+6;0.739068412e+4;-0.278986976e+2;0.16643076e+5;0.30988146e+5];
    f = (-c(1)-c(2)*x(2)-c(3)*x(3)-c(4)*x(4)-c(5)*x(5))*x(1)+24345;
elseif P==158
    % HS 361
    A =[-0.8720288849e+7;0.1505125233e+6;-0.1566950325e+3;0.4764703222e+6;0.7294828271e+6];
    f = 0;
    for i=2:5
        fi = A(i)*x(i);
        f = f + fi;
    end
    f = -(x(1)*(A(1)+f)-24345);
elseif P==159
    % HS 365
    f =x(1)*x(3);
elseif P==160
    % HS 366
    f =1.715*x(1)+.035*x(1)*x(6)+4.0565*x(3)+10*x(2)-.063*x(3)*x(5)+3000;
elseif P==161
    % HS 367
    f =-5*x(1)-5*x(2)-4*x(3)-x(1)*x(3)-6*x(4)-5*x(5)/(1+x(5))-8*x(6)/(1+x(6))-...
        10*(1-2*exp(-x(7))+exp(-2*x(7)));
elseif P==162
    % HS 369
    f =x(1)+x(2)+x(3);
elseif P==163
    % HS 372
    f = x(4)^2+x(5)^2+x(6)^2+x(7)^2+x(8)^2+x(9)^2;
elseif P==164
    % HS 373
    f = x(4)^2+x(5)^2+x(6)^2+x(7)^2+x(8)^2+x(9)^2;
elseif P==165
    % HS 374
    f = x(10);
elseif P==166
    % HS 375
    f = -x(:)'*x(:);
elseif P==167
    % HS 376
    f = -20000*(.15*x(1)+14*x(2)-.06)/(.002+x(1)+60*x(2));
elseif P==168
    % HS 377
    A = [-6.089;-17.164;-34.054;-5.914;-24.721;-14.986;-24.100;-10.708;-26.662;-22.179];
    x_sum = 0;
    f = 0;
    for j=1:10
        x_sum = x_sum + x(j);
    end
    for i=1:10
        f = f + x(i)*(A(i)+log(x(i)/x_sum));
    end
elseif P==169
    % HS 378
    A = [-6.089;-17.164;-34.054;-5.914;-24.721;-14.986;-24.100;-10.708;-26.662;-22.179];
    exp_sum = 0;
    f = 0;
    for j=1:10
        exp_sum = exp_sum + exp(x(j));
    end
    for i=1:10
        f = f + exp(x(i))*(A(i)+x(i)-log(exp_sum));
    end
elseif P==170
    %HS 380
    a = [-.00133172;-.002270927;-.00248546;-4.67;-4.671973;-.00814;-.008092;-.005;-.000909;-.00088;-.00119];
    f = sum(1e5*x(11).^a(11));
elseif P==171
    % HS 382
    f=0.80*x(1)+1.10*x(2)+0.85*x(3)+3.45*x(4)+2.00*x(5)+2.10*x(6)+3.00*x(7)+0.80*x(8)+0.45*x(9)+0.72*x(10)+1.80*x(11)+3.00*x(12)+0.60*x(13);
elseif P==172
    %HS 383
    a =[12842.275;634.25;634.25;634.25;1268;633.875;633.75;1267;760.05;633.25;1266.25;632.875;394.46;940.838];
    f = 0;
    for i=1:14
        f = f+a(i)/(x(i)+1e-15);
    end
elseif P==173
    %HS 384
    f=-486*x(1)-640*x(2)-758*x(3)-776*x(4)-477*x(5)-707*x(6)-175*x(7)-619*x(8)-627*x(9)-614*x(10)-475*x(11)-377*x(12)-524*x(13)-468*x(14)-529*x(15);
elseif P==174
    % HS 385
    g=[-486; -640; -758; -776; -477; -707; -175; -619; -627; -614; -475; -377; -524; -468; -529];
    f=g'*x(:);
elseif P==175
    % HS 386
    f=-486*x(1)-640*x(2)-758*x(3)-776*x(4)-477*x(5)-707*x(6)-175*x(7)-619*x(8)-627*x(9)-614*x(10)-475*x(11)-377*x(12)-524*x(13)-468*x(14)-529*x(15);
elseif P==176
    % HS 387
    f=-486*x(1)-640*x(2)-758*x(3)-776*x(4)-477*x(5)-707*x(6)-175*x(7)-619*x(8)-627*x(9)-614*x(10)-475*x(11)-377*x(12)-524*x(13)-468*x(14)-529*x(15);
elseif P==177
    % HS 388
    f=-486*x(1)-640*x(2)-758*x(3)-776*x(4)-477*x(5)-707*x(6)-175*x(7)-619*x(8)-627*x(9)-614*x(10)-475*x(11)-377*x(12)-524*x(13)-468*x(14)-529*x(15);
elseif P==178
    % HS 389
    f=-486*x(1)-640*x(2)-758*x(3)-776*x(4)-477*x(5)-707*x(6)-175*x(7)-619*x(8)-627*x(9)-614*x(10)-475*x(11)-377*x(12)-524*x(13)-468*x(14)-529*x(15);
elseif P==179
    % HS 394
    f=0;
    for i=1:20
        f=f+i*(x(i)^2+x(i)^4);
    end
elseif P==180
    % HS 395
    f=0;
    for i=1:50
        f=f+i*(x(i)^2+x(i)^4);
    end
end

% MODIFICATION LOG:
%
% 990601  mbk  First version.
% 990730  ---  Richardo Augilar & Henrik Jönsson
% 010416  hkh  Modified for v3.0
% 060813  med  Updated P 49
% 080603  med  Switched to conAssign, cleaned
% 081031  nhq  Generalized c*x into c*x(:) for P=121 and P=122
